






## 010.An Example  Pricing a European Put on a Futures Contract

### 020. An Example  Pricing a European Put on a Futures Contract

>> In this module we're going to go through an example very quickly where weprice a European put on a futures contract.Up until now we've seen how to price European and American options on theunderlying security. Very often in fact though we want to priceoptions on futures contracts, which are written on the underlying security.So in fact many of the most liquid options are options on futures contracts.They include for example the S & P 500 index in the US, the Eurostoxx 50 index inthe Euro zone, the FTSE 100 from the UK and the Nikei 225 from Japan.In these cases, the underlying security is not actually traded, that is because ifyou wanted to actually trade the S & P 500 we would need to trade 500 differentstocks. Now it would be very expensive and timeconsuming. So generally we don't trade these indices,we trade futures on these indices. So what we're going to do is we're goingto price a European put on a futures contract.So consider the following parameters, we're going to assume the initial stockprice or in this case the initial index price is 100.We'll assume n equals 10 periods. We will assume a risk free rate of 2%, adividend yield of 1% and a sigma of 20%. We're going to assume that the futuresexpiration and the option expiration coincide and are equal to 0.5 years.In practice this is what typically happens.But of course, for more theory, we could if we like, still price options where thefutures expiration was greater than the option expiration.We'll be able to obtain the futures price lattice on our spreadsheet, by using thefact that s n equals f n, and then using the fact for t less than n, f t is equalto the expected value of f t plus 1, using the risk mutual probabilities.When we do that, we'll see that we get a put option value of 5.21.So let's go to the spreadsheet and see what we get.So here are our initial parameters. We've an initial price of 100, t equals0.5 years or 6 months. Sigma equals 20%.We're assuming 10 periods and or, we have our r and dividend yield as well.So u, d and q are calculated as we showed in an earlier module where we used thebinomial model to approximate geometric boundary in motion and the Black ShoalsModel. So our futures parameters, we're assumingan expiration of t equals 10. So 10 time periods corresponding with 6months, or half a year. Over here we can choose what sort ofoption we want to price. 1 for a call, minus 1 for a put.We're assuming a strike of 100, and the expiration, again, is going to be 10periods. So the option expiration coincides withthe futures expiration. It's going to be a European option.So here we have our lattice, or stock-price lattice.In each time period, the stock price grows by a factor of u, or it falls by a factorof d. If we scroll down, we have the futureslattice. And in this case, we can see, well, bydefinition, f n equals s n at time n. So we see that the futures prices in hereare time t equals 10, agree with the stock prices up here, at time t equals 10.We then work backwards in this lattice, calculating the futures prices using thatformula we showed on this last slide. Okay.So now, we have our futures price lattice. We can now price our options, by simplycalculating the payoff of the option at time t equals 10, the expiration.So in this case it's a put option with strike 100.So when the stock price is greater than 100, the payoff is 0.When it is less than 100, we get a payoff of 100 minus the stock price.So that gives us these values here, and then we can calculate the option byworking backwards in the binomial lattice as we've seen before.In this case, we find the put option value is equal to $5.212.It's worth making a point about how these models are used in practice.In practice, we don't need a model to price liquid options.Market forces, i.e., supply and demand, actually determines the price of options.In this case, this amounts to determining , or the implied volatility.And that is because, if you recall, so the price of a call options c 0 is equal tothe expected value at time 0, using our risk-neutral probabilities of e to theminus r t times s t minus k, the positive part, or if you like this is, equal to,the maximum, of s t minus k and 0. Where under the BlackScholes Model s tequals s 0 e to the r minus sigma squared over 2 times t.Plus sigma, w t. W t here is your standard Brownian motion.So w T is a random variable that's got a normal distribution between 0 and variancet. Anyway, given all of this we recognizethat c 0 is equal to some function of the initial stock price, the risk free rate,the dividend yield, and I should have included the dividend yield up there.Sigma, the time to maturity, and k. And in fact we actually know all of thesequantities. We can see them all in the market place.We know what s 0 is, we know what r is we know what the dividend yield is, we knowwhat the maturity of the option is and we know what the strike of the option is.The only thing we don't know is sigma. However in the case of liquid options, wecan actually observe c 0 the price of the option in the market place.As I said supply and demand is what really sets the price of the liquid options inthe market place. So we can see c 0 and then we can use thisequation to back out the one unknown, which is sigma.And then this is often called the implied volatility.And we'll be returning to this later in the course as well.So at this point you might ask if that's the case, if supply and demand sets theprice of options, why do we need a model? Well we need models for two reasons.One is to help us price what are called exotic or more illiquid derivativesecurities whose prices are not available in the marketplace.We can also use models to hedge options. And I'll return to hedging later in thecourse as well.

## 011.Introduction to Term Structure Lattice Models and the Cash Account

### 021. Introduction to Term Structure Lattice Models

In this section and the next sequence of modules we are going to discuss fix incomederivative pricing in the context of term structure lattice models.We are going to see how the philosophy behind fix income derivative pricing isdifferent to the philosophy behind the binomial model and pricing equityderivative. Fix income markets are enormous and infact they are bigger than equity markets. According to SIFMA, in Q3 2012, the totaloutstanding amount of US bonds was $35.3 trillion.In comparison, the size of the US equity markets was only approximately $26trillion in comparison. Fixed income derivatives markets are alsoenormous, they include interest-rate and bond derivatives.Credit derivatives, mortgage backed securities.And asset back securities, more generally in this section, we're going to befocusing mainly on interest rate and bond derivatives.And we're going to use binomial lattice models to understand these securities.The mechanics of these securities, and also how to price them using risk neutralpricing. The slides and excel spreadsheets shouldbe sufficient. But chapter 14 of the Lunberger text isalso an excellent reference for the material in this section.We're going to use binomial lattice models as a vehicle for introducing both themechanics of fixed income derivative securities as well as the philosophybehind fixed income derivatives pricing. We'll talk more about the philosophy soon.But let's look at some of the most important derivative fixed incomesecurities. We're going to talk about bond futures andalso forwards. We'll also talk about caplets and cap,floorlets and floors, and swaps and swaptions.Now I should mention at this point that Lipor rates are the interest rates, thatunderlie these securities here. Whereas, these securities typically havegovernment rates underlying them. And so these are different interest rates,but we're not going to make that distinction here in these modules.We're going to assume that it's the same underlying rates.And the reasons for doing this are two-fold.We want to focus mainly on the mechanics of these securities, how they work and howthey're priced. We're going to price them using riskneutral pricing. And it would only distract us if we had tofocus on different interest rates when we were pricing different securities.Now fixed-income models are inherently more complex than security models.The problem with fixed-income models is that we need to model the evolution of theentire term structure of interest rates. So, for example, let's come down here andlet's see a little plot of the term structure of interest rates.So we have time, t, here and we have st here.St is going to stand for the spot rate, spot interest rate at time T.And maybe you've got some function like this.So this tells us what the time structure of interest rates look like.So for example, if this is t1, then we have, over there, and that's St1.And St1 is then the spot interest rate that applies to borrowing or lending atthe time t one. So when we want to build a fixed incomemodel or term, term structure model. We need a model which will, which willmodel how this entire curves moves through time, note the distinction.When we have a model for stock prices, we just need to model the evolution of asingle stock. A scale of random variable, here we needto model the entire evolution of this term structure.And so term structure models are inherently more complicated.But actually we're going to see there's some easy ways to get around this problem.One of the classical ways to get around this problem is to focus on what's calledthe short-rate. The short-rate, r little t, is thevariable of interests and many fixed income models, including binomial latticemodels. It is the risk-free rate that appliesbetween periods t, and t plus 1. So r of t is going to be the risk-freerate that applies from period t out to period t plus 1.It's a random process, R is random. Remember, interest rates in the real worldare random, and so this short rate will also be random.However, rt is known to us by time t. So at time t, we know.What we're going to get at time t plus 1 if we deposit $1 in the bank account attime t. What about the philosophy of fixed incomederivatives pricing? Well, what we're going to do here is asfollows. We will simply specify risk mutualprobabilities for the short rate r of t, and we will do this without any referencewhatsoever to the true probabilities of the short rate.This is in contrast to the binomial model for stocks where we specified p and 1minus p and then used replication arguments to get q and 1 minus q, the riskneutral probabilities. What we're going to do is we're going toprice securities, fixed income derivatives, in such a way that guaranteesno arbitrage. We're going to match the market prices ofliquid securities via a calibration procedure.This is often the most challenging part of the entire exercise.And we will see that derivatives pricing in practice is really about extrapolatingfrom liquid security prices to illiquid security prices.So just summarizing here the philosophy of fixed income derivatives pricing is not tofocus on the true probabilities but to go directly to risk neutral probabilities.Do your pricing in such a way that guarantees no arbitrage.Once you do that we'll then pick the unknown parameters in the model, so thatthe model prices will match market prices. That's the calibration exercise, and thatis how we would price fixed income derivatives in practice.So here's an example of a binomial model for the short rate.We're actually going to be using binomial models throughout these modules on termstructure modeling, and fixed income derivatives pricing.We have time as usual, down here t equals 0, t equals 1, and so on.We're going to use the notation rij to specify the short rate at node Nij.So, for example, this point here is node N22.So rij, i refers to time, and j refers to the state.So we're going to number the states from 0, 1, 2 and so on.So what we have here is the binomial model for the short rate.We're going to take 0 coupon bond prizes and we're going to use zcb as a shorthandfor 0 coupon bond, throughout. We'll take 0 coupon bond prices to be ourbasic securities. We will use the notation Z subscript i,jsuperscript k to denote the time i state j price of a zero coupon bonds that maturesat time k. Now its important to get comfortable andfamiliar with this notation. So again Zijk, its the time i state jprice of a zero coupon bond that matures at time k.So for example, if met this point here. Then this z213 is the price, at time 2state 1 up here of a zero coupon bond that matures at time 3 which is here.What we would like to do is we would like to specify binomial model by specifyingall the Zijks at all nodes. Now this is possible, but it's actuallyvery awkward if you want to insure no arbitrage.Moving on more generally, we're going to let Zij be the date i, state, j, price ofsome non-coupon paying security. And what we're going to do, is we're goingto use risk neutral pricing to price every security, every sub security.So for example, let qu and qd be the probability of an up move and a down move.Of course here a down move more, looks more like an across move, but we'll stillstick with qu and qd. So we're going to assume that qu and qdare given to us, and we know them at every node.So at every node, qu is the same, qd is the same at every node and of course quplus qd equals 1 and they're both strictly greater than 0.So what we'll do is we will use risk mutual processing to price every security.So for example, Zij this is the price of the security at time i state j, is goingto be 1 over the discount factor times the probability, risk [inaudible] probabilityof an up move, in which case we have the price at times i plus 1 and state j plus 1plus the risk neutral probability with down move times the price of the securityits in time i plus 1 state j. So if we price every non-coupon payingsecurity like this there can be arbitrage when we priced using 1 and very looselywhen we're trying to this in the next slide but very loosely the reason is asfollows. If you recall it's not possible forexample for this to be greater than or equal to 0, and this to be greater than orequal to 0 and yet have this be less than 0, why?Well qu and qd are both strictly positive. So if qu and qd are strictly positive andthe interest rate is strictly positive, the short rate which would always be thecase, then you cannot have this being the case.And this being less than zero, so it's not possible to construct arbitrages when weprice like this. More generally, if the security pays thecoupon, c i plus 1 comma j, at date i plus 1 and state j, then we have the followingfrom risk neutral pricing again: zed i j is equal to this quantity on the righthand side, where Zi plus 1 dot. So this dot here means it can take on thevalue j plus 1, or j as we see here. So, if we price our coupon paying securityaccording to this, then again we'll see that there can not be any arbitrage.And the reason is as follows. If you recall the definition of our type aarbitrage. So, a type A arbitrage goes as follows.So, we have some security or portfolio whose initial value was less than 0 andwhose final value v1 is greater than or equal to 0.Well, we see that this is not possible here.So, for the same reason i gave in the previous slide, this would be our v1, sothese are the two possible values of v1. So v1 in this state j plus 1 is greaterthan or equal to 0. And v1 in this state of j is greater thanor equal to 0. Then Zi plus Zij must also be greater thanor equal to 0. So this is not possible.Similarly, what we have for type b arbitrage, if you recall.So a type b arbitrage was one where v0 was less that or equal to zero.And v1 was greater than or equal to zero, But v1 was not equal to zero.So in this case what would we have? We would have the following.Let's just erase some of this here. So for type B arbitrage we would have saythat v1 is greater than or equal to zero. And say v1 over in this state j isstrictly greater than zero. And that this must actually be less thanor equal to zero. Well again this isn't possible, qu and qdare both strictly positive. So if all of this is greater than or equalto zero, then qu times this is greater than or equal to zero, and qd times thisis strictly greater than zero. So Zij must be strictly greater than zero.This situation's not possible. So again, we see that a type B arbitrageis not possible when we price like this. Now, before continuing I just want tomention one other item. That is I'm losing, I'm using the wordcoupon very loosely. Obviously it, it denotes the idea of abond, and the coupon one gets more bond. But it could be the cash flow from a swap.The fixed rate minus the floating rate cash flow for example.So I'm going to use the word coupon to denote any intermediate cash flowthroughout these modules.

### 022. The Cash Account and Pricing Zero-Coupon Bonds

In this module we're going to discuss the cash account and the pricing of zerocoupon bonds in the context of the binomial model for the short rate.The cash account and zero coupon bonds are extremely important securities andderivatives pricing in general and so we're going to spend some time nowfiguring out how to price them and understand the mechanics of thesesecurities. >> So let's get started.If you recall this is our binomial lattice model for the short rate.Ri is the Short- Rate that applies for lending between times i out to i plus 1.In general it's a random variable because it can take on any of these values forexample at time 2. So time t equals 2 the short rate or 2could take on this value at state 0, this value at state 1 or this value at state 2.We also have our risk-neutral probabilities q u and q d, and of course,q u plus q d must sum to 1. These are our risk-neutral probabilities,so they're strictly positive, and what we will do is we price everything with theserisk-neutral probabilities. In particular, for example, if we want toprice a non coupon paying security, and I use the term, non coupon here loosely.So, a coupon could refer to any cash flow. So if we want to price in non couponpaying security at time i, state j. Well, we just do our usual discountedrisk-neutral pricing. So Zij, the value of the security at timei state j, is one over one plus the short-rated time i state j, times theexpected value of the security one period ahead, where we take that expected valuewith respect to the risk-neutral probabilities qu and qd.Now as we said as well before, there can be no arbitrage when we price using three.And the reason for that is as follows; If you recall our definition of a type aarbitrage, for example. So a type a arbitrage was a security ofthe form v 0 being less than 0, and its value at time 1, v 1 must be greater thanor equal to 0. So we said any security like this in theone period model constituted type a arbitrage.Well this is not possible over here if we price everything according to 3.And the reason is, so Z will take the place or r v here.We see that it is not possible for this to be greater than or equal to 0, and this tobe greater than or equal to 0, and yet, have this being less than or equal to 0.This is not possible, because the q's and r are all strictly positive.And if the zeds are greater than or equal to 0, then this must be greater than orequal to 0 as well. So we actually cannot get a type aarbitrage. That's not possible.It's the same for a type b. If you recall, a type b arbitrage assumeda security of the following form, V0 less than or equal to 0, V1 greater than orequal to 0, but V1 not equal to 0. Which means that V1 is greater than orequal to 0 in all states and is at least one state where it's actually strictlygreater than 0. Well, again, the exact same argument overhere would show that, that is not possible as well.So there can be no arbitrage when we price according to 3.I now want to talk a little bit about The Cash-Account.The Cash-Account is a particular security that in each period earns interest at theshort rate. We're going to use bt to denote the valueof the cash account at time t and we would be assuming without loss of generalitythat it starts off with a value of 1, so b 0 is equal to 1.The Cash Account is not risk free. And the reason it's not risk free isbecause interest rates are uncertain, they're stochastic.In particular the value of the Cash Account at the time t plus s say, is notknown at time t for any value that's greater than 1.However, it is locally risk-free because I do know the value of B t plus 1 at time t.In fact, B t plus 1 will always be equal to B t times 1 plus the short rate.And I'm going to know the short rate at time t and therefore I will know B t plus1 at time t. So again think of your bank accountanalogy. If I deposit money today for one month, Iknow what rate will apply for that one month period and so I will know how much Iwill get at the end of the month. But I will not know what interest ratewill prevail in one months' time and therefore will not know future values ofThe Cash-Account beyond one month. So a quick thing to notice here, so Bttherefore has this expression here, based on the argument I just gave you, I canlook at Bt plus 1 Bt and divide 1 by the other and see that I get one over 1 plusrt. And the reason I want that expression isdown here, I want to derive equation four here.So how do I derive equation four? Well, again, for a non-coupon payingsecurity, zt times z at time t, state j is equal to 1 over 1 plus rtj times theexpected value of the security one period from now.So this is our familiar risk neutral pricing expression from the previousslide. I can actually rewrite this expression asthe expected value under q, remember q is equal to q u and q d, the risk-neutralprobabilities. And I can replace my 1 over 1 plus rtj,with this expression here bt over bt plus 1.So therefore I can write the value of the non-coupon paying security at time t asbeing the expected value at time t under q.On Z t plus one, multiplied by B t over B t plus one.So rewriting equation four, I can just bring the B t over to the left hand sideand I get this expression here. This is an important expression but I cango a little bit further. I can actually iterate it to get thefollowing. So for example, I can write Zt over Bt isequal to Et. Under q of, well we know it's zed t plus 1over bt plus 1, but I can actually use this equation 5 again to write zed t plus1 over bt plus 1 as the expected value under q.Condition on time t plus 1 information of Zt plus 2 over Bt plus 2.And using the law of iterated expectations, this is equal to theexpected value condition on time t information of Zt plus 2 over Bt plus 2.And I could repeat the same trick again and again.And so, it's easy to see that this condition is hold.So this is our risk neutral pricing condition, for a non-coupon ornon-dividend paying security. In particular, it's the pricing equationthat we use for any security that does not pay any intermediate cash flows betweentimes t and t plus s. When we're doing risk-neutral pricing fora coupon paying security, we use the exact same idea, so Ztj equals 1 over 1 plus Rtjtimes the expected value under q of the value of the security plus the cash flowat time t plus 1 that just gives us this expression here.And for the same reason as before, we can see as long as we price any coupon-payingsecurity this way that cannot be an arbitrage.There is now way that this quantity can be greater than or equal to 0 and yet to haveZtj being less than 0. So you couldn't have a type A arbitragebecause if this is greater than or equal to 0 there is neutral probabilities weknow are strictly greater than 0, this is greater than 0 and so all of thisexpectation must be greater than or equal to 0.So in particular this is not possible. So you couldn't get a type A arbitrage,and for the same reason, you couldn't get a type B arbitrage as well.Alright, so we have seven. Well, it's easy to rewrite seven using thesame ideas we used in the previous slide. I can replace 1 over 1 plus RTJ with Btover Bt plus 1, bring the Bt over to the other side, and I get Expression eight.Now I can iterate, I can substitute in for example, if I substitute in the following;I know that Zt plus Bt plus 1 is equal to the expected value under q conditional ontime t plus one information. Ct plus 2 over Bt plus 2.Plus Zt plus 2 over Bt plus 2. So if I substitute that in down here, I'mgoing to get this expression here when s equals 2.Now it's easy to see that this expression holds more generally for general values ofs, or for integer values of s greater than t.So this is an extremely important condition.We're going to use this throughout this section on term-structure models andpricing fixed-income derivatives that tells us how to price fixed-incomederivatives using risk-neutral pricing and this ensures that there's no arbitrage.In other words, it ensures that we're pricing fixed-income derivatives in amanner which is consistent with no arbitrage.Note also that equation six is actually a special case of nine, because we getequation six From nine by just taking all of these cjs equal to 0.So this is an extremely important result, it guarantees that we can price everythingwith no arbitrage. Here is a sample short-rate lattice.It starts off with the short rate r00 being equal to 6%.And then the short rate will grow by a factor of u equals 1.25 or fall by afactor of d equals 0.9 in each period. It's not very realistic.These interest rates, as you can see, grow quite large here.And given the current economy, global economy, where interest rates are verylow. This example wouldn't be very realistic.But it is more than sufficient for our purposes.In fact, it's good to have such a wide range of possible interest rates.As it makes it easier to distinguish them in the examples that we'll see in thefuture. At this point I should also mention.That you should look at the spreadsheet that is associated with these modules.The spreadsheet you'll see this particular example there.And we're going to be using this example throughout this section to price varioustypes of fixed income derivatives. We're going to be looking at caps, floors,swaptions. Options on zero coupon bonds and so on.So we're going to use this particular short rate example as our model in all ofthese pricing examples. So the first thing we're going to do iswe're going to see how to price a zero coupon bond that matures a time t equal to4. So if we want to do that we're going touse our risk neutral pricing, our risk neutral pricing result If you recall,states that Zt over Bt is equal to the expected value conditional on time tinformation of Zt plus 1 over BT plus 1, and this is a risk-neutral pricingidentity for securities that do not pay coupons or do not have intermediate cashflows. And certainly that is true of a zerocoupon bond. If you recall, a zero coupon bond does nothave any intermediate cash flows. It only pays off its face value atmaturity. And this example matures at t equal to 4.This face value is 100 and this indeed is if you like using our notation for 0 zerocoupon bonds Z44. So what we're going to do is we're goingto bond rate the price to zero coupon bond is to use this expression here by justworking backwards in the lattice 1 period at a time.We know Z44, it's 100. At maturity the, the bond is worth 100, solet's work back and compute its value at time t equals 3.Well, to do that, we can just use this expression.Another way of saying this, and we saw this as well before, this is equivalent tosaying that Zt Is equal to the expected value time t of Zt plus 1 over 1 plus ort. And so in fact it's this version thatwe're going to use. We're going to work backwards computingthe values t at every node by discounting and computing the expected value oneperiod ahead so that's all we're doing here.So, for example, the 83.08 that we've highlighted here is equal to 1 over 1 plusthe short rate value at that node, and if we go back one slide we'll see the shortrate value at that node was 9.38%. So that's where the 0.0938 comes fromhere. And then it's the expected value under qof the value of the zero coupon bond one period ahead.There are two possible values, 89.51, 92.22 and that's what we have here.So we just work backwards in the lattice, one period at a time, until we get itsvalue here at time 0 and this is Z04. The time 0 value of the zero coupon bondthat matures the time 4. Having calculated the zero coupon bondprice at time0, we can now infer from that the actual interest rate that correspondsto, to t equals 4. In particular if we assume part periodcompounding and we let S4 denote the, the interest rate that applies to borrowing orlending for four periods then we know that 77.22 times 1 plus S moved to the power of4 must be equal to 100. So of course we can invert that to getthat S4. Is equal to 100 over 77.22, all to thepower of 1 quarter minus 1 and so that's how we get S4.So there's always a one to one correspondence between seeing the zerocoupon bond prices, and seeing the corresponding interest rate.Therefore it means that we can actually compute all of the zero coupon bond pricesfor the four different maturities. So we can compute the zero coupon bondprice for maturity t equals 1, t equals 2, 3, and 4.And from this we can actually back out, back out the actual interest rates thatapply to these periods. So, for example, we will get a termstructure of interest rates that looks like the following; We have t down hereand we've got the spot rate St here and maybe we'll see something like thefollowing or maybe it's an inverted curve but this point here, so for example t1,that point corresponds to there and it corresponds to some spot rate st1 there.So we can actually use this model to price all the zero coupon bonds.And from all of these zero coupon bond prices, we can invert the message in theprevious slide to get the term structure. The term structure is the term structureof interest rates. We can see what interest rate applies toeach time t. At time t equals 1, for example, we willthen compute a new set of zero coupon bond prices, and obtain a new term structure.So for example at time t equals 0 were down here.But at time equals 1 may be I'm up in this state of the world.So if I'm up in this state of the world I could recompute the time structure ofinterest rates, I could do that by a pricing all of the zero coupon bonds atthis point. I'm going to get a different set of pricesat the set of prices ahead at time t equals 0 and I can invert this new set ofprices to get the new time structure and may be that new time structure will lookdifferent, may be will look something like this.So I will get a new term structure times t equals 1, moreover the term structure Isee will depend on whether I'm up here or down here.So what we've actually succeeded in doing is defining a stochastic model or a randommodel for the term structure of interest rates by just focusing on the short rate.So the short-rate or t is just a scalar random variable or scalar process byfocusing on modeling this short rate, as we've done, we've actually succeeded indefining a stochastic or random model for the entire term structure.And that's actually a very significant point to keep in mind when working withthese short-rate models.

## 012.Fixed Income Derivatives I

### 023. Fixed Income Derivatives  Options on Bonds

In the last module we saw how to price zero coupon bonds.In this module we're now going to go a step further and see how to price optionson zero coupon bonds and options on bonds in general.We're going to discuss European and American column put options on zero couponbonds and see that you can price these securities by just using risk- neutralpricing and working backwards in a binomial lattice model.So here is our sample Short Rate Lattice again.We introduced this in the last module and I mentioned that we're going to see thislattice throughout these examples. So, just to remind ourselves, we start offwith r 0, 0 equals 6%. And then the interest rate grows by factorof 1.25, or it falls by a factor of 0.9 in each period.So this is a Short Rate Lattice. Remember, the short rate is the risk freeinterest rate that applies for borrowing or lending for the next period.What we're going to do is we're going to price an option on a zero coupon bond.The zero coupon bond we consider will be a zero coupon bond that matures at time tequals 4. And we actually considered this bond aswell in the last module. So, in the last module, we saw how toprice this zero coupon bond. If you recall, the way we priced it was,we said that at any time t, zt was equal to the expected value using therisk-neutral probabilities of zt plus 1 over 1 plus rt.And this is our risk-neutral pricing. So we started off at time t equals 4.Where we know the value of the zero coupon bond at this period, z subscript 4superscript 4, it's equal to the maturity of the bond.So you got a face value of 100 dollars back at that period.And then you just work backwards in the lattice using this expression here tocompute the value in the previous period. So we start off here with 100.We come back here and we work backwards. We said for example, the value of 83.08 atthis node is given to us by 1 over 1 plus the short rate to the product of this nodewhich is 9.38%. Times the expected value of the zerocoupon bond one period ahead. And one period ahead was either 89.51 or92.22. So we work backwards and we get a price of77.22. And that's equal to the zero coupon bondprice at time 0 for maturity t equals 4. More generally, of course, we could havepriced this bond as follows. We could have said, we know from ourrisk-neutral pricing, we could have said Z, Z0 over B0 equals the expected valuetimes 0 using the risk-neutral probabilities of Z4, 4 over B4.So if we recall, this is our risk-neutral pricing expression for any security thatdid not have intermediate cash flows. And certainly a zero coupon bond is such asecurity. We know that B0 equals 1.So in fact we would just get that Z04 is equal to the expected value at time 0 of Z4, 4 over B4. So this translates to Z04 equals theexpected value of 100 divided by B4. And so we could have actually calculatedthe zero coupon bond price at time 0 just using this expression and just ca, doingone single calculation instead of working backwards period by period, we could'vedone it all in one step by evaluating this and figuring out the probabilities of thevarious values before and summing these quantities appropriately weighted by thoseprobabilities. So let's get to pricing a European CallOption on this zero coupon bond. The maturity, the expiration of theoption, would be t equals 2. We're going to assume a strike of $84.So therefore the option payoff would be the maximum 0 and Z24 minus 84.This little dot here I've used just to denote the fact that actually this is arandom variable, it will depend on what state we're in, so for example the stateat time 2 will either be 0, 1, or 2. So the underlying zero coupon bond maturesat time t equals 4. So what we need to do is to figure out thevalue of this at time 2. But we've already done that in theprevious slide. We know the option value at time equals 2is given to us by these numbers here. The strike is 84, so in that case, if thestrike is 84 we would not exercise here but we would exercise here and get $3.35and we'd exercise here and get $6.64. And that's where these value come fromhere. So 0, 3.35 and 6.64 are the value of theoption at expiration. So all we're going to do now is use ourusual risk-neutral pricing. Risk-neutral pricing tells us how toevaluate this, so we can simply work backwards in the lattice one period oftime to get the initial value of the option.So for example the 1.56 we see here is equal to 1 over 1 plus the interest ratethat prevails at this node. That interest rate is given to us here at7.5%. So we get 1 over 1 plus 0.75 times a halftimes 0 plus a half times 3.35 and that equals 1.56.And then after calculating that number and 4.74 down at this node, we go back to timet equals 0, and get the initial value of the option.We can see it's going to be 2.97. If we want to price an American option onthe same zero coupon bond, we can do the exact same thing.The only difference being that at each node we stop to see whether or not it wasoptimal to early exercise at that note or not.So here's an example, this time the expiration is t equal to 3, it's going tobe an American put option on the same zero coupon bond and it has the strike of $88.So if we go back to the zero coupon bond, price at t equals 3, well these are theprices at t equals 3. Now you can see that $88 is actually lessthan all of these prices. So in fact, at t equals 3 it would neverbe optimal to exercise because $88 is less, as I said, than all of these prices.So therefore, in fact, the payoff of the put option at maturity at t equals 3 isindeed 0. And that's why we have zeros all alonghere. So now we just work backwards in theladders using our risk-neutral pricing as usual, but also checking in each periodwhether or not it is optimal to early exercise in that period.So for example, the 4.92 here is equal to the maximum of the value of exercising atthat period 88 minus 83.04. Where does that 83.04 come from?Well, that's the value of the zero coupon bond, at that node at time 2.Here it is 83.08. So that's the value we get if we exercisethen and then we alter to compare it to 1, with 1 over 1 plus 9.38%, the expectedvalue under q, the value of the option one period ahead.Well the value of the option one period ahead, as we said, is 0, so therefore atthis point the value of the option is 4.92.And in fact, we just worked backwards, doing that in every note.It turns out that in this example, it's optimal to early exercise everywhere, soit's a very realistic example, but that's fine.We just want to see the mechanism of how the American put option works and how wecan use risk-neutral pricing to, to price it.So, here is the Excel spreadsheet. I hope you have this open with you whenyou're going through these, these video modules.Because you can see how to price all of the securities that we will discuss in thespreadsheet. So up here, we have the parameters of abinomial lattice model. And it begins at 6%, the short rate does,it grows by a fact of u equals 1.25 or falls by factor t equals 0.9, and therisk-neutral probabilities of 0.5 and 0.5. So what you can see here is the firstlattice we've built is the short rate. It starts off at 6%, and then it grows bya certain amount, or falls by a certain amount.This cell is in bold because by getting the correct formula into this cell, I canactually copy this cell forward and across throughout the lattice to populate therest of the cells. So this is our short rate.If I want to price the zero-coupon bond, I come over here.I know the value of the bond is 100 at maturity, which is why I have 100 in allof these cells. And then I want to apply risk-neutralpricing backwards in the, in the lattice. So here I've highlighted in bold thiscell, because this is the cell where I entered the formula.And then I can drag and copy this formula back through the rest of the lattice toget the zero coupon bond prices every note.So I get the value of 77.2, which 77.22 we have seen before.Over here, down here I compute the price of the American zero, of the Americanoption on the zero coupon bond. Over here, I compute the value of theEuropean call option on the zero coupon bond.So you can see again, we've highlighted and bold the cells, the important cells weshould input the Excel formula. Once you've got that in there, you candrag and copy that formula to the other cells.So this is the spreadsheet. We can see how to both construct the shortrate lattice, price zero coupon bonds, and compute European and American optionvalues on those zero coupon bonds.

### 024. Fixed Income Derivatives  Bond Forwards

In this module we're going to discuss how to pass forwards on bonds.We saw when we were discussing the binomial model for equities how to passforward in that case. We'll now we're going to extend that caseto passing forwards in bonds. In the next module will be after this onewill discuss passing futures, and then will be able to see an example of whereforward prices do not equal to futures prices.So here is our familiar short rate lattice, we've seen this now a few times.Short rate begins at 6%, grows by a factor of 1.25 or falls by a factor of 0.9 ineach period. This is the short rate that we're usingfor pricing examples in these modules. So now we want to price the forwardcontract on a coupon bearing bond. We're going to assume delivery takes placeat t equal to 4, and that the bond that's been delivered is a two year 10% couponbearing bond. We assume delivery takes place just aftera coupon has been paid. So how we going to price this?How we going to compute the forward value? Well, we're going to use risk neutralpricing and we're going to use what we know about risk neutral pricing.So, we know the following. For a generic security, let's say it's gotprice s at time t. We know the following.We know that S 0 over B 0 is equal to E 0 undercue of Sn over Bn, and this is riskneutral pricing, for any security that does not pay coupons or have anintermediate cash flow between times zero and n.So this is what we want to use to price our forward.How we going to go from here down to here? That's the question.Well, it's actually very simple. First of all remember we assume the B 0 isequal to $1.00. If it wasn't, if B 0 was $100.00 then B nwould be B n times 100 and we could divide across by the 100 and get back to the casewhere B 0 equals $1.00. So there's no difficulty seeing that B 0equals $1.00, assuming B 0 equals $1.00. Sn, this is the value of the forwardcontracted time n. Well what is the value of the forwardcontracted time n? Well it's this quantity here, it's Z 4 6minus G 0. This if the payoff of the forwardcontract; it's the underlying security, which we're calling Z 4 6, minus theforward price, G 0. So this is assuming that somebody is longthe forward contract. They're buying the security, they'rebuying it for G $0, and they're getting a security that's worth Z 4 6.So this is our Sn, B 4 is this quantity here, what about S 0 over B 0?Well we know B 0 is equal to one, what is S 0?Well if you recall how our forward contract works, it works as follows.We choose the forward price G 0, so that the initial value of the contract is zero.So actually S 0 is going to be equal to 0, and so we get this expression here.And now the goal here is to figure out, what the value of G 0 is that makes thistrue. Well, that's straight-forward.This equation implies that, the expected value, at times 0, of G 0 over B 4, isequal to the expected value at time 0 of Z 4 6 over B 4.As a brief aside, I'll mention, I know I've mentioned this notation a couple ofmodules ago where I said, we'd always use this notation to denote 0 coupon bondprices, but here we're going to use it to denote an actual coupon bearing bondprice. So we get this expression here, but G 0 isa constant at time 0. I know it's value at time 0, so I can takethis outside the Expecation, and I can then bring everything else over to theother side, and I get equation ten here. So this is the forward price.G 0 equals the expected value of Z 4 6 over B 4, all divided by the expectedvalue of 1 over B 4. Now if you recall the expected value of 1over B 4, this is simply, this quantity down here, simply the time zero price of azero coupon bond that matures at time 4 and that has face value of $1.This comes from this neutral pricing again.So this is Z 0 4, and we actually calculated this in the last module.It's actually 77.22 dollars if the face value is 100 dollars, if the face value is1 dollar as we have here, then its price is 0.722.So we actually know the denominator of this expression here.So that means we only need to focus on evaluating the numerator, this.And this is actually very easy to do using our backwards induction or workingbackwards in the lattice. Let's see how we do that.So to compute Z 4 6, what we will do is we'll work backwards in the lattice fromtime t equal to 6. So at time t equal to 6, we know that thevalue Z 6, 6 is 110. And it's 110 because that maturity, youget the face value of 100 back, where you also get the 10% coupon, which correspondsto $10. So the total payoff at t equals 6 atmaturity of the underlying bond is 110. And now we just work backwards at eachperiod, to try and find out the value at t equals 4.So, for example, the 98.44 here is equal to 1 over 1 plus 0.1055, that is the shortrate that prevailed the time t equals 4, so we can see this if we drove back tothis period here, so 10.55 times the expected value of the bond one periodahead. The bond one period ahead will either be107.19[UNKNOWN] or 110.46[UNKNOWN], so that's how we get 98.44.Note that we did not include the $10 coupon at this time, because we said thatthe forward contract delivers the bond just after the coupon at this period hasbeen paid. So that's why we don't include the $10coupon at this period. In contrast, when we're computing thevalue of t equals 5, we actually would include the $10 that's paid in thisperiod, because that actually is a payment to the bond.So we would say that the 102.98 equals $10 plus one over one plus the interest rateof this notde times the expected value of the bond one period ahead which is 110.So doing that, we find the value of the bond that t equals 4, and it's given to ushere. This is the underlying security of theforward contract. So remember our goal is to compute thevalue of this, this is the numerator in the expression for the fair value of theforward price, so I need to compute this expectation here.So we know this is the value at time t equals 4.And I can just work backwards in the lattice and compute its value time tequals 0, I get 79.83. So therefore, using the expression we havefor the fair value of the forward contract, which we see, it should havebeen ten. So we see we're going to get 79.83 dividedby 0.722, which gives us a fair forward price, or an arbitrage-free forward priceof 103.38. We can go to the spreadsheet that youhave, and we can see how these prices were calculated.So as before, these are the parameters for our short rate, so we have initial value6% for the short rate and we see that over the next five periods it can grow up aslarge as 18.31% or be as low as 3.54%. Given the short rate lattice, this enableus to compute the 4 year 0 coupon bond price which we saw earlier at 77.22.Remember we needed this in the denominator when we were calculating the fair value ofthe forward price. So, the next step to do is to compute thevalue of the 10% six years coupon bond. So recall, it pays off at maturity of$110. This is the principle plus coupon of $10.And then we work backwards to find its value at time t equals 5, including thecoupon, which is 10%. Work backwards all the way.In fact, we can actually find that the value of the six year 10% coupon bond attime zero is 24.14. So we do that here although we didn't needto do this to compute the forward price. To compute the forward price we justneeded the x coupon price of the bond. So this is the price of the bond at time tequals 4 but these prices include the $10 coupon that's paid at that period.To get the x coupon price we just subtract $10.And that's what we do down here. So we subtract the coupon, $10 in thesecells, and now we can actually work backwards in the lattice to compute thatquantity, 79.83 that we saw. And finally, we get our value of theforward price which is 103.38.

### 025. Fixed Income Derivatives  Bond Futures

In the last module, we saw to price forwards on bonds.In this module we're going to see how to price futures in bonds.You might recall that the mechanism behind a forward contract is very different thatthe mechanism behind a futures contract. So we're going to see in this module howwe actually get a different price when we price Bond Futures to the price that weget when we price bond forwards. We are now going to price futurescontracts on bonds. In particular, we are going to price afutures contact, contract on the same coupon bearing bond that we considered inthe last module. In that module, we priced a forwardcontract on a coupon bearing bond. Here we're going to price a futurescontract on that same bond. And I'm also going to compare the forwardprice with the futures price. In fact this example is interestingbecause we will see that the forward price is not equal to the futures price.So we're going to have to remind ourselves first about how futures prices areconstructed. So let Fk be the date k price of a futurescontract expires after n periods. Let Sk denote the time k price of thesecurity underlying the futures contract, then Fn must be equal to Sn.After all, at maturity, the futures price and the underlying price must coincide.So we want to compute the futures price at t equals n minus 1, and we can do this byrecalling that any time we enter a futures contract the initial value of the contractis 0. Now, what does that mean?Well, if you recall our risk mutual pricing, our risk mutual pricing states,that for any security, let's say security with price t, St over Bt Is equal to theexpected value at time t using the risk neutral probabilities of St plus 1 over Bt plus 1. This is our familiar risk neutral pricingfor a security that does not pay dividends or coupons, or anti-intermediate cash flowbetween times t and t plus 1. We're going to use this as follows.So we're going to actually take t equal to n minus 1, and we're going to take s t tobe the payoff of the futures contract, or the value of the futures contract.So we know St is equal to 0, because any time you enter into a futures contract youget 0. So therefore, we get 0 here, and then stplus 1, well, the value of the futures contract at that point is going to be Fnminus Fn minus 1. We could also actually interpret thisusing the more general form of this neutral pricing where we included a couponplus the value of the security, divide the security would then be zero and the couponwould be this quantity here. So risk neutral pricing gives this to us,what does that mean? Well it means the following.It means that the expected value 1 to q at time n minus 1 of Fn over Bn.Well, that's Fn minus 1 over Bn is equal to the expected value at time n minus 1,with respect to q of Fn over Bn. Now, Fn minus 1 is known to us at time n.It's the futures price at time n minus 1. So that comes outside, this is also a veryimportant characteristic of the cash account.It is known to us one period earlier. So the value of the cash account to time nis also known to us at time n minus 1. So therefore, this Bn can come outside aswell, it will come outside here. This Bn will also come out, and they willcancel. And what we're left with Is that Fn minus1 equals the expected value under q at time n minus 1 of Fn.And in fact, we've seen this before when we were discussing the binomial model forstocks and pricing futures in that binomial model.So we get this expression here, I can iterate this and actually I can get thisexpression more generally for any time k, I can get Fk equals the expected value ofFk plus 1, conditional time k information. And we can use law of iteratedexpectations to get this expression here or equivalently this expression here.Now, this holds regardless of whether or not the underlying security pays coupons.If you look at how we derived this, whether or not I paid coupons does notmatter. In contrast, the corresponding forwardprice that we saw in the last module is given to us by this expression here.So this is the value of the forward price, this is the value of the futures price,both at time zero. If by the way, and you can see thisimmediately, if interest rates were deterministic In that case Bn would be aconstant, so the 1 over Bn would come out over here, 1 over Bn would come out overhere, they would cancel, and I would be just left with G equals E0 the value of Snwhich is exactly what I have here. So certainly when interest are rates aredeterministic G0 equals F0. In general, interest rates are notdeterministic. I cannot take the one over Bn outside theexpectation here, and in fact these two expressions then do not agree.So now let's compute the fair value of the futures contract on the samecoupon-bearing bond that we considered in the last period.We know that F0 Is equal to E0 under q of Sn, where s n is the security underlyingthe futures contract. Well in this case, the security underlyingthe futures contract is that 10% coupon bearing bond.That is delivered at time t equals 4, just after the coupon has been paid at t equals4. We saw in the last module that this vectorhere, vector here of prices, are the prices of that 10% coupon baring bond of tequals 4, so therefore we want to compute f0, which is the expected value of thispay off here. Well, we can do that easily by justworking backwards in the lattice. Note, however, that when we work backwardsin the lattice we do not discount by 1 over 1 plus the interest rate, becausethere is no discounting going on up here. This is a fair value of the futurescontract at zero, and there is no discounting here, we're not dividing byBn. So in particular, for example, you shouldsee the 98.09 is equal to a half times 95.05 plus a half times 101.14.No discounting taking place when it work backwards in the lattice here.What do we see? We see a value of the futures contract be103.22. This is different to the fair forwardprice that we computed in the last module, that was 1 or 3.38.Now, the numbers are close as you would expect them to be but in fact they are notthe same. So here's an example where the forwardprice and the future's price are actually different.Let's go back and see why? So, if you stop and think about it you cansee that F0 is a weighted average of s n at time n.And G0 is also a weighted average of Sn at time n, and if you think of how the rateswork, the interest rates work It shouldn't be surprising that g 0 103.38 turns out tobe a little bit larger then the futures prize 103.22.And that is because of the manner in which these quantities are computed.If we go to the spreadsheet again and you've seen this already, I hope you havethe spreadsheet in front of you. You see here we have the short ratelattice. We have the four-year zero coupon bondlattice. We use that to compute the 77.22, which weused in turn to compute the forward price of the bond.These are all the calculations for the forward price.Over here we've the calculations for the futures price, so over here we've 91.66down to 111.16. These are the same prices we used for thematurity of the forward and they're equal to actually the value of thecoupon-bearing bond time four, but ignoring the coupon that's paid at thattime. So we get these values, now they can bethe future's price. We just work backwards in the latticecomputing the price at each note. Note that there's no discounting goingback, when we work backwards here and that's because Fk equals the expectedvalue of Fk plus 1 under q. Not the expected value of Fk plus 1discounted under q. So, you see we have our 103.22 here and wehave our 103.38. So the forward price and the futures priceare different. They're very close, but they aredifferent. And this is an example showing you thatforward prices and futures prices are not the same, theoretically, in an arbitragefree model.

## 013.Fixed Income Derivatives II

### 026. Fixed Income Derivatives  Caplets and Floorlets

In this module we're going to see how to price caplets and floorlets, andparticularly we'll focus on caplets but floorlets are priced the same way.Caplets and floorlets in more generally caps and floors are very liquidly tradedfixed income derivatives securities that are found in the market place.So it's important that we understand how to price these securities and understandthe mechanics behind these securities. A caplet is similar to a European calloption on the short-rate r t. It is usually settled in arrears, but acaplet may also be settled in advance. If the maturity is time tau and the strikeis c, then the payoff of a caplet is r tau minus 1 minus e the positive part, or ifyou like, this is the maximum of 0, and or, tau minus 1 minus c.This payment occurs at time tau, so this is what we mean by being settled inarrears. So, you can think of the caplet as being acall option on the short rate prevailing at time tau minus 1, but settled at timetau. A floorlet is the same as a caplet, exceptthe payoff is c minus r tau minus 1 positive part, or as we've been writing,the maximum of zero and c minus or tau minus 1.But again, this payoff would typically take place at time tau.A cap consists of a sequence of caplets, all of which are the same strike, so thesecaplets would all have different maturities but all have the same strike.And a floor consists of a series of floorlets, again all of them having thesame strike, but different materials. So here's our familiar short rate lattice.This is the lattice that we have been working with throughout this section onfixing[UNKNOWN] derivitive securities. We start off with 6% for the short rate,and it grows by a factor of u equals 1.25, or falls by a factor of d equals 0.9 ineach period. What we're going to do is we're going toprice a caplet with this model. So we're going to assume the expiration ofthe caplet is t equals six. In other words, the payment actually takesplace at t equals six. We'll assume a strike of 2% for thecaplet, and now we're going to go ahead and price it.But there's one thing to keep in mind here, the caplet, the pay off of thecaplet takes place in arrears. So for example, suppose we're at this nodedown here 0.28, now in reality, the payment that is determined at, at thatnode will take place at time t equals 6. But it is somewhat awkward to record thepayment here or here, because if we were to record the payment at this point, well,we're not sure, actually, which node is responsible for this payment.Is it this node, 0.28, or is it this node, 0.045?So, that makes the accounting just a little bit awkward.So instead what will do is we will actually record the cash flow, the finalcash flow at the node of which it is determined.So that is at t equals 5, but we will discount it appropriately to reflect thefact that payment does not take place until t equals 6 and that is what we havedone here. So if we look at this point 0.015, 0.015is equal to the payoff of the caplet af, determined at t equals 5, so this is themaximum of zero and the short rate that prevails at that period, which is 3.54%minus the[INAUDIBLE] 0.2. So this is the payoff, of the capital,which is determined at this note, however it is not paid unto type t equals six, andso that is why we must discount it by 1 plus 3.54% to reflect the fact that thepayment is made in the rears. So we do that for all of the notes at timet equals five. These are all of the payments of thecaplet discounted by 1 period. Once we do that we can work backwards inthe lattice using our usual risk neutral pricing.And just to remind ourselves our usual risk neutral pricing takes the followingform s t is the price of whatever security we want to price and it's equal to theexpected value at conditional time t information using the risk neutralprobabilities of St plus 1 divided by 1 plus rt, where rt of course is theshort-rate prevailing at the node your at time t.So this is risk neutral pricing for a security, that does not pay anyintermediate cash flows or coupons. If the security did pay a coupon at time tplus 1 or some intermediate cash flow time t plus 1 we would of course inject thatcash flow into this point here. And here we can see the lattice with allof the caplet prices displayed, for example, the value of 0.021 is calculatedas follows. It is simply one over one plus 3.94%,remember that is the short rate prevailing at this note here, 3.94%.So we get simply 1 over one plus 3.94% times the expect, expected value of thecap at one period ahead, using the risk neutral probabilities which are a half anda half. One period ahead it's either worth point0.28, which we have here, or 0.15, which is what we have down here.So we get the value of the caplet at this node.So again all we're doing is using what we had on the previous slide, we're using thefact that s t equals the expected value, of s t plus 1 over 1 plus r t.So we start off at time t equals 5. At time t equals 5, that is where t plus 1equals 5. We know the value of the caplets; It'sthis value, these values here, and we just work backwards one period at a time to getto time zero and we see a caplet value of 0.042.Now just to be clear, this is the value of the security that pays off r 5 Minus 2%the maximum of this and it's paid at time t equal to 6.Well this 0.42 is how much this is worth, but in practice of course, you mightactually not just buy just one of these, you might buy a million of these.So a million dollars, that would be a notion of 1 million dollars, that price ofthat would therefore be 0.042 times 1 million dollars.So this value here, is the value for a notional of one dollar.We're multiplying this pay off by if you like one dollar here.In general, in practice, you would be actually buying many of these, or sellingmany of these, and so you would need to multiply the price you obtain here by thenotional of the counters. And here we see our familiar spreadsheet,that I hope you've opened in front of you while you go through these calculations.Here we have our parameters for a short-rate lattice or starting off with 6%which neutral probabilities of a half and a half, u equals 1.25, d equals 9.So we have a familiar short-rate lattice that we're using throughout theseexamples, down here we see how to price the caplet.The .0149 is the payoff of the caplet at the time as determined the time equals 5.So that is the maximum of 0, and the short rate which is g 16, which is 3.5%, minusthe strike 2%. But of course that payment does not takeplace until time t equals six so we have to discount by the one plus the short rateprevailing at that node which is again in g 16.So we compute the value of the caplet at time t equals 5, and then we just use riskmutual pricing to work backwards. And I've highlighted the, the cell here inbold because it is this cell which contains the formula, the risk mutualpricing formula for the value of the caplet at this cell.We can then copy and drag this cell formula throughout lattice to determinethe prices at every node. And again, we see the value of the capletis 0.0420.

### 027. Fixed Income Derivatives  Swaps and Swaptions

In the last module, we saw how to price caplets and floorlets.Well there are other liquidly traded fixed income derivativessecurities in the market place and there are swaps and swaptions.So in this module how to price swaps and then how to price options andswaps which are called swaption.Again we will be focusing on the binomial lattice model.And by pricing them in this model, we will also understand andreinforce our learning behind the mechanics of these securities.So here again is our familiar short-rate lattice.We've seen it now many times beginning at r equal to 6%.Rising by a factor of u equals 1.25 or falling by a factor of d equals 0.9.What we want to do initially in this module is the price an interest rateswap with a fixed rate of 5% that expires at t equals to 6.The first payment will occur at t equal to 1,and the final payment will occur at t equal to 6.Now the payment at each node will be the following.It will be plus or minus depending on whether you're long or short the swap.Of the short rate that prevails off that node minus k.But that payment is made in a rears at time t = i + 1.So again, like the caplet that we saw in the last module,we're going to assume that the cash flows in our swap are paid ina rears which is a typical situation that occurs in practice.So just to give you an idea.So for example up at this node here, 18.31%.Well the cash flow at this node will actually be 18.31%-5%.But actually I should say that this is the cash flow that is determined out ofthis node.The cashflow itself will not take place until one period later time equal to six.Similarly the cash flow at this node will be 11.2%-5%.That is the cash determined at that node, it would be paid a time t equal to 4.And so all of the nodes here will have cash flows equal to these values minus5% to be paid one period ahead.How do we price this swap?Well let's go to that.So what we're going to do is to figure out again how much the swap is worth atthe final node.Now the final node again is t equal to 6.But we don't want to record the final values of t equal to 6.Because for example, if we find ourselves at this node here.Well it won't be clear how we got here.Is the payoff at this node because we were at this prior node orwe were at this prior node?And depending on which node we were at in the previous period,we'll get a different cash flow up here.So this is the exact theme situation as we saw the cash in previous module.It's actually much easier to record the cash flows after nodes at whichthey occur.But discount them suitably to reflect the fact that they paid in the rears orin one period later.And that's what we're going to do here, so for example,this 0.723 that we have highlighted up here.Well that is equal to the cashflow, r5 5-K divided by 1 + r5 5.So r5 5-K is the payoff of the swap, but this swap takes place at time 6.So we have to discount it by the short rate that prevails at this node.And so we get this value which is 0.0723 at time t=5 and stays 4.Here's another sample calculation.0.1686, so where do we get this from?Well we're going to get that from our standard risk neutral pricing.Maybe we should write our risk mutual pricing again here.So in this case, risk mutual pricing takes the following form.Let st be the generic value of some security that we want to price.Then we know that st is equal to the expected value,conditional on time t information under the risk mutual probabilities.The payoff or the value of the security one period ahead ST plus 1.But also this swap actually has intermedia cash flows or coupons if you like.We must also include these cash flows CT + 1, discounted by 1 + rt.So this our risk mutual pricing or familiar risk mutual pricing forsecurity that has intermedia cash flows.So this 1.686, for example, how is that calculated?Well it is as follows.It is 1 over the short rate that prevails at that node, so that short rate is 9.38%.And we can check that by going backwards.Here it is, 9.38%.And we have the cash flow, so this is our CT + 1.This is the payment that takes place one period ahead.It is the cash flow determined at this node, but it is paid one period ahead.And these terms here, give us the possible values of ST + 1.So either 0.1793 if we go up or 0.1021 if we go down.So this is just risk neutral pricing.We work backwards in the ladders until we get the time t equals 0.That gives us the initial arbitrary value of the swap, and we find this 0.0990.And again to keep in mind here, this is the fair value of the swap fora notion of $1, right?We're multiplying each of these pay offs, these cash flows by $1.In practice maybe you'd have $100,000 or $1 million and soyou should be multiplying this value then by that notion of a 1 million or $100,000.Now let's consider how to price swaptions.Swaptions like swaps are very liquid securities that are traded allthe time used by many market participantsto both hedge interest rate risk as well as speculate on interest rate risk.A swaption is an option on a swap.So what we're going to do is we're going to consider a swaptionon the swap of the previous slide.We're going to assume that the option strike is 0%.This should not be confused with the fixed rate of the underlying swap.Remember the fixed rate of the underlying swap was, 5%.So we're going to assume that the option strike is 0% andthat the swaption expiration is t = 3.In other words, the option on the swap expires at t = 3.Therefore a time t = 3, if you own the swaption, you have the rightto exercise or enter into this swap for a value or a strike value of 0.So the payoff at t equals to 3 is going to be the maximum of 0 and S3.You will only exercise this swaption at t equals to 3 if S3 is positive.If S3 is negative, then you won't exercise the maximum would be 0 andyou will do nothing.So how are we going to price this swaption?Well actually it's going to be very simple.We're going to use our calculations from the previous slide which we see here, toget the value of the swaption or order to get the value of the swap a t equals a 3.We're going to replace this column of prices with the maximum of 0 on thiscolumn, that will gives us a pay off of swap option at maturity, t = 3.And then we will just calculate the fair value of this pay off by working backwardsin the lattice using risk neutral pricing.One thing to keep in mind though however, is that when we're working back from tequal 3 back to 0, we no longer include the underlying cash flows of the swap.And that's because the holder of the swaptiondoes not get those underlying cash flows.The holder of the swaption will only get the cash flows of associated with the swapif they exercise the t equals 3.And then they will get this swap cash flows forall time periods greater than t equals 3.They will not get them for the periods before t=3.So here are some sample calculations again, for example, soif you look at t equals to 3, this is the pay off of, This swaption.So in fact all of these values here from t equals 4 and 5 are simplythe values that we see that we calculated earlier for the underlying swap.So we see 0.0512 here, well that's the same 0.0512 here.Down here however, is the value of the swaption at maturity.And now this is equal to the maximum of 0 and S3.So if you recall, the only change is actually down here.Because in the underlying swap value,we had a negative value minus 0.0085 at this node.But now, the holder of the swaption would not choose to exercise at this node.Why would they buy something for 0 when it has a negative value?They won't do that.So they will exercise however at all of these three nodes,because these three nodes the swap has a positive value.So certainly the whole of the swaption will exercise at these three nodes andreceive these three payoffs.So what we have is here are the values,the payoff values of the swaption at maturity, at t = 3.It's equal to the maximum of 0 and S3.And now we actually just compute the fair value of the swaptionby computing the value of this payoff backwards in the lattice.So here what we're using in our risk-neutral pricing again,if you like I won't use s here, I'll say Z.So Zt = the expected value of Zt+ 1 divided by 1 + over t.This is our risk neutral pricing for the swaption.Note, I don't have any intermediate coupon or cash flow in here.And that's because the swaption doesn't pay any intermediate coupons orcash flows between t = 0 and t = 3.So I just iterate this backwards to get the value of 0.0620 asbeing the value of the swaption at t = 0.So here's a sample calculation, 0.0908.Well 0.0908 is just 1 over 1 plus, or1 over 1 is going to be 7.5% of this node times the expected value of the swaptionsone period head while the risk mutual probabilities are half in a half.These are the values of the swaption one period ahead 0.1286 and0.0665 and so that's how I get 0.0908.You can see all of this calculations performed in the spreadsheet,they're very easy to do.We see again here that we have our usual short rate lattice that we're usingthroughout.So these are the details here, I won't go through them again.Down here, we calculate the value of the swap, the underlying swap.So there's a fixed rate of 5%, here,we see the payoffs of the swap at time t equals the 5.In fact these are the values of the swap,because remember the payoffs occur time t equals to 6.But we discount them back one period to reflect that the swap cash flowsoccur in the rears.So we do that at time t equals 5,we now work backwards in the lattice using risk mutual pricing.So for example down here, we see that the valueof the swap at this node is the payoff that's determined at that point.So that's the cash flow identified up hereplus the expected value of the swap one period ahead.And that's given to us by these terms here.And of course, I have to discount both of these quantities.The cash flow because of in the rears andthe value of the swap one period ahead by 1 plus the short rate at that node.And that's how I get this expression here.It's in bold again because you can actually enter the formula into the cell.And then drag this formula throughout the rest of the lattice to compute the pricesof the swap at every node.We find an initial swap value of 0.0990.To compute the fair value of the swaption,well all we do is we just repeat really what we did for the swap.We just calculate the value of the swaption at maturity, sowe see it down here.In this case, it's the maximum of the swap value which is given to us here and 0.So that's how we get these values down here.And now we just use risk mutual pricing to work backwards on the lattice.Note that any cell in this lattice, we don't have any intermediate cash flow orwe don't have the cash flow associated with the swap at that time.And that's because the holder of the swaption does not get any of those cashflows or pay any of those cash flows until such time as they exercise the swaption.So we just work backwards to find the initial value of 0.0620.

## 014.The Forward Equations

### 028. The Forward Equations

In this module, we're going to discuss the so-called forward equations.The forward equations enable us to compute the prices what are called elementarysecurities. An elementary security is a security thatpays $1 at a particular time and in a particular state at that time.We'll see that by constructing the forward prices we'll be able to price manyderivative securities very easily. So let's get started.We're going to let P subscript i comma J superscript E denote the time zero priceof a security that pays $1 at time i, and state j, and zero at every other time andstate. Such a security is called an elementarysecurity. Actually, it is sometimes also referred toas an arrow Debreu security, for those of you with some background in economics.This type of security actually has a very important role to play in financialeconomics. So such a security is called an elementarysecurity and we call P subscript i comma j superscript e its state price.We can actually see that these elementary security prices satisfy the forwardequation. So these are the forward equations, we'llexplain where they come from in a moment. We note that P0,0 subscript e equals 1,why is this? Well this quantity here is the time zerovalue of $1 that is paid at time zero and state zero, i.e., today.So $1 today is equal to $1 today. So certainly, this is true.So, starting with this value, we can actually work forward in time to computethe values of the Pij's at every note. For example, suppose this is our binomiallattice. Well, we start off with knowing this valueit is one. And now we can use the forward equationsto get the values of these two nodes. So this value here of one is equal toP0,0. I'll ignore the superscript e just toavoid cluttering the, the slide. This value we want here is P1,0 and thevalue we want up here is P1,1. Well, if you look at these we could seehow to get them. So we can get P1,0 from, this equation andwe can get P1,1 from this equation. In this case we would take k equal to 0.And in this case we would take k even to 0 and that's how, sorry we would take yes kequal to 0 and that is how we can calculate the state prices at time 1.Given that we now know these three state prices we can go forward to calculate P2,1or rather P2,0, P2,1, P2,2. Again using these two equations for theP2,2 and P2,0 and we can use this equation here for p two one.So actually that, this is why they're called a forward equations, we start offwith P0,0 equal to 1. And we actually use these equations towork forwards in the binomial lattice to calculate the state prices for every node.So, where do these forward equations come from?We're going to answer that question on this slide and hopefully make clear.Where these equations come form, so for example, let's consider this elementarysecurity. This is the elementary security that pays$1 at time t equals 3, and stage two. And zero everywhere else, so by definitionthe value of the security is P3,2. However, we can also compute the value ofthe security another way. We can just treat this as a regularsecurity and use risk neutral pricing to compute its value.So if we use risk neutral pricing, we will work backwards in the lattice in the usualway to find its value. So let's do that, so if we work backwards,we can come back to this node. This is node r2,2 up here.Well, the value at node r2,2 is going to be 1 over 1 plus r2,2 times the expectedvalue of the security, 1 period ahead. With 1 period ahead the value of thesecurity is either 0 or it's 1. And so we get this quantity here whichsimplifies down to this expression here. So this is the value of this elementarysecurity at time t equals 2 and state 2. It's value of node n2,0 is clearly 0because at node. At time t equals 2 and state 0 you'll onlyget 0 in the 2 successive states. So its expected discounted value must be0. So therefore we have this, its no thatn2,1 which is here. Well that is given to us by 1 over 1 plusr2,1 times the expected value of the security 1 period ahead and that is 1 withprobability a half. And zero with probability a half, and sowe get this quantity over here. So what we've done is the following: we'veseen, we've come to this elementary security, which is worth one of thisstatement zero everywhere else. We know by definition the value of thiselementary security is P3,2, but by working backwards in the lattice we'vealso computed its value at these three nodes.It's equal to this at r2,2 is equal to this at r2,1 and it is equal to zero atr2,0. So therefore, we can say that P3,2, overhere, must be equal to this quantity times the value of $1 at that node.Well the value of $1 at that node is P2,2 plus this quantity times the value of 1dollar at this node and 1 dollar at that node is actually P2,1 plus zero dollarstimes the value of P2,0 which is the value of $1 at that node.So in fact, all we're doing here is linear pricing.We're actually breaking this security up into this many units of P2,2 plus thismany units of P2,1 plus 0 units of P2,0 and this is indeed, in this case equation13. So this is equation 13.So this is theargument that you get to show that the forward equations are true.It's easy to see that this holds in general for any node any time k state s.If we're at an extreme node at the bottom or at top.Well there's only one predecessor known that's possible, so we would only get oneterm in this equation, and that's why we would either get this equation here orthis equation here. So these are the forward equations we cancalculate the stay prices, or the elementary prices by working forwards intime from t equal to zero. So lets go back through a familiarshort-rate lattice. This is the short-rate lattice we'reconsidering throughout these, these modules.We start off with r equal to 6%, it grows by a factor of u equals 1.25 or falls byfactor of d equals point 9 in every period.So we're going to actually compute the forward prices in this particular model bystarting with P0,0 equals $1, and working forwards to calculate the forward pricesat all future nodes. And this is the lattice with thecorresponding elementary prices, or state prices.So the value at any node, nij is actually Pij.The value of the elementary security that pays $1 time i state j.So how do we get these values, well we know where the 1 comes from.We can work forwards using the forward equations to get these values.So for example, how do we get this value 0.3079, well we know from the calculationwe just did in the previous slide. The 0.3079 is going to be equal to 0.2194time divided by twice 1 plus the short rate prevailing at this node plus 0.4432divided by twice 1 plus the short rate prevailing at the node.So this is just the same calculation that we did in the previous slide.We find that P 0.3079 is equal to the sum of these two quantities here.Now what can you do with these elementary prices or these state prices?Well once you've calculated these state prices many other derivative securitiesare very easy to calculate. For example, suppose we want to computeZ04, the price of this zero coupon bonds. So this is the zero coupon bond, its valueat time 0, maturity 4. Well with face value a 100 we can computeZ04 is just being 100 times. The state prices, the sum of the stateprices, in all of the states time t equals 4.So what are those states a time t equals 4?Well it is these quantities here. So remember a zero coupon bond is going topay $100. And this note a $100 here and $100 hereand so on. So, how much is that worth?Well that must be worth 100 times this elementary security price plus 100 timesthe elementary security price for this note plus 100 times the elementarysecurity price for this note and so on. Again that is just linear pricing inaction and so that's how we get Z04 equals 100 times.The sum of these elementary security prices 0.0449 and so on, and actually thatsummed to 77.22, which we've seen before, we saw this in one of the first modules inthis section where we computed zero coupon bond prices by working backwards in thelattice. Well, we've done it in a different mannerhere. We've done it here by first calculatingthe forward prices by working forwards in time, and iterating those forwardequations. And, then given all of the elementaryprices it was absolutely trivial to compete the price of a 0 coupon [unknown].It was simply the face value times the sum of all the elementary prices at that time.We can also calculate other security prices using these elementary prices.So, here's another example consider a forward starting swap.That begins at t equals 1 and ends at t equals to 3.The notional principle is $1,000,000. The fixed rate in the swap is 7% and thepayments are received at time t equals i for i equals 2 and 3.So this is where the forward feature kicks in.If it was a regular swap you would get a payment of time equals 1.Here we're assuming that you only got a payment at time t equals 2 and time tequals 3. And that payment is based as usual on thefixed rate minus the floating rate that prevail at time t equals i minus 1.So the first payment is at t equals 2, because payments are made in arrears.So the question is, what is the value v0 of this forward swap today at time t equalto zero? Well, how can we calculate that?Actually it's very straightforward. So what we have here are the actual cashflows. For this one, there are actually five cashflows and we can go back to see these cash flows by looking at the short ratelattice. So these cash flows are based on theseshort rate, they occur in arrears, so we should be seeing these cash flows of 7.5minus the fixed rate of 7%, 5.4 minus 7%, 9.38 minus 7%, and so on.These are the [inaudible] of the underlying swap and so indeed here theyare. These are the fixed rate of 7% minus thefloating rate 9.38, 7.5, 5.4, 6.75 and 4.86%.So they're the cash flows of the swap, but remember these cash flows are paid inarrears, one payment ahead. So what we do is we take these cash flowsand discount them by the appropriate short rate.So it's 9.38%, the same value as, as in here, 7.5%, same value as here and so on.So now we've got the value of the cash flows that each of the nodes at whichthese cash flows are determined. Given that we know the elementary securityprices for those nodes, it is just a simple matter of multiplying these valuesby the corresponding elementary security prices.And that is exactly what we have done here.So we see, we got a value of $5,800 for a notional principal of 1 million dollars.So again, we could have priced this forward starting swap if we liked, byworking backwards in the lattice using risk neutral pricing While instead we'vedone something differently. We're still using risk-neutral pricing ofcourse because that's where the forward equations come from.But what we've done instead is we've determined the elementary security pricesvia the forward equations, and then used those elementary security prices tocompute the fair value or the albatrosary value of the cash flows associated withthis forward starting swap. All of these calculations are certainlythe calculations for the elementary security price available to us In thespreadsheet, so we have our short rate lattice.You can see how we actually calculate the elementary prices.We start off with a value of 1 and then we just iterate the forward equation.So we get 0.4717, 0.4717 and these two nodes are [inaudible] equal to 1, and wecan actually iterate forward the forward equations, by using if statements in hereto make sure that we're actually using the correct version of the forward equations.There are three different versions that we saw.We need to make sure that we're using the correct one.And so that's how we do that? We just copy and drag these formulasthrough the lattice and updating the elementary prices at each node or each suband the [inaudible]. Given these we can actually now computeall of the zero coupon bomb, calculating the zero coupon bomb prices now absolutelytrivial, we just sum the corresponding, elementary prices, multiply them by a 100and that's how we get the, the zero-coupon bond prices.So down here, you can just see we're just summing the corresponding elementaryprices, multiplying by 100. And then of course, we can invert thezero-coupon bond prices to get the spot interest rates for that maturity.So for example, 6.68% we get by inverting the 77.22, assuming per periodcompounding. And we did that calculation as well in anearlier module.

## 015.Model Calibration

### 029. Model Calibration

Up until this point, we focused on how to price derivative securities, in particularfixed income derivative securities, in the context of the binomial model.However, we have not said anything yet, about how to calibrate these models.In particular, how should we choose the parameters of these models sothat the model prices match the prices that we see in the marketplace.It is particularly important with derivative securities models that ourmodel prices match market prices.That is the problem of model calibration andwe're going to discuss that problem in this module.Up until now we focused on the pricing of derivative securities.We've taken our model and the parameters of the model as given.What we've done is we've priced everything our bonds, our options on bonds, forwards,futures and bonds, caplets, swaps, and swaptions.We've priced all of these securities using risk mutual pricing.Using risk mutual pricing, ensured that our models were overcharge free.However, a model is no good, unless at the very least, we can get the model pricesto agree with the market prices of liquid securities that we see in the marketplace.Security such as caps and floors, caplets, floorlets, swaps andswaptions are all very liquidly traded.And we can see the prices of these securities in the marketplace.So what we want to do with our model is to pick the parameters of our modelin such a way that the model prices of the securitiesmatch the market prices of these securities.This process is called calibration.What we want to do is calibrate our parameters sothat the model prices agree with the market prices of liquid securities.So we're going to discuss that further in this module.The first thing to keep in mind is that they're actually very money-freeparameters in our binomial model.We have rij's and qij's for all ij.So in fact, there's going to be some sort of approximation to cn squared parametersin our model where n is the number of periods in our binomial model.So what we typically do is we fix some of these parameters, and sothat's in fact what we've been doing until now.We just fixed our qij to be equal to q, which is equal to half for all ij.So we actually assumed our risk neutral parameters orrisk neutral probabilities were half at all notes.We've also assumed that the short rates, rij,were also given to us up until this point.We started off with r being 6%, we let it rise by a factor of 1.25,or fall by a factor of 0.9.Well, we can no longer do that.If we want our model prices to match market prices, we're going to actuallyhave to have some free parameters that we can use to calibrate the market prices.And so that's what we're going to do here.One possible way to do this is to use a parametric form for the rij's.So for example, the Ho-Lee model assumes that rij is equal to ai plus bi times j.So if you recall i is time and j is state.So it assumes that there is a drift component parameter ai andthen there is a volatility component bi.Why do I call this a volatility component?We remember j is the state that we're going to see a time i.j is a random variable.We don't know what statement will be in a time j, so we can interpret bi,the multiplier of the state j as being a volatility parameter.So in this case, we actually only get 2n parameters, ai andbi for i equals 0 up to n minus 1.You can actually check that the standard deviation of the one period rate isthen bi over 2 if you're conditioning on where you are at time i minus 1.Now the Ho-Lee model that should be set is actually not a very realisticmodel at all.There is some real problems with the dynamics induced by this assumption here.However, it has been a very influential model in the term structure literature andsome very interesting term structure models have grown out of some ofthe ideas that were present in the original paper by Ho-Lee.We're going to focus here instead on the Black-Derman-Toy model.The Black-Derman-Toy model assumes that the interest rateat node N(i,j) is given by rij equals ai times e to the b i j.So actually if I take logs across here I'll see that what we're assuming is thatthe log of rij is equal to the log ofai plus bi times j.So we can interpret log ai is being a drift parameter forthe log of the short rate.I make it an interpret bi is being in volatility parameter forthe log of the short rate.Remember, as I said it on the previous slide that the random variable here isthe stage j.And that's why I can interpret bi which multipliesthe random variable as been in volatility parameter.What we want to do is we need to calibrate the model to the observed term-structurein the marketplace and ideally other security prices.So certainly at the very least,any term structure model that you want to use should ensure that the zero-couponbond prices are equivalently the term structure of interest ratesmatches the time structure of interest rates we see in the marketplace.So we're certainly going to want to calibrate our model to zero-couponbond prices.Ideally, we would also want to calibrate to other liquid security prices likecaplets, and swaps, and floors, swaptions, and so on.So this is done in general by choosing the ai's and the bi's to match market prices.For relatively few periods we can actually do this in Excel usingthe Solver Add-In and indeed we're going to do this in a few minutes, butalso more efficient algorithms and software could be used in general.In fact, it would be very straightforward to do thisand/or applies in MATLAB or C++.We'll also see how to calibrate the Black-Derman-Toy model to marketzero-coupon bond prices using Excel, the Solver Add-In in Excel, andthe forward equations.So to get us started let's assume that we have an n-period binomial lattice modelas usual.We will let s1 up to sn be the term structure of interest rates observed inthe marketplace.So these interest rates are given, they're fixed.We see them in the marketplace right now.We're going to assume spot rates are compounded per period.There's no loss of generality in doing this because we can alwaysuse any compounding convention that we like.For now, we're going to make the assumption that bi is equal to b andthat this is known for all i.So this is actually quite a heroic assumption,we'll come back to this in a moment.We're doing this for several reasons, number one is we just want tocalibrate our model to the time structure of interest rates.There are n interest rates, one for each period.There are n parameters ai.So if we fix the b's, andassume they're known, we then have n equations and n unknowns.We're going to need to solve for n ai's using n equations.And those n equations will be the equations that matchedthe term structure in the marketplace to the term structure in the model.So here's how we're going to do this orat least this is how we could do it if we wanted to using the forward equations.We're actually going to be a little bit lazy and let Excel do all the work forus or let Solver in Excel do all the work for us.But this is one way we could go about doing this.We know the following.Well, we know that 1 over 1 plus si to the i is equal to this sumhere of elementary security prices.What is this sum on the right inside?Well if you think about it, i is fixed, so this is the time i,state j elementary security price summing over all states j at time i.Well we know that this is just a zero-coupon bond price at time zero,which matures at time i.And indeed, this indeed is equal to 1 over 1 + si to the power of i.Remember, the fair value of a zero-coupon bond that matures at time i,well that's equal to 1 over 1 + si to the power of i.So this is how we can express an equation forsi, in terms of quantities in our model.These are going to be the elementary security prices.We're going to use the forward equations to actually compute and expression foreach of these guys here.So how can we do that?Well, if you recall the forward equations that we saw in the previous modulewe can substitute n for each pij.When j equals zero we just get one term, when j equals i we get this term.So this term actuallycorresponds to pii.This term is equal to pi0.And then this term here is simply pij,when j is between 1 and i minus 1.So these are quantities this expression is coming from the forward equations thatwe saw on the previous module.Given this we could actually now solve iteratively if we wanted to for the ai's.For example, suppose we start off with i equal to 1.Well, in that case we're going to have the following equation.1 over 1 plus s1 will be equal to p00over 1 plus a0 times 2 plusp00 over twice 1 plus a0 e tothe power of 0 times 2.And this, of course, is equal to p00 divided by 1 + a0.So in fact, we know that p00 = 1,we will know s1 from the marketplace andso this will give us a0.Given a0, this will then give us r00,which we can see from over here.If we know a0, remember, the b's are assumed to be known and fixed.So if we know a0, we're going to know r00.So we have r00, we can then use the forwardequations to get p10 and p01.And now we can move on to i = 2.We can actually use this equation we can get 1 over 1 plus s2 tothe power of 2 is equal to and we can sub in these terms.These terms will just have the p1s,p10 and p11 which we will know already.They will have an a1, which we don't know, but that's what we will solve for.And they will have s2 which we see in the marketplace.So we'll get some quantity here which will depend on a1,we will know everything else and we will there for be able to determine, a1.And we can continue on, on this iterative manner working forwards to determineall the ai's by comparing the si's, which we see in the marketplace,using this equation to compare them with what the model says si must be andfigure out what the ai's are.So, in this spreadsheet, we're actually going to perform such a calibration.We have here a 14 period model,you can think of periods corresponding to years and months, whatever you like.We have the market terms structure of interest rates, so we have 7.3% for1 year or 1 period, 7.6% for 2 years, 8.1% for 3 years or 3 periods and so on.The important thing here is that we see the term structure of interest rates inthe marketplace and it's given to us here in these highlighted cells.We need to assume some starting values for the a values.So we'll just put in the value of 5 for all of these values.The calibration's going to actually determine what the correct values ofa should be so that the model prices of zero-coupon bonds orthe term structure matches the market term structure.Right now for example, we can see here is the market spot rates, 7.3% up to 12.32%.Down here, we have our short rate lattice,this short rate lattice is the Black–Derman-Toy lattice.You can actually see that we're constructing this lattice using the b anda parameters from Black-Derman-Toy.Very important to note over here, we've actually fixed the volatility parameter b,we've assumed that b is a constant for all periods i,and we've set it equal to 0.005.We will certainly be returning to this issue in awhile.Now we've got the risk neutral probabilities which we've assumed tobe q and 1 minus q and that they're both equal to a half.We compute the elementary prices down here using the forward equations, sowe actually copy in our formula in this cell.And then we can drag the formula in this cell throughout the lattice tocomplete the elementary prices at all other nodes.So we have our short rate lattice, we have our elementary prices.Note that these elementary prices are a function of b andthese a's, which at the moment are all set equal to 5.Below that, we can actually sum the elementary prices foreach period, to get zero-coupon bond prices.So for example, if I sum these three guys here, I'm going to get 0.907.If I sum all of these, I'm going to get 0.709.So we're just using what we've seen in an earlier module.That is how we can use the elementary security pricesto compute the zero-coupon bond prices.Once I have the zero-coupon bond prices in the modelI can invert them in the usual way to get the spot rates in my models.So I'm seeing here that the spot rates are 5%, 5.01%, 5.06% and so on.So a very flat term structure where all the interest rates are approximately 5%,and this is following because I've actually assumed that the a's are all 5,and that's to begin with.So what I want to do is, is to do a simple calibration.What I want is, I want to choose the ai's, so that these spot rates down here,that I've highlighted in row 48, I want to choose them sothat they match the market spot rates in row 4.Right now they certainly don't.So how am I going to force them to match that?Well I'm just going to use Solver.I'm going to compute the square differences between those cells, sothis number here for example will be the difference between 5.04 which isthe model spot rate and the market spot rate, which is up in cell I4.I'm going to square it and I get this number here.I'm going to do that forall the periods from i = 1 out to 14, and then down here I summed them.So here is sum of the squared differences, and I want this to be equal to 0.So this is what I'm going to do with Solver.I'm going to try and choose the ai's up there in row 5.I'm going to tell Solver to choose the a's in row 5 so as to minimize this sum here.I want this to as close to zero as possible.So we can do that in Solver.So let's do that.So we have Solver and installed Solver in Excel add-in.We've set the objective to be cell D51.And I want to minimize D51 by changing the variable cells C5 to P5.These are the cells that contain the A's, A0 up to A13.So let's run it.For some reason we're using a Mac here.Solver seems to be quite slow using a Mac.We can see the solution we're getting.I'm getting an objective function of 0.001.Now this looks pretty small.It looks pretty good, but actually I expect it to be even smaller,so I'm going to actually run Solver again and try to get a better solution.When I do this on Excel for Windows I don't need to run it again.I seem to get a very good solution when I run it in Windows.So as you can see I'm actually getting it much smaller now.I'm getting a number by 8.7 by 10 to the minus 11.And so if you noticed, the values of A have now changed.I no longer have 5 in all these cells, by running Solver to minimize the squaredifferences between the market spot rates and the model spot rates,I have succeeded in matching the market spot rates to the model spot rates.So 7.3% let's pick a value.So 9.64% is the market spot rate.My model spot rate is 9.64% for the same period.So now the term structure of interest rates in my model matches the termstructure of interest rates in the market.You might also ask the question at this point well we've just calibrated our modelto the term structure of interest rates in the marketplace.Is that enough?Should we not also be calibrating to other security prices?And the answer to that is absolutely, yes, andwe return to that issue in the next module.

## 016.Pricing in a BDT Model and Pricing in Practice

### 030. An Application  Pricing a Payer Swaption in a BDT Model

In the last module, we discussed the very important problem of model calibrationusing the Black-Derman-Toy model as our example.We saw how we could make sure that the prices of the zero coupon bonds in ourmodel matched the prices of zero coupon bonds in the marketplace.We did this by selecting the parameters, the ai's in the Black-Derman-Toy model toensure that the two sets of prices coincided.In this module, we're going to extend this example a little bit further.We're going to use our calibrated model to price payer swaptions.We're then going to change one of our fixed parameters in the model, recalibrateand price the same payer swaptions again and see what happens to the prices.This is important implications for the whole process of model calibration.In the last module, we saw how to calibrate the Black-Derman-Toy model tothe term structure of interest rates. We're now going to actually use acalibrated Black-Derman-Toy model to price a swaption.We've seen how to price swaptions before and we're going to do so again.The difference now is that we're actually going to use a model, the Black-Derman-Toymodel, that has been calibrated to the term structure of interest rates that wemight see in the marketplace. We're also going to see what happens as wechange certain parameters and then reprice the swaption.So, what we're going to do here is we're going to consider what's called a 2-8payer swaption. So, this is some new terminology here,the, the word payer. So, payer refers to the fact that theowner of the option will pay fixed and receive floating.A receiver swaption, the owner of such a swaption would receive fixed and payfloating. So, what we have is a 2-8 pair swaptionwith a fixed rate of 11.65%. It's an option to enter an 8-year swap in2 years time. The underlying swap payments are settledin arrears so the payments would take place in years 3 through 10.Each payment would be based on the prevailing short-rate of the previousyear. So, we therefore need a 10-period latticewith one period corresponding to one year. Of course, in practice, you would have amuch larger lattice with many periods corresponding to one year.But for our purposes, we will keep it simple with just a 10-period lattice andone-period corresponding to one year. We're going to assume initially that bi isa constant for all i and it's equal to b which is equal to 0.005.If you recall in the Black-Derman-Toy model, in the BDT model, we assume thatrij the short rate of time i [unknown] j is equal to ai times e to the bi times j.So, we're going to assume here that the bi's are constant for all i, and that it'sequal to 0.005. Later on, actually we'll change bi and seewhat that does to the swaption price. So, our calibration parameters areactually going to be the ai's. We're going to choose the ai's so that theterm structure in our Black-Derman-Toy model, matches the term structure in themarketplace. And we actually saw on the last module howto do this. We did it using the solver in Excel, thatwas our lazy, easy way to do it. We could also have done it by using theforward equations, as I also described in the last module.So, returning to the swaption, we're going to assume a notional principle of $1 ormaybe one million dollars. Let S2 denote the value of the swap attime t equals 2. We know how to compute S2 in any binomiallattice, we just discount the cash flows back from t equals 10 to t equals 2 usingrisk-neutral pricing. We also recall that it is easier to recordthe time key cash flows after their predecessor nodes and then discount themappropriately. So, this is why there would be no paymentsrecorded at t equal to 10 in this swaption lattice that we'll see in the Excelspreadsheet in a few minute's time. Once we get back to time t equals 2, wehave the value of the underlying swap. So therefore, the value of the swaptionwill be the maximum of 0 and S2. And then, once we have this at time tequals 2, we just work backwards in the lattice using risk-neutral pricing in theusual way to get the value of the swaption at time t equal to 0.When we calibrate to the 0 coupon bonds in the marketplace, we find the swaptionprice of $13,339 when b equals 0.005. So, in fact, in this case, I'm actuallyassuming a notion of one million dollars. So, I should have had 1 million here.When we change b, so here, b was 0.005. Now if we double the value of b to 0.01,we actually find a different swaption price, we obtain a swaption price of$19,497, which is actually approximately 50% higher than our original value of13,339. Now, when we actually change b, by theway, to 0.1, we must remember to recalibrate our model.We have to recaliberate recompute the a values so that the term structure ofinterest rates in the BDT model matches the time structure of interest rates inthe market. So, we see significant difference inswaption prices even though both models are either model with b equals 0.005 andthe model with b equals 0.01 were calibrated at the same zero coupon bondprices at the same term structure of interest rates, we see very differentswaption prices, $13,000 versus $19,000. So, this is not surprising.Swaption prices clearly depend on market volatility.The more volatile your market is or your model is, the more valuable swaptionprices will be. And if you want to get some intuition forthis, you can think of the following. The payoff of the swaption at maturity, aswe said, is the maximum of 0 and S2. So, if you imagine increasing volatility,well then, what you are doing is you're increasing your upside.The more volatile the market is, the more upside you have in S2, the more spread outit is. So, you're getting more of the upside asyou increase volatility but you're not getting more downside, a more negativeoutcomes. And that's because the negative outcomesare constrained by this value 0 here. You can never get something that's worthless than 0. So, you actually like volatility becauseyou're getting better outcomes or better range of good outcomes with highervolatility, but you are not getting a larger range of poor outcomes, because youare constrained by the, this zero factor here.So, very loosely, that's why when you own an option you like volatility and we'llreturn to this again later in the course when we go back to the Black-Scholes modeland discuss options on stocks. But back to here, so what we're saying iswe shouldn't be surprised that the swaption price is increased as we'veincreased b from 0.005 to 0.01. If you recall, we said before that in theBDT model, log of rij is equal to log of ai plus bi times j.J is our random variable because j is the state at time i, and bi is multiplying j.So therefore, our b parameter is, if you like, a volatility parameter.And the higher the value of b is, the more volatile the short rate is, and therefore,we expect the swaption value to be higher as well.And indeed, that is what we have seen here.Now this, these observations have very important implications for thecalibration, calibration process in general.We want our calibration securities to be close to the securities we want to pricewith the calibrated model. So, what do I mean by close?Well, I mean the following. Because a swaption, the, the value of aswaption depends on volatility. I would like the securities that I'm usingto calibrate my mode, I would like their prices to also depend on volatility.In this example, we have not done that. We've only calibrated the model to zerocoupon bond prices and they do not depend on volatility.The value of a zero coupon bond price is, can be determined from the term structureof interest rates we see in the marketplace today.And actually the volatility of that term structure does not enter into the pricingof these zero coupon bond prices. And so, I would say that zero coupon bondsare not really close to swaptions. I would think securities like caplets andflowlets are actually much closer to swaptions.And that if I was to calibrate a model to caplets and flowlets, then maybe I wouldactually get a more accurate price for my swaptions.We will discuss this further in the next module.So, here is our Black-Derman-Toy model again.We saw in the last module how to calibrate the Black-Derman-Toy model using ExcelSolver. We've already gone ahead and done thathere, so these are our market spot rates. We can imagine having observed these inthe marketplace today, of course, these rates are much, much higher than you wouldsee in the financial markets today, but that's fine.We can just assume that these are the actual rates that do exist today.We assumed and fixed a value of B equal to 0.005.So, I made the comment here that fixing the volatility parameter b, this is not agood idea if we wish to use the model to price fixed income derivatives that aresensitive to volatility. So, you can see that our objectivefunction is very small. We've already done the calibration at thispoint, we see that the model spot rates actually match perfectly the market spotrates that we see up here. And we actually get a pair of swaptionprice of 0.00134. That's for a notional of $1, so if wemultiply it by a million dollars, we get about, a note, we get a price of aswaption of about $13,000. So, we begin here at t equals 9 with thevalue of the swap. Actually, the last payment for the swaptakes place at t equals the 10, but we record this t equals 9 so to bediscounted. We work backwards until t equals 2 and wecompute the value of the swaption. So, this value is equal to the maximum ofzero and the underlying swap. Once we obtain that maximum, we workbackwards in the usual way to get the price of the swaption.So, what's interesting here is I've highlighted the value of the swaption is$13,400 for a notion of 1 million and that's the value when we fix b to be0.005. Over here, on this worksheet, I fixed b tobe 0.01 so I've doubled it. Again, I've already performed thecalibration so that you will see that the term structure of interest rates or if youlike, zero coupon bond prices and the model, match those in the marketplace.And yet, now, I see a swaption price of $19,600.So, what I'm seeing is I, I can say that I've calibrated my model, myBlack-Derman-Toy model to the marketplace but I've only calibrated it to the zerocoupon bond prices in the marketplace. If I want to use my model to priceswaptions, then I need to do a better calibration.I need to include more instruments in my calibration.I need to include instruments whose price depends on volatility in my calibration.So, the upshot of all of these is the following.If I use my calibrated model to price exotic, fixed income derivativesecurities, for example, a swaption, now in the real world, a swaption is notexotic, it's actually a very liquidly traded security.But for the purpose of this example, I can pretend it's an exotic security.So, if I use my model to price an exotic security like a swaption, I need to beaware of the fact that the price I get, very much depends on what securities I useto calibrate the model in the first place. I use zero coupon bond prices and I fixedcertain parameters, i.e., b. If I actually use a different set ofsecurities, maybe caplet prices o flowlet prices to calibrate the model, thenpresumably, I would get a different set of calibrated parameters and therefore, get adifferent swaption price. Users of these models, therefore need tobe very careful about how they were built and how they were calibrated.

### 031. Fixed Income Derivatives Pricing in Practice

In this module which is our last module on fixed income derivatives pricing we'regoing to talk about the practice of fixed income derivatives pricing.We'll explain how it is really not much more than using observable liquid Securityprices to extrapolate and compute the prices of non-observable security prices.We're going to discuss, again, the problem of calibration andhow it is a difficult problem to solve in practice.So, in practice, more complex models than binomial models are used to price fixedincome derivatives today.In fact, the models that are used today are a lot more complicated thanthe binomial models we've seen so far.However, the pricing philosophy is still very much the same.It works as follows.We specify a model under the risk mutual dynamics which we are calling q of thetaand where theta is a vector of parameters that you need to choose.So, for example, the theta's could be the ai's andbi's that we have seen in the Ho-Lee and BDT models.So, we fixed our model.There is some unknown parameters theta.What we will do is we will price all securities with our new model using riskneutral pricing.And if you recall this is our risk neutral pricing framework.So, what we do is we say that Z t over B t where Z t is the price of the security inquestion, B t is the value of the cash account So that is equal to the expectedvalue, conditional in time t information, under the risk neutral probabilitiesof the expected value of the security at time t + s divided by the cash account,plus all the intermediate coupons or cash flows that you receive between times t + 1and t + s, again divided by the cash account value.This is our risk neutral pricing framework,we know that there cannot be any in the model.When we price all of our securities like this.So, that's step number two.Step number three is then to choose data so that the market prices ofappropriate liquid securities agree with model prices of those securities.This is the model calibration procedure.And we've seen in the last module, some examples of how to do model calibration inthe context of the Black–Derman–Toy model.And when our calibration securities [INAUDIBLE] coupon bond prices.The calibration problem typically requires minimizing a sum of squares ofthe following form.So remember, the Theta are the vector of parameters we want to choose in our modelThese could be the a i's or b i's in the black [INAUDIBLE] your [INAUDIBLE] modelso the goal is to choose the thetas in such a way as to minimize the following.So we have a bunch of securities which are indexing by i here andwe have a market price of the i security which is pi market andthen we have our model price of the i security, pi model andthis model price is calculated using this equation here, equation 14.This is our risk mutual pricing that we use in our model.Doing this ensures that our model prices are arbitrage free.So in our model, we can compute this price.We see this in the marketplace.And omega i is a weight, it's a positive weight reflectingthe importance of the ith security in our calibration.Maybe omega i is large for some values or for some securities,and omega i is small for other values.Omega i could reflect, maybe, how certain we are about the market price that we see.Maybe we think this market price is stale, maybe it's a few minutes old, ormaybe there's a wide bid ask on this market price, sowe're not as confident of the true value of the security.Either way the omega i's can be used to reflect the importance of the i securityin the calibration.We also have this additional term, which I won't spend too much time on.But, theta prev stands for theta of the previous calibration.So, the previous model calibration might have occurred the previous day orthe previous hour or the previous half hour.What we want to do typically is make sure that our calibrated parameters don't movearound too much.There are various reasons for this, butit helps to keep the model somewhat stable through time if we penalizeTheta being too far away from the previously calibrated vector theta.And lambda will be a parameter that's greater than orequal to 0 which reflects the importance of this term to the overall calibration.Once this model has been calibrated we can use it to hedge andprice more exotic or illiquid securities.One problem,however, is that this calibration problem is often very difficult to solve.This is typically a known convex optimization problem.Well, if you don't know what I mean by nonconvex basically the upshot of thatis that there will be many local minima.And it would be very hard to find the true solution to this optimization problem.As market conditions change we often find that we need to recalibrate frequently,often many times a day.If the model wasn't right then actually you would only need to calibrate once.So, in fact your model typically in practice is not right it's never evenclose to being right.We always need to recalibrate it.So, this is very different to the situation on the physical sciencesfor example.Or typically if you have the right model then you don't need torecalibrate it very often.In finance unfortunately you do.So, derivatives pricing in practice then is little more thanusing observable market prices to interpolate andextrapolate to price non-observable security prices.But risk-neutral pricing at the model level at least implies that we canextrapolate and interpolate in an arbitrage-free manner.And in case you're wondering,we haven't said anything about the true probabilities in this section.We've discussed fixing con derivatives up to to now, andwe've completely ignored true probabilities.We've only discussed risk-neutral probabilities, Q and one minus Q,and in fact in the binomial model, we set them equal to a half.So, does that mean that the derivative prices andpractise don't depend on true probabilities?Well that is not true.Of course they depend on practise andthe dependence actually enters into the calibration process because the trueprobabilities will enter the market's perception.Of market conditions, economic conditions, political conditions and so on.And so, the markets perception of the two probabilities will certainly enter in hereinto the market prices of these securities.So, implicitly when we do this calibration we're actually Includingthe market's views, the market's probabilities,the market's level of risk aversion, into the entire derivative's pricing exercise.

## 017.Modeling and Pricing Defaultable Bonds

### 032. Modeling Defaultable Bonds

This is the first of two modules where we will introduce you to the modeling ofdefaultable bonds. In this first module, we will introduce amodified binomial lattice for pricing short rates with default.We will show you how to price zero coupon bonds that are default free and zerocoupon bonds that are, have a default and have a recovery associated with them onthis binomial lattice. A defaultable bond is characterized by acoupon payment c, the face value F and the recovery value R, where R is definedas the random fraction of the face value recovered upon default.We also have to specify the probabilities of default.When would the default events happen, what is the rate at which they're goingto happen, and so on. As before, we will work directly with therisk neutral probability, Q. We will model the term structure ofdefault that is the time dependence of default probabilities using the one stepdefault probability h of t. Which is defined as the conditionalprobability that the bond will default over the interval t to t plus 1, giventhe information at time t. So, Ft will represent the information attime t. This is the conditional probability thatthe bond is going to default over the next period.As in the case with other fixed income securities, we are going to calibrate ageof t to market prices. And we will modify the binomial latticeto include defaults. Just as a review, let's look at thebinomial lattice for short rates. The nodes in this lattice were labeled iand j. i went from 0 through n.G went from 0 through i. So, at time zero, you have one node.At time one, you have two nodes. At time two, you have three nodes and soon. So, each of these nodes were beinglabeled i, j. There was a short rated, all of thesenodes r, i, j. And the transition probability was givenby the binomial lattice probability. So, the, at time i plus 1, you could onlyreach states j and j plus 1. The probability that you went from nodei, j to node i plus 1, j plus 1 was qu. The upper probability still is qu.The probability that you went from node i, j to node i plus 1j, it's going to beq of d. And the probability of reaching any otherstate is going to be 0. This was the short rate lattice that weworked with when we were constructing, the short rate lattice for default freebonds. Now, in order to model default, we aregoing to split the node i, j by introducing a new variable that encodeswhether or not default has occurred before date i.i, j, 0 will denote the fact that the state is j on date i, and the defaulttime tau is greater than i. Which means that that time i or date i,the default has not happened. i, j, 1 will encode the fact that thesystem is in state j on date i and the default has already occurred at somepoint before i. And when I say before i, I mean itincludes i as well. Now, for the split lattice, for thesesplit nodes, I'm going to tell you what the transition probabilities are going tobe. Again, these transition probabilities aregoing to be risk neutral transition probabilities.So, lets work through this figure slowly. Here's my state at date i.And here, the possible states at date i plus 1.So, here is date i plus 1. When we looked at the short rate lattice,we had nodes i, j. Now, we've split each of those nodes intotwo nodes, i, j, 0, means default has not occurred, i, j, 1, which means defaulthas occurred. So, the red nodes here, indicate the factthat these are the nodes associates with states where the default has notoccurred. And one, the black nodes are referring tothe fact that these are the states at which the default has occurred.So, what are the transitions out of the state i, j, 0?This is the state where the interest rates are in state j, the date is i, andthe bond has not yet defaulted. Then, the probability qu, you can go tostage j plus 1. At that point, there are twopossibilities, either you can default or you do not default.So, up here, it's qu times 1 minus hij, is the probability that you go to state jplus 1 without default. qu times hij is going to the probabilitythat you go to state j plus 1. And now, you have defaulted.So, instead of going, going from a red node, now you're going to a black node.What about the down probabilities? They are the same.It's going to be qd, times 1 minus hij. This is the probability that you startfrom state i, j, 0. And go to state i plus 1 j 0, meaning nodefault and no default at time i plus 1 as well.What about the probability that you default at time i, it's going to be qd,times hij. Okay?So, in this table emphasizes the same thing.Qi plus 1 s eta, eta is the label for whether there is a default or not.s is the label for the state. You can only go, if you go to stage jplus 1 and eta equals 1, it means default the probability is quhij.If you go to stage j plus 1 eta equals 0, which mean no default, the probability isqu 1 minus hij. This is exactly the same probability thatI just wrote on the figure. What happens with the transition out ofthe default state? So, the transition from the default stateare actually very simple. So, once the bond has defaulted, we aregoing to assume that there is exactly one default event between dates 0 through n.So, once a bond has defaulted, it's always in the default state.So, from this particular default state, you can go to state j plus 1 and defaultand you can go to state j and default. You can never go to the non-defaultstate. So, notice that there are no blue arrowsor black arrows going to the state with no default.What is the probability of going to the state j plus 1?It's the same as the short rate probabilities.So, this is going to be qu and qd. The hazard rates or hij's, which are theconditional probabilities of default, are not going to play a role in thistransition, because once the bond has defaulted, it never reappears and alwaysstays in the default state. The conditional probability of default,hij, is state dependent. It's labelled by both i and j.And therefore, this is date i and this is the state on that particular date.Okay, once we have specified the transition probabilities, we can nowstart thinking about how we are going to price simple securities using thisbinomial lattice. And also, how we can use these simplesecurities to calibrate both the intrastate lattice, as well as thisconditional probability hij. So, the first thing we're going to startwith our default-free zero-coupon bonds. The default-free zero-coupon bonds withexpiration capital T, pays $1 in every state on the expiration date capital T.These are default-free, so no default is possible.Let Z, super tij eta denote the price of the bond, maturing on date i in node ijeta. When a default-free zero-coupon.just by context, this is what I mean here.So, it's the same story. Earlier, we had one node.Now, we have two nodes. This is i, j, 1 and this is i, j, 0.I need to specify what is going to be the price off of a zero-coupon bond in bothof these states. The first thing we recognize is the factthat default events do not affect the default-free bonds.So, whether the, the default event has happened or weather the default event hasnot happened, the price of a default-free zero-coupon bond is going to remain thesame. So, the price of that bond, in both ofthese states, are going to be exactly the same.So, ZTij1 is going to be the same as ZTij0.And, we're going to drop the state corresponding to default, since it doesnot matter to a zero-coupon bond, and just call it ZTij.When we do risk neutral pricing for this default-free zero-coupon bond, it's thesame as that was seen in the terms structure modules.ZTij is simply 1 over 1 plus rij. This is the short rate in node ij.quZTi plus 1j plus 1qdZTi plus 1j. So, this is the expectation of the pricesonce time step later according to the risk-neutral probabilities, discountedback to time i. And as before, as you saw in the modulescorresponding to term structures, we can calibrate the short-rate lattice, thatis, we can compute qd, qu and rij, using the prices of this default-freezero-coupon bonds and other default-free instruments.In the modules, we emphasize the fact that there are too many variables, andoften one sets qu equals to qd equal to a half, and then calibrate the rij to makesure that prices of all the default-free instruments work out to be correct.What about extending this idea to defaultable zero-coupon bonds?So now, the bonds that are, that we are considering, have the possibility thatthey are going to default. And when they default, we're going tostart with the instrument that pays no recovery.So, what does it mean? It means that these bonds pay $1 in everystate at the expiration, provided default has not occurred on any date T less thanor equal to T. If a default occurs at some point, thebond pays 0. There's no recovery.Again, let's see what the pricing works out to be.Z bar T i j eta will denote the price of a defaultable zero-coupon bond maturingat, on date T in node i j eta. Since there is no recovery, we know thatas soon as the bond gets into a default state, its price is going to be zero.The moment a default occurs, you don't get anything, and therefore, the noarbitrage price must be 0. So, ZTij1 is always going to be 0 for alldefault notes ij1. What happens to the price in the newdefault node? Now, we can use risk-neitral pricing.We know what happens to the transitions under the risk-neutral probability.So, the price at iT, iJ0 is going to be 1 over 1 plus rij.This is simple discounting. So, there are four possible states thatyou can go to. You can go to state i plus 1, j plus 1without default. You can go to state i plus 1 j plus 1with default. You can go to state 1 plus 1j withoutdefault. And you can go to state i plus 1j withdefault. What are the corresponding probabilities?It's qu1 minus hij, qd1 minus hij, quhij, and qdhij.We already know that if you're going to a default state, the price of a zero-couponbond with no recovery is going to be 0, so this term drops away.This other term also goes away because it's also a default state.So, essentially the risk-neutral pricing for a zero-coupon bond with no recoveryis, take the prices one times step later and discount them using the risk-neutralprobability. But the risk-neutral probability now hastwo components. One that corresponds to the interest ratedynamics. And another that corresponds to thedefault dynamics. Once you have the prices for alldefaultable zero-coupon bonds with no recovery, you can can calibrate hij usingthose prices. Now, we want to interpret the prices ofdefaultable zero-coupon bonds with no recovery, and try to understand or givean interpretation for what hij is. The risk-neutral pricing, by ignoring thetwo, default state. Essentially happens to be Z bar ij0 is 1minus hij divided by 1 plus rij qu zt, i plus 1, j plus 1, no default, qdZT i plus1j, no default. This fraction here, can be approximatedby e to the power minus rij, hij. And the quantity in the bracket here isactually an expected value with respect to a different probability match up whichwe're going to call the default free risk neutral probability measure.What do I mean by default free? What I mean is that all the default rateshave been pulled out. So, the price of a defaultablezero-coupon bond is set by discounting the expected value by rij plus hij.And that's just coming from the expected, this expectation involves both the rates.So, hij has the interpretation of a one median credit spread.It's state dependent, it's time dependent, and it's a credit spreadbecause if the bond was not defaultable, then I would have discounted only by rij.But because the bond is def, defaultable, I'm going to discount the price by extrainterest rate which is hij, which is exactly the interpretation of a creditspread. The conditional probability of defaulthij is also called a hazard rate. It's the probability of default given nodefault has occurred up to time i. Now, let's extend this to the notion ofrecovery. I'm going to assume that the randomrecovery, R tilde, is independent of the default and interest rate dynamics.And let R denote the expected value of R tilde.As before, let Z bar tij eta denote the price of a defaultable bond maturing ondate i, in node ij eta. But now, I'm going to emphasize the factthat this is after recovery, after whatever recovery amount has been paid.It's the x dividend or the x coupon, here's it's the x recovery price.Again, once the recovery has been done, there are no cash flows available fromthese bonds. We already know that Z bar ij1 is goingto be equal to 0 for all the default notes.What about the no default nodes? The price there, Z bar tij0, is going tobe the discounted value of the prices in the future nodes as before.But now, if a default occurs, you get an expected value R, which ends up playing arole. And therefore, the new risk-neutralpricing for what happens to zero-coupon bonds which are defaultable, but have arecovery, is that this extra term shows up.And we'll stop here. And in the next module, we're going totalk about how to price general bonds and how to use these general bonds or couponpaying bonds to calibrate the hazard rate.

### 033. Pricing Defaultable Bonds

This is the second module on pricing defaultable bonds.In this module, we're going to extend, the idea that we had developed in theprevious module, to pricing coupon bearing bonds, and also show you howthese are done in practice using several bonds and calibration on an Excelspreadsheet. In this module we're going to assume thatthe hazard rates h i j are state independent.This ensures that the default probability is going to be independent of theinterest rate dynamics. It'll be easier for us to keep track ofthe events by defining a quantity called q t which at the risk mutual probabilitythat the bond survives until date t. A simple recursion defines what q t isgoing to be. So look at q t plus one, which is aprobability that the bond survives up to date t plus 1.This is going to be the probability that the bond survives up to date t, and theconditional probability that the bond survives one extra period which is 1minus h t. And therefore you can write q t plus 1 asjust a product of k going from 0 to t, 1 minus h k.Let I t denote the indicator that the bone survives up to time t.So I t is going to be 1, if the bond is not in default at time t, and its goingto be 0 otherwise. Then the indicative variable that thedefault occurs exactly at time t is going to be the difference between I t minus 1and I t. I t minus 1 equals 1 and I t equals 0,tells me that exactly that the bond defaulted at time t.From the definition of I t, it immediately follows that the expectedvalue, under the risk-neutral measure of I t is exactly equal to q t.Once we have this indicator val, variable I t, we can define various events usingthis indicator value, variable. And it's going to be easier for us tokeep track of various events that happen to the bond.We're going to assume that the random recovery rate, R tilde, is going to beindependent of the interest rate dynamics under the risk neutral measure Q.And we're going to let R, without the tilde, denote the expected value of Rtilde under the risk measure, risk neutral measure Q at time 0.Recall that R tilde is a fraction of the face value F 8 on default.Here are the details of the pricing. We are going to assume that the currentdate is equal to 0. t 1 to t n are the future date at whichthe coupons are going to be paid. The coupon on date t k is paid only if it k, the indicator vari, variable that indicates whether the bond is in defaultor not, is equal to 1, meaning that the bond is not in default.Therefore the random cash flow associated with the coupon payment on date t k is ctimes I t k. The randomness comes from the fact thatalthough the coupon payment is deterministic, the fact whether the bondis in, not in default or is in default, is going to be a random quantity.The face value F, is going to be paid on date t n only if I t n is equal to 1.Therefore, the random cash flow associated with the face value payment ondate t n is going to be a deterministic quantity F times the random quantity I tn. The recovery itself is random, sorecovery at date t k is going to be R tilde t k.The random recovery rate times the face value F.But this random quantity is going to be paid only if the default occurs on date tk, which have been indicator vari, variable I t k minus 1 minus I t k.Therefore, the random cash-flow associated with the recovery on date t kis going to be R tilde t k times F times I t k minus 1 minus I t k.Now that we have all the random cash-flows associated with a bond, adefaultable bond with some random recovery, we can now price this bond byjust discounting all of these random cash-flows with respect to the riskneutral measure, and that's what we're going to do on the next slide.Let B t denote the value of the cash account at time t, then the price at time0 of a defaultable fixed coupon bond is given by, the expected value under therisk neutral measure of the random cash-flows discounted by the cashaccount. So C times I t k is the random cash flowassociated with the bond, with the bond coupon payment, it has to, and it occursat time t k, therefore it has to be discounted by the cash amount at time tk. F times I t n is going to be the randomcash flow associated with the face value. It's going to have to be discounted, sothere's no b t, but it's just 1. And, at the rate b t n, R tilde t k timesF is going to be the random cash-flow associated with the recovery at time t k,so it's discounted by B t k, but this extra variables has the default, ofcourse at time t k. Now, we have, we have assumed that thedefault is independent, of the interest rate dynamics.So the first expectation, I can split it up into two expectations.This expectation is the expectation of the default, the second expectation isjust the expectation with respect to the risk neutral dynamics of the interestrate, or the short rate. And this split, happens, only becauseI've assumed that the default and the interest rate dynamics are independent.Again, I'm going to split up the next term into two terms.One that corresponds to the default and one the other one that corresponds to theinterest rate dynamics. And finally with the same, same thingwith the last term, this corresponds to default.And this other one corresponds to the interest rate dynamics.[SOUND]. Now we know from the definition of theindicator function that I expectation under Q sub 0 of I t k is nothing but Q tk. In the expectation under Q sub 0 of I t nis nothing but Q t n. Similarly, this quantity expectationunder Q sub 0 of I t k minus 1 is Q t k minus 1, and E sub 0 super Q of I t k isQ t k. So the, all of these are just coming fromthe definition of the indicator function of the expectations of that indicatorfunction under the risk neutral measure. What happens to these quantities?These are nothing but the prices of the zero coupon bond.So that particular quantity is nothing but the price at time 0 of a 0 couponbond that pays $1 at time t k. This quantity over here, is the price ofthe 0 coupon bond at ti, that pays $1 at time t n.And similarly again, this is the same repeat, it's a 0 coupon bond paying $1 attime t k. We can further simplify this exp,expression. This quantity is nothing but the discountrate up to time t k, discount rate up to time t n, and discount rate up to time tk. Here's a formula that tells me what theprice is. The only thing that is going into thisformula are the discount rates, which are determined by the short rates, and theprobabilities of default that are going to be determined by hazard rates.So in principle, if I had the prices of lots of defaultable bonds with fixedcoupon payments, I can infer from there what the hazard rates are going to be.So my story is going to be, I'm going to assume that the interest rate is dynam,is deterministic and known. We could have calibrated this and youhave done this in another module. To keep the story simple and focus on thehazard rates, we are going to assume that the interest rate dynamics are going tobe deterministic. If that is deterministic, then I canwrite, the model price of a defaultable bond as a function of the hazard rates.I'm going to assume that I have some observed prices of the market bonds and Ican use those prices, and compare it with the model price, get an error.So here's the market price for the Ith bond.Here's the model price for the Ith bond. I compare the two, take the square.That is going to be the error that I'm going to be making on the Ith bond.And I take the sum over all possible bonds, that's the total error, and thecalibration problem that I'm going to be facing, is to minimize over H F H.And I'm going to show you this, using a numerical example in the associatedspreadsheet. So here's a simple spreadsheet that I'mgoing to be working with. In this sheet, I'm just, I'm going toassume, that the discount rate is given to me.So the discount rate is assumed to be 5% per annul, deterministic.And from that interest rate, I can compute out what the discount rates aregoing to be. For the six month discount rate, it'sjust going to be half of this. So if you look at the formula, it's justgoing to be 1 plus R F divided by 2 times the number of half year periods that haveelapsed. So this is simple, this is something thatwe have done before. Now, in this particular worksheet, I'mgoing to assume that the hazard rate, which is going to be the six month hazardrate, is fixed at 0.02. What does that mean?So right now, it's time 0. So the survival probability is 1 becausethe bond exists. Now from this survival probability, Iwant to compute the survival probability and the default probability in six monthsfrom now. The hazard rate of time, 0 is 0.02, sothe probability that I default, in the next six months, is simply going to bethe probability, survival probability times the default probability.The conditional probability, of default is the hazard rate.The probability that I have survived right now is 1.I take the product of that, that gives me the default probability.What is the probability that I survive, it's the probability that I'm survivingright now times 1 minus H, where H is the hazard rate.That gives the survival probability in six months.What is the survival probability in 12 months?It's, again the same thing, which is 0.98, which is the survival probabilityat six months times 1 minus the hazard rate.What is the default probabilitiy? It's the surval probability times thehazard rate. So all of this table has been computedusing, the survival probabilities and default probabilities form the hazardrate. Now let's see what happens to a coupon.So here is a bond, which is a one year bond so it expires in one year.It me, it has two coupon payments and the face value payment.I'm going to assume here that the face value is 100, and the coupon is 5%,therefore the coupon is 5. The recovery rate is 10%.So what happens? So the coupon and face value payments aregoing to be 5 in six months and 105 in one year.The recovery is going to be 10% of the face value, so it's going to be $10 if adefault occurs in six months. It's going to be another $10 if a defaultoccurs in 12 months or a year. How do I compute what is the expectedvalue of the payments? So if you look at this formula, what'sgoing to happen? If the bond survives in six months,you're going to get the coupon payment. So it's going to be 5 times the survivalprobability, which is 0.98, plus 10, which is the recovery times the defaultprobability 0.02, and this happens in six months, and therefore you have todiscount it back using the discount rate, which is 0.98.Similarly, if you look at this one, it's the same formula again.It's the coupon plus 105, which is going to be paid only if you are going to besurviving at time 12 months or in 1 year. So it's H8 times C8.And, in the case that you default, it's going to be I8 times D8, which is thedefault probability times the recovery. It has to be discounted back.So now you're going to use the discount rate of 0.5.Sum all of that, you end up getting what the price of this particular bond isgoing to be. Similarly, if you look at, here isanother example of a bond, it's a two year bond with 8% recovery, same story.[SOUND]. This should be 2%, so that coupon paymentis 2%. So therefore, here are the couponpayments. Here are the recovery rates.If you look at the formula, it's exactly the same.Coupon payment times the probability of survival, recovery times the probabilityof default, discounted back to time 0. Sum it all up, and you end up gettingwhat the price of this bond is going to be.Great. So we know how to price bonds, given thecalibrate, given the hazard rates. Now I'm going to show you the nextspreadsheet, what happens when you calibrate.So here, what I've done, is I have created for you, same bonds as was thereon the last sheet. I took the true price of the bond, and toit, I added a small random quantity. I took the true price that was there andthen I added about $0.10 of randomness. You can play with this and see whathappens when you add more randomness. Here, I'm assuming, just to keep thingssimple, that the hazard rate, the six month hazard rate of default is going tobe constant for a year. So what I've done is that, in the firstyear, the six month hazard rate is an unknown quantity, but in the next sixmonths it's exactly equal. So if you click on this, I've just madeit equal to A6. Similarly, over here I've made it equalto A6, A6 and so on. Once I know the hazard rate, I cancompute the survival probability to the default probability, and I can computethe model price. This is the model price that has beencomputed using whatever these hazard rates are going to be.Now, what I'm going to do, is I'm going to compare the model price with the trueprice, compute the error. This is nothing but the model price minusthe true price squared. I have five different bonds.I'm going to sum up all of those errors. And this is going to be the sum of the 5errors. Add them up, and then I'm going tominimize it. So, if I use solver, what I'm trying todo is, before I go to solver, let me randomly create some instances here.[SOUND]. So there's this a random instance of whathappens to the boat. Now I'm going to go to Solver.And if you look at Solver, all I'm trying to do is, minimize the error of J21.Which is this error quantity here. By changing the variable cells, A6, A8,A10, A12, and A4, and the reason, I left off A16, is because this is the hazardrate that's going to be in the future and it's not going to matter.The A7, A9, A11, A13, and A15 have been left off because, I'm just assume thatthis is going to be equal over the entire year.And the reason I made that assumption is because I only have bonds that I, thatare expiring in the years, and not at six months.And therefore I will not be able to calibrate the next six months of assetrate. So we minimize that.We hit solve. And, it found a solution, and the minimumerror it found was 0.01. And, the prices that you end up gettingis pretty to what you started of with. It's slightly different, it's 0.0201instead of 0.002. Here it's just 0.19 and so on.And that happens just because the error is small.Some of the bonds, it's able to compute it correctly, some of the bonds it's ithas small errors. And so the overall error turns out to be0.01.

## 018.Credit Default Swipes

### 034. Credit Default Swaps

This module is the first of two modules on Credit Default Swaps.In this module, we are going, we are going to introduce you to the details ofwhat a Credit Default Swap is. Talk about, on an intuitive level, of howCredit Default Swaps give you some information about the defaultprobability. And how these quantities can be used forhedging, can be used for investment, can be used for speculation.And how Credit Default Swaps have played an important role in the financial crisisand also the sovereign debt crisis that is currently going on in Europe.The seller of a Credit Default Swap, CDS, agrees to compensate the buyer in theevent of a loan default or some other credit event on a reference entity.The reference entity could be a corporation, it could be a sovereignthat's a country, in return for periodic premium payments.So, the dynamics are as follows. This is what happens to the buyer.So, the buyer pays periodic premiums and what is a premium?It's some coupon rate S, which is also called the spread.d is in a year, it's a fraction of a year.So, d times S is the total coupon that has been accumulated over the years.N is a notional principal. So, there's a certain amount of principalthat has been protected. In order to protect that principal, youhave to pay a spread or a coupon S times N.It has to be paid every d fraction of the year.So, every coupon payment is going to be d times S times N.And this keeps on going until some kind of a credit event happens.Maybe the corporation defaults on the bond, maybe the country is not able tomake an interest payment, and so on. It's, we going to talk about creditevents later on and talk about the fact that defining whether a credit event hashappened or not in itself, a difficult problem.So, once that credit event happens, two things happen.This credit event has happened somewhere in between two coupon payments.There should have been a coupon payment there.There should have been a coupon payment there.So, the credit event happened right in between these two coupon payments.So, at the next coupon payment date, the buyer has to pay the accrued interestover this interval . And I'm showing this with a smaller arrowto suggest that the accrued interest is actually less than the full couponpayment. On the other hand, the seller, the onewho decided to sell the protection on this underlying credit event, after thecredit event has happened at time, at the next coupon date, the seller has to pay 1minus R, where R is the recovery rate, times the notional payment, N.Because the buyer pays premiums, this, the premium payments are sometimes calledthe premium leg of the CDS. And because the seller always pays theamount only on default, this is also called the protection leg.Here's a simple numerical example. So, consider a hypothetical 2-year CDS ona notional principal N equal to $1 million.And the spread S equal to 160 basis points, so just about 1.6%.And lets assume that the payments are quarterly.Suppose a default occurs in month 16 of a 24-month protection period.And the recovery rate at that time is 45%.And now, let's understand what happens to the payments of the buyers and thesellers. The buyer pays premiums, so he payspremiums at month 3, 6, 9, 12, and 15, and this is going to be S, the spread,times the notional principal of $1 million divided by four.Why? Because these are quarterly payments, soit's 1 4th of a year. So, the payments in all of these monthsis going to be $4000. Now, here's month 15.The next coupon is going to be on 18. But in month 16, the default hashappened. So, this is the period over which theinterest has accrued. So, the accrued interest that I have,that the buyer has to pay in month 18, is just 1 3rd of 4,000, so it's $1333.33.What about the payments from the protection's seller?Nothing paid up to month 15, because the default has not happened.Default happens in month 16 and month 18, which is the next coupon date.The seller has to pay 1 minus R times N. R was 45%, therefore, 1 minus R is 55% ofN, which is $550,000. This is the total protection payment.Some other names for these payments. We've called them premium payments.We have called them, another name for the same payment is fixed leg or the fixedpayments. Because the premiums are fixed, exceptfor the accrued interest amount. The name for the protection sellerspayment is also sometimes called a contingent leg or the contingent paymentbecause it's contingent on a default happen.So, the basic model for the CDS cash flow that we're going to be using in thismodule is what we saw in this example. There will be a faction, delta, which isa fraction of a year, times k, would be the times at which the coupon paymentsare going to happen. Delta typically is 1 quarter, that isquarterly payments. And the dates of the payments are alsoset. The March 20th, June 20th, September20th, and December 20th. If the reference entity is not in defaultat time tk, the buyer pays the premium delta which is the fraction times S,which is the spread times N which is the notional principle.If the reference en, entity defaults at some time tao between tk minus 1 and tk,the contract terminates at time tk. So, in the example, the default time was116. This was between the two coupon paymentsat month 15 and month 18. The contract terminates at time 18.The buyer appraised the accrued interest over whatever fraction is left over.So, one month was what we did in the numerical example.And the buyer receives or equally the seller pays, 1 minus R times N where Rdenotes the recovery rate of the underlying.We are going to be working with this basic model to price and understand whatis going to happen to the CDS sensitivities.But the details behind CDSs are enormous. they have been standardized by theInternational Swaps and Derivative Association, ISDA, in 1999.There were changes made in 2003. Then again, changes were made in 2009.And may yet again, changes be made, once if CDSs become exchange trader.And the reason there are so many different details in a CDS contract isthere are many difficult issues. How does one define that a credit eventhas occurred? was the interest payment just late, didit not occur at all? It's a problem.How does one determine the recovery rate? there's often litigation, there's delaysand so on. So, we're not going to be worrying aboutthat in this module. We are going to assume that the recoveryrate is somehow known. And we're going to price assuming thatthis recovery rate is known. But also many, many details.How is the spread set? How is it set for junk bonds versusinvestment grade bonds? What about countries?How is the spread set for countries? When is the coupon payment done?In advance or in arrears? How is the spread quoted?Is the spread quoted in terms of par spread, meaning the value that makes thenet value the CDS equal to 0, or some other standardized spread.All these details are important when you talk about particular CDS contracts.But in order to understand the basic mechanisms of how CDSs work, the basicmodel that we have introduced is sufficient and it highlights all the mainfeatures. So, we're going to focus on the basicmodel to illustrate the details of pricing and the sensitivity to hazardrates, which are the probabilities of default.Later on, in the next module, I'm going to show you that the CDS spread, S isapproximately 1 minus R times h, here R is the recovery rate and h is the hazardrate. So, for a fixed value of R, the CDSspreads are directly proportional to the hazard rate h.And the hazard rate is the conditional probability of default.So, you will end up getting that the conditional probability of default isapproximately equal to S divided by 1 minus R.And therefore, CDS spreads end up giving you a very good handle on the probabilitythat a particular company or a particular country, or a sovereign, is going todefault on the next period. So, here, just as an illustration, I'mshowing you what happens to the fove, what happened to the five year CDS spreadfor Ford, GM and AIG in the first nine months of 2008.The, this data up here, is all in basis points.So, it started around, a thousand basis points, and it went, oh, it startedrising as the dates went by. And it didn't, neither of these companiesactually defaulted. But the probabilities of default aregoing very high because the spreads are going high.AIG went all the way up to 3500 basis points before coming back down becausethis is where bail out event started to happen.The only idea that I wanted to take away from this picture is the fact that CDSspreads react to news events. AIG was very low.And then, suddenly, it started to shoot up because there was feeling in themarket that the default is going to happen.And using the formula that h is approximately equal to S divided by 1minus R, we can back out what is the probability of default from the spreadrates. In this slide, the y axis is inpercentages and not in basis points. [SOUND] And it gives you a sense of thecredit worthiness of different countries. So, if you look at Greece, Greece, allthe way, went up to 25% default on around, 20, 25% spread around January12th. So, if the recovery rate is, let's say,approximately 50%. Then, h, which is S divided by 1 minus R.Will turn out to be, approximately a 50% default probability.So, the, the market taught that the probability that Greece is going todefault is going to be very, very high. The next one over is Portugal, but it'sonly at around 1.5%, which is the period over here.And Germany which is exactly flat down here is pretty close to zero.And so, in some sense its going to be considered the most safe or risk free ofthe countries. Just to give you a sense of what thedevelopment of the applications of CDS, I'm going to trace some of the history.The development of the modern merger CDS is credited to Blythe Masters of JPMorgan. It was created in 1994 to cover JP Morganfor the $4.8 billion credit line that it had issued to Exxon to cover the possiblepunitive damages in the Exxon Valdez spill.So, after extending the credit line, JP Morgan protected itself by buyingprotection from the European Bank for Reconstruction and Development using aCDS. The CDS market, since then, has growntremendously. By the end of 2007, the CDS market had anotional value for 62 trillion. Since then, things have become better.The DTCC estimates of the gross notional amount, gross years stands for the factthat after netting of, off setting CDS agreements, the notional amount in 2012was about 25 trillion. So, 2007 was before the financial crisis,2012 is after the financial crisis and things have started to come down.CDSs is where initially developed for hedging.they allow to hedge concentrations of credit risk privately.So, if, take the example of JP Morgan, Exxon.JP Morgan makes a loan to Exxon. It wants to protect itself.So, there are two possibilities. One, it could write the loan off tosomebody else, in this case, the European Bank for Reconstruction and Development.But that would mean that it would have to inform Exxon that the loan has beenwritten, written to another corporation. That might affect the relationship of JPMorgan and Exxon. Instead, you could construct, you couldcreate a CDS contract and effectively still remove that credit off of yourbalance sheet. you can create, you can hedge creditexposures when no publicly traded debt exists.And this is because CDSs can be written on anything pretty much, and it's acontract, it's not really a bond or a cash bond.And therefore, you can use this construct to hedge against situations where bonds,or publicly traded debt, is not available.Although, CDS can be used to protect against losses, it's very different froman insurance contract. It's a contract that can be returned tocover anything. You can buy protection even when youdon't hold the underlying debt. In order to buy insurance, you have tohold the underline quantity. To buy the insurance on a house, you haveto be the owner of the house. To buy insurance on a bond, you need tohold the bond. You can buy a CDS on a bond without evenholding the bond. CDS is easy to create and until recentlycompletely unregulated. And because of these reasons, investing,and in some cases, speculation, became the main application very soon.CDS has provided an unfunded way to create credit risk.So, in order to take a credit risk on a particular company, you either have totake by the bond or you have to short sell the bond.Now, short selling bonds is very difficult.On the other hand, by writing a CDS from a particular company, you can exposeyourself with a credit risk. You can tailor the credit exposure tomatch the precise requirement. This is because CDS is a contract and youcan precisely define the contract that you want.CDS has allowed you to take view on the credit quality of the referenced credit.If you think that the credit quality is going to go down, you're going to buyprotection. If you think that the credit quality isgoing to go up, then you're going to sell the protection.So, in both directions you can take a view, a positive view or a negative view.Buying protection, which means that when you have a negative view in a market, isoften easier than shorting the asset. So, CDSs are became the real easy way oftaking negative bets on various corporations.Another way CDS has started to be used is to arbitrage between the reference bondand the CDS price. It's not coupon, but a reference bond andthe CDS spreads, gave another opportunity to find an investment opportunity to makethe difference. CDSs have been blamed for the financialcrisis and the debt crisis. And there are many reasons why thishappened. CDS positions are not transparent.The riskiness of financial intermediaries, therefore cannot beaccurately evaluated, because they don't, these positions don't show up on abalance sheet. And because of that, because of the factthat you could not accurately evaluate the riskiness of financialintermediaries, it threatened the trust in all counter parties.Since no one knew who faced losses when a crisis event happened, all the counterparties were suspect and entire trading came to a halt.CDS were treated on an OTC market and because of that, because impossible forany dealer to know what previous deals a customer had made.Resulting in situations where some dealers could make lots of CDS dealswithout putting up enough collateral. So, AIG was able to leverage its highcredit rating to sell approximately $500 billion worth of CDSs, without putting upthe enough collateral. Because it was in the OTC market andbecause they were, because these trades were opaque, it allowed a small number ofCDS traders to take on huge amounts of risk.And it also allowed them to be very severely interconnected in terms of theirobligations. And as a result of thisinterconnectedness, the dealers led to worries about contagion.CDSs also have been blamed during the financial crisis to adversely affect thecost of borrowing of a firm in a country. And recently, more so in the Europeandebt crisis, CDS have been blamed for the fact that the cost of borrowing ofcountries have gone tremendously high. So, the story here is that speculatedpurchase CDS, without holding the underlying debt, sometimes called a nakedCDS. Once a lot of these speculators actuallystart buying these naked CDS, this drives the spread higher.And when the spread goes high, because the market perceives the spread as theriskiness of a particular company or a particular country, the firms startappearing risky. And the cost of borrowing of the firmincreases. The cost of borrowing of the sovereignincreases. And this can lead to collapse.Various policy decisions have been made in the recent past to try to correct allof these problems. Try to get CDS positions and balancesheets. Trying to move the CDS, at least, to aclearing house. And then, to an exchange creditsituation. this allow naked CDSs.Many of these are things that are in, in place, some of them completed, some ofthem are still being discussed. But CDSs have played their role and will,unless something is done, will continue to be a risky part of the economy.

## 019.Pricing Credit Default Swaps

### 035. Pricing Credit Default Swaps

In this second module on credit default swaps we're going to introduce you to avery simple pricing formula for credit default swaps, and then using this simpleformula I'm going to show you how you can price CDSs on a spreadsheet.In this module, we are going to start with a very simple CDS pricing formula.The value of the CDS to a buyer is going to be the risk neutral value of theprotection minus the risk neutral value of the premiums.We're going to assume that the default event is uniformly distributed over thepremium interval delta. So let's walk through each of the piecesthat go into constructing the value for the CDS.The risk-neutral value for single-premium payment on date t k, is going to be deltatimes S. Delta is the period, times S, which isthe spread, times N, which is a notional amount, times the expected value underthe risk-neutral measure at time zero, of I t k divided by B t k.Recall. I t k is the prop, is the indicativefunction that the entity does not default, is not in default.And B t k is a cash account at time t k. So this going to be here simply is adiscounted value of the event that there is no default up to time t k, discountedback to time 0. Using the cash account B t k.Again we're going to assume as we have done in the modules corresponding todefaultable bonds that I t k and B t k are independently distributed, andtherefore I can take the expectation separately.If I take the expectation separately I'll end up getting Q t k which is the timezero probability. That the bond doesn't default up to timet k. This quantity which is Z t k 0 is simplythe expectation or under the risk neutral measure of 1 over B t k, which is nothingbut the price of a zero-coupon bond which pays $1 at time t k.This can further be simplified as the discount rate.Up to time t k. So what's the risk neutral value of allthe premium payments? Just sum this overall times k, that's kgoing from one through n, delta times S time N, which is the coupon payment, thisis the probability that this coupon has to be paid, this is the discounted valueof that quantity. So the expected discounted value of thecoupons is what the coupon payments are going to be.What about the accrued interest. We've got to assume, that if t k is here,and this dot, some default time tau happens, it's uniformly distributed overthis. So the value of coupon that you're goingto be paying, would be approximately half.So that's what this quantity here is. About, this is about, approximately halfthe coupon. And this comes from the fact that we areassuming that the default is uniformly distributed over the interval t k minus 1to t k. Now, what is the probability that thedefault occurs at time t k? It's I t k minus 1 minus I t k, dividedby B t k to discount things over, again. Just taking the expectation and using thefact that the default is going to be independent of the interest ratedynamics. We end up getting that this quantity isgoing to be delta S N divided by 2 q t k minus 1 minus q t k.This is the probabilities of the two indicators times Z t k 0 which is theprice of a zero-coupon bond. Which pays $1 at time t k.We can dis, we can simplify this further and write this quantity as a discountphase. If you add up the two quantities, thistell you the risk-neutral value of the premium and the accut, accrued interestscan be approximated and the approximation here comes from the fact that we'reapproximating this uniform distribution. Is also another subtle approximationwhich I don't want to go in too much detail and that comes from the fact.That if you look at the, hazard rates, those are going to be going monotonicallydown, so even if you assume that the period, that it's going to be in theinterval is going to be uniform, the probabilities are going to be slightlydifferent. We're going to approximate all of thatand assume that it's sort of a flat probability, in that interval.Okay, to sum that up, you get an expression, and we're going to be usingthis expression in the next page to try to figure out what the par value is goingto be. What is the risk-neutral present value ofthe protection or the contingent payment? It's 1 minus R times N.This is going to be the amount of protection that you have to be paid.It's another subtle amount here. We're trying to price the CDS.We're going, but in the pricing we're assuming that the R is known.But really R gets known only on default. So in some sense we're making an implicitassumption that these CDSs have been around, and so we have a good idea whatthe expected recovery is going to be on particular CDS that we are going to bepricing. What is I t k minus 1 minus I t k, thisis the event that a default happens at time t k, and, times B t k which is adiscount that I have to do in order to bring the quantities back to time zero.Again I've gone through two steps. We can first write it as the price ofzero-coupon bond or you can directly go to the discount and I'm directly going tothe discount here. That is the quantity that is going to bethe contingent payment or the protection payment.So S par which is the par spread is defined to be the spread that makes thevalue of the contract exactly equal to 0, you compare this term with that term.This term involves S and solve for S and you end up getting to the solve for, thevalue, the notional amount goes away. It's 1 minus R.This is protection. Down here it's premium plus accruedinterest. If you assume that the defaultprobabilities remain sort of flat over the entire premium interval so q t k isgoing to be 1 minus some hazard rate h times q t k minus 1.Then you can approximate that power spread to be 1 minus R times h divided by1 minus h over 2. And, if you recall, back in the module,the first module in CDS we had said that this is approximately equal to 1 minus Rtimes h, and this is typically because h is assumed to be pretty close to zero.When h starts becoming pretty close to 1, the approximation is not valid and onehas to use a better approximation. As you would intuitively see this isincreasing in the hazard rate h and decreasing in the recovery rate R.In the rest of this module, I'm going to show you this pricing using aspreadsheet. So in this spreadsheet we're going toprice the hypothetical two year CDS that we had introduces in the module.The principal amount for the hypothetical CDS was $1 million.The recovery was set as 45%. So 1 minus R which is the amount that weare going to have to pay is 55% Arbitrarily I'm just setting the interestrate here to be 1% per annum. So using that interest rate, I cancomputer out the discount value, which is right here.So it's just going to be, the quarterly discount is going to be R divided by 4times the month count divided by 3. So that, this interest rate directlygives me the discount rate. The hazard rate.I took it from the calibration worksheet that we worked with for the bonds.So, there, we computed the hazard rate for a six month default probability.Here, we are talking about three month default probability.So I just took that value, and divided it by 2.How did I compute the survival probabilities?I took the same formula. It's going to be the survival probability1 times step before times 1 minus the hazard rate.The only difference is before I was using survival probabilities in absolutenumbers, here I'm looking at them at percentages.What about the fixed payments, which are the fixed coupon payments that.The buyer has to make. This is simply going to be the quantityof the spread divided by 4, and I've left off the notional amount, and I'm going tolook at the notional amount in a moment. So that's the fixed payment that's goingto happen. Now in this column, row F, what we havedone is we have taken the fixed payments and found an expected value, the expectedvalue which takes into account the probability of default.So that's e7 times d7, divided by 100. And this 100 just comes because theprobability of survival is written as percentages.So, the values in this column simply reflect the fact that fixed couponpayment has to be paid only if the reference entity survives up to thattime. This is the present value.We have taken the expected value, multiplied it by the notional amount, andbecause, these spreads are in basis points, I multiplied it by 0.0001 tocovert into absolute numbers. And multiplied it by b7, which is thediscount value to get the present value. Of the coupon payments.Done this for all time periods. That tells me what the total fixed couponpayments are. But we still have to figure out what theaccrued interest is. And, in order to compute the accruedinterest, we need the default probabilities.So here's the default probability. This default probability is just asurvival probability. Times the hazard rate, and I put thatalong this column all the way through. What is the accrued interest?If you click on that, it's we've assumed it to be half of what the coupon paymentis going to be, because we have assumed that this is going to be half waybetween. Times the default probability againdivided by 100 to convert the default probability, which is in percentages,into absolute numbers. What is the present value?You take the notional amount, N, which is of $1,000,000 times the accrued interest,times the discount times again 0.0001 to convert the basis points into.absolute numbers. So this is going to be the present valueof the accrued interest, in different periods.Finally, what about the protection. What is the expected value of theprotection, it's the default probability times 1 minus R divided by 100.The 100 again to take the default probabilities and convert them intoabsolute numbers. What is the present value of theprotection? You multiply by the notional amount,multiply by the discount rate, that tells me what is the present value of theprotection for the different time periods.So the premium leg now is going to be the sum of the present value of all thepremiums and sum of all the present value of the accrued interest.And that tells you what the buyer has to pay.What the buyer will receive is just the sum of all the expected present values ofthe protection payments. This is the net value of the swap at timezero. The difference between the premium legand the protection leg. So, since the value of the CDS ispositive. It, it suggests that this spread is settoo low. it's a good deal for the buyer.The buyer is getting protection at too lower rate.If you increase that spread, to say from 218 to 220 basis points, then you end upgetting that that spread is too high, you end up getting that the differencebetween the premium leg and the protection leg is negative.Which means that it's not been, it's not a good deal for the buyer.This spread has been set too high. You can compute out what the correctspread is going to be. So we're going to set the objective whichis the value and try to solve for the value equal to zero by changing thevariable cells S, it's just a reference cell.And I'm assuming that it's going to be positives.If you solve that and you wait for Solver you end up getting that the spread isgoing to 218.89 which is slightly smaller then then spread that we had startedwith. And this brings us to the end of thismodule.

## 020.Interview with Emmanuel Derman

### 036. Interview with Emmanuel Derman

It is a great pleasure to have Professor Emanuel Derman for a guest lecture today.Professor Derman is co-head of risk at Prisma Capital Partners.He's also the director of Financial Engineering Program at ColumbiaUniversity. He's the author of two books, he's latestbook, Models Behaving Badly: Why Confusing Illusion With Reality Can Leadto Disaster, on Wallstreet and in life, Was one of Business Week's top 10 booksfor 2011. His other book, My Life as a Quant, wasone of Business Week's top ten books in 2004.Way back in 1996, he wrote an article titled Model Risk, where he pointed outthe dangers that inevitably accompany the use of models.Among his many awards and honors, he was named the Sungard IAFE Financial Engineerof the year, in the year 2000. Professor Derman has Phd in theoreticalphysics from Columbia. In the 1980s he worked at AT&T Bell Labs,on developing programming languages for business modelling.From 1985 to 2002 he worked on Wall Street, running quantitative strategies,research groups, and fixed income equities and risk management.He was appointed as managing director at Goldman, Sachs and company in 1997.The financial models that he developed there, in particular, theBlack-Derman-Toy interest model and the Derman Kani Luke volatility model havebecome widely used in the industry. Today, we'll be speaking with ProfessorDerman about models, how they are developed in Wallstreet, using theBlack-Derman-Toy interest rate model as the main context.You moved from Bell Labs to Goldman in 1985.Can you describe what the state of the art was in terms of the products beingused, the models being used and how you made the transition from Bell Labs toGoldman. >> Yeah. I came from Bell Labs to Goldman in 1985.And, it was actually a real pleasure for me at the time.Goldman was, and the whole of Wall Street was experiencing a burgeoning in theapplication of financial models and quantitative financial models to the, tofixed income in particular. And people, Black Shoals had appeared in1973 and people were now busy extending Black Shoals and the methodology of BlackShoals to other sectors. And the disk I would thought a Goldmanwas a fixed income options treasury trading disk, and the big battle at thattime was to try to extend Black Scholes to work for options on treasury bonds.And fixed income was a very good area for applying Black Scholes and quantitativetechnology because, when you deal with fixing com productions.For example Treasury Bonds, they have payments every six months and theprinciple back in 30 years. And so there are a lot of fixed pointsthat you could describe very accurately, mathematically, and it makes the wholefield actually much more amendable to mathematical modelling than equities.Okay. >> How are people modelling these products and how are they using the exisitingmodels to price and trade these products? Okay, so when I arrived I was set towork, I was in a quantitative strategies area but I was set to work other fixedincome options desk that were selling options on Treasury bonds.Options on Treasury bonds were kind of the analog of credit default swaps beinga hot product in the, in the 2000s, that was the hot product of 1985.the economic reason was that interest rates had been coming down since theCarter era in the late 70s. And treasury rates, long term Treasurybond yields that sort of hit 16 or 17% and they were now coming down to 10 or11%. And a lot of the investors in the worldwho invested in fixed income were used to earning 15, 16% and couldn't earn thatanymore. And so what they were doing was, theywere selling call options on the particular Treasury bonds that they ownedto try to get a little extra premium. In exchange for giving away the upside asthey went up, the idea being to enhance their yield.And so this was a big a big area of application for Treasury bond tradingdesks and option trading desks. And for quantitative people who aretrying to build models to understand these things.When I first came to work in the fixed income strategies area, I worked for aguy called Ravi Dattatreya, who had actually built the first model, that Iwill shortly describe, that I set about modifying.And he had a very pragmatic attitude towards things, and one day he said tome, you don't really need to much skill over here, all you need is addition,subtraction, multiplication and division. And most of the time you don't needdivision. And he kind of had a valid point, which Ithink isn't valid anymore now. I mean that people on Wall Street, bothat the quantitative level and at the trading level are much less numerate andmuch less mathematically sophisticated than they are now.And you could get away with a lot less advanced skill and in a way before Ilaunch into describing what I worked on. It was kind of amateur heaven in a sensethat nobody, there weren't a lot of option trading books, there weren't a lotof option valuation books. And if you were reasonably smart and camein and had a good background, you were expected to pick this stuff up from a fewpapers and start working. the product that I started to work on waspricing options on Treasury bonds. And the natural way which the guy Iworked for of he had first modeled this and this was a common practice on WallStreet, was to treat a Treasury bond as a kind of stock.And just apply Black-Scholes to it by moving the model across, by treating thebond as the under-liar instead of the stock price.And so you treated a bond as a stochastic variable whose price could vary in thefuture, and you treated the, the coupon unpaid somewhat as a dividend and youmodeled it's future evolution. there was one problem with this approach,and that's that, if you look at a stock, thirty years from now a stock can take onany uncertain price you can imagine. Whereas a bond, if there's no creditrisk, will always pay you back its principal in thirty years.people in the business call this a pull to par in the model.That one price has to go back to its initial principle value.And so if you use Black Scholes to model the stochastic evolution of a bond price,it's good for the first few months because you can't tell that the bond iseventually going to revert to par. But if you go out to 3 or 4 years, thefact that it's got a finite time to maturity starts to make a big difference.If I can gesticulate to explain what I mean.a stock price evolves out into the future with more and more uncertainty.The bond price goes up, but then it has to come back to par after 30 years, andthe technical term for that is that, it's a Brownian Bridge for the stochasticprocess. Meaning, it's a bridge between itscurrent price, and its terminal price at expiration, which you know.And all the uncertainty is somewhere in the middle, or the maximum uncertainty'ssomewhere in the middle. And, nevertheless it wasn't a bad modelto use for, for short term options on Treasury bonds.For longer term options, people came up with all kinds of, I want to say klugesor adjustments freely pragmatic ones to try to make the price process be aBrownian bridge. So for example Ravid came up with thisidea that, instead of modeling the bond price as the sarcastic variable, youmodel the bond price as a yield to maturity as a log normal sarcasticvariable. Making the yield to maturity log normalmeans it never goes below zero, it's always positive and it can get very largebut since it's a yield to maturity, it doesn't affect the price that much.When you get close to expiration, even a yield of 10,000% has no effect on theprice one day before expiration, so the price does behave like Brownian bridge.so there is an improvement, it wasn't really satisfactory for a bunch ofreasons. the predominant one being that, likeScholes when you, when you do When you do stock options on two different underlyingstocks. Say you do Apple and Google, an option onApple and an option on Google pretty much have nothing to do with each other.You're free to model them independently. You only have to worry about the relationbetween Apple and Google, and the correlation and the covariance, if youdid an option on the combined index that involved Apple and Google.But when you come to bonds, if you want to do a five year option on a 30year bond, and you also want to do a three year option on a 30 year bond.You can't actually pretend that those two options are independent because the, thefive year option will be a three year option two years from now.And so there's a relation between bonds that get shorter in maturity as timepasses and options whose expiration changes as time passes.And so you actually implicitly involved in modeling the whole yield curve.You cannot model one bond as an independent entity.Another way to see this is that in Black Scholes, you have to discount theexpected payoffs at the riskless. And when you Apply Black Shoals to bonds,you have to discount the expected value of the option on the bond, at theriskless rate. But the riskess itself is a reflection ofthe bond price. And so implicity are already modellingtwo bonds, when you treat the riskless rate, and the underlying bond hasseparate instruments. And in fact, Ravi taking some interestingapproaches to trying to do this, he tried to embed in the crude Brownian BridgeModel that treated yield as an independent variable.He tried to make the short discount rate move parallel to the long term yield tomaturity, to reflect the fact in a crude way that yields always tend to move up ordown together, or they're not really one for one.so, this was the way people did things. >> Can you describe how you, Fisher Black, and Boltoy got into a collaboration?And how this idea of modeling short rates came to be? >> Yes, so we were actually.Fisher Black and Boltoy were actually in the equities division, which is wereFisher was located. Boltoy worked for him.And I was in fixed income, working with the bond option desk.And I spent my first two or three months rewriting the bond option model, fixingsome technical errors. Trying to build a calculator, meaning afront end, there were no calculations in those days, and I built a front end forpeople to use the model. I had a lot of experience at Bell Labsbuilding front ends in units. And our Editor user interface thatactually make it, made it very easy for salespeople to talk to clients, model adeal, save a price, talk to them the next day modify it a little bit.And it was kind of interesting that, fixing up the model helped their businessbut I would almost argue at the beginning that adding a good user interface.And good ergonomics help the business much more than actually improving themodel to some extent. And when I finished that they hadmeanwhile involved Fischer who was obviously the world expert on options intrying to model the whole yield curve. Because we all understood pretty clearlythat if you want to rebuild a model for options and bonds, you actually had tomodel the yield curve consistently. And so they sent me to interview withFisher, and I joined the collaboration with him and Bill Toy up in equities totry to build a better model that had no arbitrage violations.And would model the whole yield curve and all options and fix income instrumentsderivative on the yield curve. It was pretty clear to us that we had tostart with a one factor model. Although, late, later we actually triedto extend it to two factors. Because, Black Scholes is a one factormodel and, we all had a sort of a pragmatic idea that, you start simple andadd complexity later. So, if you are going to model the wholeyield curve, and you are only going to use only one factor, the natural thing isto use the short rate, because. In an intuitive way you can think of longrates as reflecting expectation of future short rates.And so if you model the short rates as stochastic process, you can then try tomake sure that long rates come out as the right expected value of short rates, so along bond prices to be more precise. Come out as the expected value of, ofdiscounting all future possible shortrates and expectations.One of the things I actually learned at the time which I always try to tellstudents now, is that you quickly learn that what you have to do is finance isnot average perameters but average prices.Because of convexity, and so You shouldn't average short rates to get longterm prices, you should average bun prices to get bun prices.We started by modeling the short rate, and figured you could model long rates asthe expected value, in some sense of future short rates.We also adopted a binomial model approach for a variety of reasons.The first was, it was very simple to picture, and we were all very familiarwith the binomial model. The second is, one of the things, eventhese days I think, in trying to persuade sales people and traders in particular torely on a new model for business, is they have to understand it.And traders in the 1980s were not as numerate and didn't have advancedmathematical education as some of them do now.And so it was kind of important to us to use a binomial model because you coulddraw diagrams that showed what rates were doing.You could show the nodes, you could show the discounting from period to period ina way that traders were very comfortable with.So for both PR reasons and because we didn't like to be too mathematicallysophisticated. We decided to do everything binomially,and build the computer program to do it so that we could deliver it to them as away of doing business. >> So, it appears that in developing the BDT model there were lots of approximationsmade, there was a single factor model, you put in a second factor later on.there was also this philosophical idea that you had to somehow calibrate modelsto bond prices. That it wasn't a model which was going togive you all the details. was that a conscious decision?How did you decide on that approach. >> Yeah, that, that's an interesting question because, although BDT.There, there were two models that came out around the time we wrote our model.There was Ho-Lee, which was kind of similar in a normal framework and we hadBDT which was a little bit more advanced, and allowed you to vary volatilities butwas logged normally. And logged normal interest rates weremore realistic than normal interest rates which can go negative.There had actually been ten years earlier a bunch of, we had a different attitude.There had actually been ten years earlier a bunch of continuous time extensions ofblack shelves sort of fixed income world. The first one was[UNKNOWN] check whichwas really a[UNKNOWN] model. And the second one was by[UNKNOWN] buttheir aim was different. They were trying to build a model thatcorrectly describes the behavior of[UNKNOWN].And they were theoreticians. And we were actually partitioners workingwith a trading disk and our job Wasn't to model the yield curve.Our job was to model options on the yield curve and give realistic prices for themfor traders. And so we had to take the yield curve asa given, in the same way as option, option traders, option pricers take theunderlying stock price as a given, they don't try to decide whether it's right orwrong. In the same way, we had take the yieldcurve as that's the way it is, now price an option on it.So the whole question of calibration became a big issue, and maybe that's thefirst time in modern history of building these models that it became a name.So the idea was we'll build a model of short rates, but we had to make sure thatwhen you price all fixed income on zero coupon bonds or treasury bonds on theyield curve. On our model they had to reproduce theprice of treasury bonds at the instant that the option was priced.Because when you price an option you want to make sure that you at least price theend line correctly, so this was a question of calibration.We chose a log-normal distribution cross sectionally of short rates and eachlog-normal distribution of short rates had a mean, standard deviation orvolatility and we calibrated those to fit the price of a bun with that majority.By pricing the bun but this cutting all the way down to trees.So it's kind of[UNKNOWN], you price the tree of bond, you fixed everything thenyou went to three and a half years. And you added another layer to the treewith the right mean, and the right standard deviation to place the four yearbond. And we targeted the volatility of bondswhich the traders gave us because that was important for the option.And we targetted the yield of bonds so the price of bonds because that was givento you by the treasury bond market... And the idea was to choose your sort ratedistribution calibrated to reproduce these long yields and long volatilities.Since then I would say that has become a pretty standard method of running allmodels. You know your model is not strictlycorrect, but you want it to reproduce the price of liquid instruments that areunderliers, and you calibrate the model everyday if you have to.Since the financial[UNKNOWN] to make it fit the prices of underliers. >> Over the years you've shared manyinteresting quotes of Fischer Black with me, about modeling, about how he approachmodeling, what was his overall philosophy.It would be great if you could share some of those with our students. >> I came from a physics background, andactually I came to Wall Street as I said in late 1985.And I got very excited about it. Getting a shot in the arm about applyingphysics and math techniques to new area that I have not done before.And, I think I like a lot of people have this illusion that you could sort ofbuild a grand unified theory of finance, in which you would model all fixed incomerates with stochastic process. And consistently price every instrumentin the world and look for arbitrage opportunities, and BDT was anarbitrage-free model in its, in its own limited one factor way.And Fisher was actually much more pragmatic about all of this.He was quite happy to live with an imperfect financial market and havedifferent models that weren't consistent with each other in different areas.And didn't have this overarching desire to unify everything and I only really gotto that point sort of six or seven years later.And I, I have a couple of nice quotes that he wrote in the late 80s and early90s which I think are reflective of his understanding of the way models work.So I have a couple of quotes from papers that he wrote.One he says, it's better to quote estimate a model than to test it.I take quote unquote calibration to be a form of estimation.So I'm sympathetic to it. So long as we don't take seriously thestructure of a model we calibrate. Best of all though is to quote, explore amodel. That's the end of the quote.I think what he's saying there is fighting against the people who don'tlike calibration. There are people who say you're taking awrong model and fitting it to the data with wrong paramiters.And his argument was I don't think this is gospel truth.I think I'm just trying to get a handle on how things will behave in this model.And I sort of come around to the idea that you should think of all of thesemodels as imaginary worlds that you're trying to construct.Which don't reflect the real world in all its details but may Be consistent withparts of it. And you calibrate a lot of differentmodels to the same data and see how, why the range of prices you get, when you,when you pass the same instrument calibrated to the same underliers underdifferent stochastic models. he's got another quote which I like too,even better. He says, my job I believe is to persuadeothers that my conclusions are sound. I will use an array of devices to do thistheory, stylized affects, time series data surveys and appeals tointrospection. I particularly like the appeals tointrospection because he's making clear that finance isn't just a science, it's ascience of the way people behave and and an art.And he's looking inside himself to try to get an idea of, what's a sensible waythat people would try to come at prices, and then model that.the last quote I wanted to say, is, He says, in the world of real research,conventional tests of statistical signifigance seem almost worthless.I particularly like that, because when people new.Either students or even people who are economists come to Wall Street.In my experience, they always. Have greta expectations for models andthink they're going to be used in a, in a way that explains the truth.And think you should test them very carefully to calibrate them, find thebest model and then use that. And the truth is, the financial worldgoes through regimes of change, and the same models don't work in the sameperiod. And if you try calibrating one model to30 years. It doesn't work because you really haveto use different, different models at different times, and I think he kind ofunderstood that. He was also a big believer inrationality, Fisher, in that he once wrote an internal article at Goldmannthat said, you should pay traders not for the results that they get but for thestories that they tell. About why they made money or why theytried to make money because you want to encourage them.To think, rather than to simply reward them for luck. >> Thank you very much.

## 021.Introduction to Mortgage Mathematics and Mortgage-Backed Securities

### 037. Introduction to Mortgage Mathematics and Mortgage-Backed Securities

In the next series of modules, we're going to discuss mortgage mathematics andmortgage backed securities.We're going to look at more mortgage backed securities because they will giveus an example of the process of securitization.That is the process by which new securities are created frompools of underlying loans or mortgages.So we're going to begin in this module with basic mortgage mathematics andan introduction to the mortgage markets.We called it according to SIFMA, the Securities Industry andFinancial Markets Association, that in the third quarter of 2012,the total outstanding amount of US bonds was $35.3 trillion.Now if you look at this you can see that the mortgage market actually accounted for23.3% of this total.So the mortgage markets are therefore huge, andthey played a big role in the financial crisis of 2008 and 2009.And that's one of the reasons we're going to talk about mortgages andmortgage backed securities over the next few modules.It is interesting to understand what they are and how they are constructed.And some of the mechanics behind the basic ormore standard types of mortgage backed securities.Mortgage backed securities are a particular class of what are calledasset-backed securities.These are assets-backed by underlying pools of securities such as mortgages,auto loans, credit card receivables, student loans, and so on.The process by which ABS ormortgage-backed securities are created is often called securitization.Here's a picture of how securitization works in the context of mortgages andmortgage backed securities.What we have here are 10,000 different mortgages.Each of these mortgages corresponds to a different home owner.What we do is, we combine these 10,000 mortgages into one big pool of mortgages.So these 10 000 mortgages formed the collateral forthe mortgage back securities that we will create.Here, we have what are called Tranches, Tranche A, Tranche B, Tranche C,and Tranche D, and Tranche E.We won't worry about these are right now with seen example of this later on, butbasically what we're getting at is the following idea.We combine these 10 000 mortgages into accrual of mortgages or a pool of loans.And then from this large pool,we can construct a series of different securities.Each of these securities are labelled Tranche A to Tranche E, and the payments,the mechanism,the risk characteristics of each of these securities are very different.Even though they're all built from the same underlying pool of loans ormortgages.So this is the process of securitization, now you may ask the following question.Why bother with securitization?So why securitize?Well a standard answer to this, Is that bysecuritizing we are enabling the sharing or spreading of risk.So it is in order to share risk, if you like,anyone of this individuals mortgages might be risky by itself.Maybe the owner of the home will default and not pay.So anyone mortgage by itself might be to risk for a small bank to hold.So instead what they can do is they can pull all of these mortgages together.And then sell them off to investors who willing to bear that risk.We will look at some examples of the mortgage backed securities, butfirst we must consider the mathematics of the underlying mortgages.Now there are many different types of mortgages, both here in the US andin different parts of the world.We're going to consider just level payment mortgages.Level payment mortgages are mortgages where a constant payment is paidevery month until the end of the mortgage.So that's a level payment mortgage, but there are other types of mortgages.For example, adjustable rate mortgages are mortgages where the mortgage rate isreset periodically.And in fact these kinds of mortgages actually played quite a big rolein the subprime crisis.So as I said, we're only going to consider level payment mortgages, but that's fine.It's important to note though, that mortgage-backed securities may beconstructed out of other mortgage types as well.And the construction of mortgage-backed securities,as I said in the previous slide is an example of securitization.And the same ideas apply to asset-backed securities more generally.And so that's one of the goals of these modules in mortgage-backed securities.It's just to show how the process of securitization might work.How you can combine pools of loans, be they from mortgages or other markets,credit cards or auto loans, for example.How you can combine these pools of loans and create new securities out of them.That's a very big part of the financial industry and sowe're going to discuss that, but in the context of mortgage-backed securities.Before I go on, I'll mention that a very standard reference on mortgage-backedsecurities is the textbook Bond Markets, Analysis and Strategies by Frank Fabozzi.But I should advise you it is an extremely expensive book and soI wouldn't recommend that any of you actually go out and purchase it.So if some of you have it or a few local libraries or college library has it,you might want to take a look.If you want to learn more about the mechanics of mortgages and how they work.So as I've said, we're going to consider a standard level payment mortgage.We're going to assume forexample, that maybe there are 360 periods in the mortgage.So this is t equal 0, t equals 1 and so on, up until t equals 360.So this actually would correspond to a 30 year mortgage,because there are 12 months in a year.And so there would be 12 times 30 equals 360 periods in the mortgage.So we have an initial mortgage principal of m0.We're going to assume equal periodic payments of size b dollars are made ineach period.So we're going to pay b dollars at the end of every period, Andso on, until t equals 360 when the mortgage has finally been paid off.We'll assume that the coupon rate is c per period.So if you'd like, this is just the interest rate due each periodon the mortgage, but we're going to use the term coupon rate for this.There are a total of n repayment periods.So in this example I've drawn up here, n is equal to 360.And then after the n payments, the mortgage principal andinterests have all been paid.The mortgage is then said to be fully amortizing.This means that each payment B pays both interest and some of the principal.After all, if we make the same payment B in every periodout until the end of the mortgage then clearly.Each payment B is paying both some of the interest due on the outstanding principle,but it's also paying down some of the outstanding principle.So this is an important fact andwe're going to analyse this over the next couple of slides.We're going to use the following notation,we're going to let Mk denote the mortgage principal remaining after the kth period.In that case, we can say that Mk = 1+c times Mk-1-B.Now where does this come from?Well it comes from the following fact.The coupon rate is c per period.So if you look after period k-1, the outstanding principle is Mk-1.Well in the next period, the outstanding principle alone will still be Mk-1.But you'll also own additional c times Mk-1 of interest.So therefore, the outstanding principal will be 1 + c times Mk1-1.But don't forget, you will also have paid b dollars at the end of that period.So therefore the total outstanding principleafter the kth period will be 1+c times Mk-1-B.And that's true for k= 0, 1, 2 up to far as n,the total number of repayment periods.But keep in mind, we said that the mortgage ends after n periods,when the entire mortgage has been paid off.So that implies that Mn = 0.And this is very important, sothis last couple of lines here on the slide are very important.What can we say or how can we use this expression here in 1?Well what we can do is we can iterate it.For example, we know that M1 is therefore equal to1 + C times M0 the initial mortgage principal minus B.We can now use this with k=2.So M2 = 1+c times M1, andM1 is 1+c times M0-B,and we have a -B out here.So therefore, this is equalto 1 + c squared M0 minusthe sum of 1 + c times.Well let me put the minus here and it's a B here,get to the power of j, with j = 0 up as far as 1.So now we could go on to M3 and repeat the samecalculation to get M3 in terms of M0 B and C and so on.So that will leave us in general for k, we'll get to followthe expression to the Mk = 1 + c to the power of k times M0-Btimes the sum from p = 0 to k-1 times 1 + c to the power of P.We can simplify this, this is just a simple geometric summation here.And so we can just use our standard formula forthe sum of a geometric series to get this expression down in two.Now, we are not done yet remember that Mn = 0 after M repayment period somortgage has been paid off.So if we take k equal to n, so take,k = n in equation 2.And use the fact that Mn = 0,we will find that B is equal to the following expression down here.So this gives us B, And this is very interesting.Why?Well it tells us that if we have a level payment mortgage andwe know the initial loan amount or the initial principle M0.And we know n, the number of time periods, and we know the coupon rate.Well we can compute what the correct value of B is, sothat b dollars paid in every period would pay off the mortgage after n periods.By the way, this is very related to the mathematics of annuities,which you saw back in the first week of this course.Anyway moving on, we can substitute our expression for B back in up here.So we can put B in for this, and we can get this expression down here.And this is very nice, because it tells us the value of the outstandingmortgage principle after k periods on the left hand side.That is equal to an expression on the right hand side, which only depends on M0.The initial mortgage principal, the coupon rate c,the number of time periods in the entire mortgage n and the current period k.Suppose now that we wish to compute the present value of the mortgage assuminga deterministic world.And by the way, what do we mean by deterministic world?Well what I mean is that there's no uncertainty in the world.We're using a very stylized situation here.There is no randomness, there is no possibility of default soprepayments though of course, these are very important features in practise.In that situation, we can actually compute the present value of a level mortgage.If we assume, the risk free interest rate of r per period.We obtain that the fair mortgage value is andwe're going to use F0 to denote the fair mortgage value.Then the fair mortgage value is equal to the sum of the Bs divided by1 + r to the power of k from k = 1 to the power of n.Now just to keep in mind or you can think of r as the borrowing rate for the banks.The banks that write the mortgages or that lend the money out to the homeowners.Presumably they can borrow at r and for all intents andpurposes here, we can imagine r to be a risk free interest rate.R in general will certainly not be equal to c.C is the coupon rate or if you like,the interest rate that the homeowner must pay on their mortgage.R is the interest rate that the banks use to discount their payments.So in this case,we're going to get F0 equals the sum of the b over 1 + r to the power of the k.Again this is a geometric series, we can easily calculate this term andthen we can substitute in for B using our expression on the previous slide.If we do that we'll get this expression here, expression number five.Note that if r = c then actually F0 = M0 because if r = c, this term wouldcancel out with this term, and this term could cancel out with this term.And so not so surprisingly we get F0 = M0, and that is exactly as we would expect.In general however, r is less than c, andthat is because the banks who write the mortgages.Or lend the money out to the home owners must charge a larger rate of interest z,to account for the possibility of default, prepayment,servicing fees on the mortgage.They must make some profit, they must also account for payment uncertainty and so on.So in general r will be less than c, and the difference here between r andc accounts for the difference between F0, the fair value forthe mortgage from the bank's perspective.And M0 the amount of money that the home owner is being lent in the first place.So in some sense, you can think of F0-M0,as being the amount of money that the bank is earning from the mortgage.But that money must be used to handle these effects here.The possibility of default, prepayment, servicing fees and soon as I mentioned already.By the way, we're only working here with the level payment mortgageswhere you could do similar kinds of analysis with other types of mortgagesincluding adjustable rate mortgages or ARMs or so on.I also want to mention the fact that we can also decompose the payment B that ispaid in every period into an interest component under principal component.And this is very easy to do, since we know Mk-1,we can compute the interest, let's cal it Ik in every period.So Ik is equal to c times Mk-1,afterall Mk-1 is the outstanding principle at the end of period k-1.So c times Mk-1 is the interest that is due on that principle in time period k.So this is the interest that is paid in time period k.Therefore that means we can interpret the kth payment which is B,as paying Pk = B-cMk-1 of the remaining principle.So Ik is the interest that is paid at period k andPk is the principal that is paid at period k.And of course note that Ik + Pk = B, which must bethe case because we pay B dollars in every period.So that B dollars must be split up between principal andinterest and the way to split up is given to us up here and here for Pk.So in any time period k as I said, we can easily break down the payment B intoscheduled principal payment and a scheduled interest payment, Ik.And we're actually going to use this observation later to create principal onlyand interest only mortgage backed securities.These are an interesting class of mortgage backed securities.And we will see that when we actually use a pool of mortgagesto create these new securities.We're actually creating new securities that have very different risk profiles,but we will return to that in a later module.In the spreadsheet that goes with these modules on mortgage backed securities,there are three worksheets.The first worksheet is called single mortgage cash flows, andit simply shows you how a single level payment mortgage works.So that we can see everything here on the same on the one sheet on the one screenI've assumed that there's just 18 periods in the mortgage.In reality there might be 240, or 360 and if I change it to 360 forexample we'll see that the spreadsheet adjusts appropriately.So we see that we got 360 months appearing.But just so that we can see anything see everything in the same screenshot,I'm going to assume that this is just aiding periods.We start off with a mortgage loan of $20000, the mortgage rate is 5%.Now this is an annual rate, this is not c, this is an annual rate butwe can easily convert it into a monthly rate andwhat's what we do here when we calculate the monthly payments.So this is d.This monthly payment in cell C3 is our B from the slides.So we see how to calculate B using C2 which is the monthly rate.As well of course C1 which is M0, the initial mortgage loan.So what we have here is we have the 18 months.We see the beginning monthly balance.This is the outstanding principle on the mortgage at the beginning of each month.We see the monthly payment is $1155.61.It's the same monthly payment in every period.And as we saw in the final slide, we can break this payment downinto a monthly interest payment and a scheduled principal payment.So that's what these quantities are here.Note that the monthly interest andthe scheduled principal always sum up to the monthly payment.So in any cell here,you'll see that these numbers always sum up to the corresponding cell in column E.So monthly interest plus scheduled principal repaymentis equal to the total monthly payment.And then of course in order to get the ending mortgage balance,we simply subtract the scheduled principal repayment from the monthly payment.And of course after 18 periods the outstanding mortgage balance iszero at the end.So you can play with the spreadsheet if you like.As I said, in practice, you typically have a much longer term of the loan.Instead of 18 periods, you might have 240 for a 20-year mortgage, or 180 fora 15-year mortgage, or a 360 for a 30-year mortgage.Another interesting observation to make.Is that in the earlier part of the mortgage, the monthly interestpayments are larger than they are in the latter part of the mortgage.So that up here, you see in the earlier months of the mortgage,the interest payment's around $80, $75, and so on.But they're much smaller later in the mortgage.On the other hand, the principal repayments in the earlier pert ofthe mortgage are smaller in this case around $1,075,$1,080 versus later in the mortgage when they're $1,141, $1,146, $1,150.The impact isn't so obvious here but if I switch to say a 360period mortgage you will see that this effect is much greater.So here, let's make it say at$200,000 mortgage.So here, what you'll notice is the monthly payment is $1073.But, most of that payment is going to pay interest, look at that.Of that $1073, in the earlier part of the mortgage life,most of that is going to pay interest andonly a smaller fraction of it maybe on the order of 25% is going to pay principal.However, if I scroll down towards the end of the mortgage which is a long way downbecause it's a three 360 months, then, you will see that nowonly a small part of the monthly payment is going to pay monthly interest andthat's because the outstanding principle is much smaller in this time period.So, a much smaller interest amount is due anda much larger fraction of the monthly payment is going to pay the principal.And this observation was important.It's worthwhile knowing for anybody who's thinking about taking out a levelpayment mortgage, that in the earlier part of the mortgage life,most of their monthly payments will actually be going towards paying interest,and only a small fraction would be going towards paying principal.That will be reversed towards the end of the life of the mortgage.This, as I mentioned earlier,will also have a significant impact when we create principle only andinterest only mortgage backed securities and see how they are constructed.

## 022.Prepayment Risks and Pass-Throughs

### 038. Prepayment Risk and Mortgage Pass-Throughs

In this module we're going to discuss Prepayment risk and Mortgagepass-throughs. Prepayment risk is a particular type ofrisk that mortgage backed securities are exposed to.Prepayment risk refers to the ability of homeowners to prepay their mortgages.So mortgage holders or homeowners often have a option to prepay their mortgageearly. And that creates prepayment risk forinvestors in mortgage-backed-securities. We're also going to discuss Mortgagepass-throughs securities. A Mortgage pass-throughs is the simplestexample of a mortgage-backed security, and so we're going to spend some time aswell on this module, in this module, discussing pass-throughs.Many mortgage holders in the US are allowed to prepay the mortgage principalearlier than scheduled. Payments made in excess of the scheduledpayments are called prepayments. Now, there are many possible reasons forprepayments. Number one, homeowners must prepay theentire mortgage when they sell their home, and there are many reasons whysomebody might need to sell their home, maybe they're moving for a new job, maybethey're getting divorced, and so on. Homer, homeowners can also refinancetheir mortgage at a better interest rate. So for example say a homeowner took out amortgage when the interest rates were very high on mortgages, and maybe five orsix years later, they'd see that interest rates are much lower.Well the ability to prepay allows the homeowner to pre-pay their mortgage andthen take out a new mortgage at a much lower level of interest.A third reason is the homeowner may simply default on their mortgagepayments. Maybe they're behind on their payments,they can't catch up and they smiply default.In this case, if the mortgage is insured then the insurer will pre-pay themortgage as well. And finally, for another example, thehome might be destroyed by floods or fire or by some other catastrophe andinsurance proceeds in this case will pre-pay the mortgage.So there are many possible reasons for pre-payments.The second reason we've highlighted here is a very valuable reason.It's the prepayment option that mortgage holders have.In particular they can benefit when interest rates go lower.And so this is a prepayment option and like options it has a positive value tothe owner of the option, in this case the US homeowner typically.So prepayment modeling is therefore an important feature of pricingmortgage-backed securities. And the value of some mortgage-backedsecurities is extremely dependent on prepayment behavior.Again, we'll come to some examples of mortgage-backed securities in latermodules. For now, we're going to consider thesimplest type of mortgage-backed security, and that is the Mortgagepass-through. Now before I go on I should mention thatpretty much everything I'm going to be saying here is very US centric.The mortgage markets are the markets from mortgage bank securities originated inthe US in the 1980s. And that's where most of the the modelingand the if you like action in the mortgage market is taking place.So I'm going to be focusing mainly on the US but that's fine.Because pretty much everything I say will apply in some form or another to mortgagemarkets generally. Also the bigger picture that I want toget at here is the general idea of securitization and how mortgage-backedsecurities and indeed asset-backed securities can be created.How are Mortgage pass-throughs constructed.Well in practice mortgages are often sold on to third parties who can then poolthese mortgages together to created mortgage-backed securites.In the US, the third parties are either government sponsored agencies such asGinnie Mae, Freddie Mac or Fannie Mae, or other non-agency third parties such ascommercial banks. Mortgage-backed securities that areissued by the government-sponsored agencies are guaranteed against default.It is not true of agency mortgage-backed securities.What do we mean by default here? Well what I mean by default here is justthat the homeowner might be default on their mortgage payments.They just may not make their mortgage payments and, and therefore the mortgagecan go into default. Well, in that situation, if themortgage-backed security was issued by Fannie Mae or Freddie Mac, for example,then the agency will step in and guarantee the payments.This is not true in general of non-agency mortgage-backed securities.So the modeling of mortgag- backed securities therefore depends on whetherthey are agency or non agency mortgage-backed securities.The simplest type of MBS is the pass through MBS, where a group of mortgagesare pooled together. Investors in this MBS receive monthlypayments representing the interest and the principal payments of the underlyingmortgages. So, here's a diagram explaining how thisworks. We saw this before in the last module.We've got 10,000 mortgages, of course the number doesn't have to be 10,000, itcould be 5,000 or 20,000 mortgages. We've got mortgage number one, mortgagenumber two, up to mortgage number 10,000. All of these mortgages are pulledtogether into one mortgage pull and from that mortgage pull we can create newsecurities. These new securities are mortgage-backedsecurities and maybe they've got names like Tranche A, Tranche B down to TrancheD and Tranche E and so on. For now let's not worry about thesetranches. In fact, in the case of the Mortgagepass-through security we don't have any tranches.But we will some examples later on where you can have tranches.So these 10,000 mortgages formed the collateral for the mortgage-backedsecurity. and so when we create these newsecurities out of the underlying pool of 10,000 mortgages, this process is oftencalled securitization. And as mentioned earlier, the economicreasons for securitization is that the desire of people to spread risk.Most people most agents most investors do not like risks.They need to be compensated for holding risky securities.So, one could view these 10,000 mortgages, individually, as being veryrisky. If you hold any one of these mortgages,there will be a substantial chance that the homeowner will default, for example,or pre-pay, and so there will be risk associated with these mortgages.But by pulling them together, creating new securities, we can sell these newsecurities on to investors who want the particular type of risk.And so that is the economic or financial motivation behind securitization.The pass-through coupon rate, and we're referring now to our Mortgagepass-through is strictly less than the average coupon rate of the underlyingmortgages. Now this is due to fees associated withservicing the mortgages. Somebody has to collect the mortgagepayments every month and do the book work and bookkeeping to make sure that thehomeowners are up to date on their payments, and so on.We're going to assume that our mortgage-backed securities are agencyissued, and are therefore default free. Now, I'm going to give you a couple ofdefinitions here. You'll find when we discussmortgage-backed securities that there are many definitions.The weighted average coupon rate, WAC, is a weighted average of the coupon rates inthe mortgage pool with weights equal to the mortgage amounts still outstanding.Similarly, the weighted average maturity is a weighted average of the remainingmonths to maturity of each mortgage in the mortgage pool with weights equal tothe mortgage amounts still outstanding. Now there's no need to worry about thespecific details of these definitions. I just want to mention that there aremany definitions associated with mortgage-backed securities.We also need to discuss some important prepayment conventions, that are oftenused by market participants, when quoting yields, and prices, of mortgage backedsecurities. But first we need some definitions.One definition, is the following, the conditional prepayment rate, the CPR, isthe annual rate at which a given mortgage pool prepays.It is expressed as a percentage of the current outstanding principal level inthe underlying pool, to this is the so called conditional prepayment rate.I very related definition is the single-month mortality rate.The SM and the SMM is the CPR converted to a monthly rate assuming monthlycompounding. And so therefore the SMM and CPR arerelated as follows. Now the CPR is expressed as an annualrate, and so it is probably the rate that makes most sense to us.We like to think in terms of annual rates.We think of interest rates expressed as annual rates, and so likewise we mightthink of a conditional prepayment rate as an annual rate.However, when modeling the payments of a mortage-backed security we typically needthe coresponding monthly rate and that's because payments in mortgage-backedsecurities typically take place monthly and so we wont be able to convert our CPRto SMM, and that's what we do here. We'll also see how the SMM and CPR areused in the spreadsheet that is associated with these modules tocalculate the various cash flows underlying the Mortgage pass-through and,indeed, other mortgage-backed securities. In practice, of course, the CPR isstochastic, it is random, and it depends on the mortgage pool and other economicvariables. We saw, for example, earlier thatprepayments tend to go up when interest rates go down.And that's because it is more attractive to homeowner's to prepay their entiremortgage and then refinance at a better rate which is possible when interestrates have gone down. So the prepayment rate for a givenmortgage pool will certainly depend on the economic variables.That are present at any given time. That having been said, marketparticipants, that is, people who work with mortgage-backed securities in themarketplace. They often use a deterministicpre-payment schedule as a mechanism to quote mortgage-backed security yields,and so-called option adjusted spreads. Now we're not going to discuss optionadjusted spreads it all in this course that's fine so you don't have to worryabout what they are. The standard benchmark is what is calledthe Public Securities Association benchmark or the PSA benchmark.The PSA assumes the CPR is equal to 6% times t over 30 if t is less than orequal to 30 and I should mention here that C is now measured in months.Here and then after 30 months, CPR is equal to 6%.So the assumption here is that the conditional prepayment rate of a mortgageis 60% if it's more than 30 months old. If it's less than 30 months old, theconditional prepayment rate is 6% times t over 30.So basically the CPR grows linearly, for 30 months and then is flat.So this is time t in months, this is 6%, and this is the CPR.And then slower or faster prepayment rates are given as some percentage ormultiple of PSA. So, for example 2 times CPA refers tomortgage pool that repays at twice this rate.A 50% CPR refers to a mortgage pool where the condition of prepayment is half ofthis CPR. Giving a particular prepayment assumptionthe average life of a mortgage-backed security is given as the following.Sells equal to the sum from k equals1 to capital T, k times Pk divided 12 timesTP. Where Pk's the principle scheduled andprojected prepayment paid at time k, TP's the total principle amount, capital T isthe total number of months. And, we also divide by 12, so thataverage life is measured in years. It should be clear that the average lifedecreases as the PSA speed increases. And that makes sense, because if the PSAspeed increases, well then you're going to get more of your principle paymentsearlier in the life of the mortgage. So the Pk's for k small, will actually belarger when the PSA speed increases. And so average life gives you a measureof the average life, or how long you have to wait to get the payments associatedwith the mortgage or mortgage. Implicit in the calculations of theaverage life is some assumption regarding the speed of prepayments.In practice the price of a given mortage-backed security is observed inthe marketplace and from this a corresponding yield to maturity can bedetermined. This yield is the interest rate that willmake the present values of the expected cash flows equal to the market price.So if you recall what a yield to maturity is in the case of a fixed income bondwhere the cash flows are fixed, well, it'll be some quantity that satisfies thefollowing. So it will be n, i equals 1, ci over 1plus lambda to the power of i. Now if lambda, if the payments are madesemi-annually and we're compunding semi-annually then I should divide lambdaby 2 here and multiply the i by 2. But basically lambda is the quantity thatmakes this equation correct. Where P0 is the value of the fixed incomesecurity in the marketplace and Ci is the cashflow that you receive at time I whenyou own this fixed income security. The problem with mortgages is, andmortgage-backed securities, is that the Ci's are uncertain.You don't know what they're going to be and that is because of prepayments.So when you are calculating a lambda or yield maturity for mortgage-backedsecurity, you have to fix the ci's, and the way to fix the ci's is to make someassumption about prepayments. So that's what market participants do.So the expected cash flows are determined, or based on some underlyingprepayment assumptions such as 1 PSA, 300 PSA, etcetera.So any quoted yield must be with respect to some prepayment assumptions.When the yield is quoted as an annual rate based on semi-annual compounding, itis often called a bond-equivalent yield. Yields actually are very limited when itcomes to evaluating a mortgage-backed security.And indeed, fixed income securities in general, that don't take account the termstructure of interest rates. They don't take the prepayment optioninto account. so yields are very limited, and indeedthe, the market place typically uses option adjusted spreads as the marketstandard for quoting yields in mortgage-backed securities, and indeedother fixed income securities with embedded options.But, as I mentioned before, we're not going to be discussing option-adjustedspread so there's no need to worry about that in this course.An investor in a mortgage-back, backed security pass-through is, of course,exposed to interest rate risk in that the present value of any fixed set ofcash-flows decreases as interest rates increase.However pass-through investors also exposed to prepayment risk, in particularcontraction risk and extension risk. When interest rates decline prepaymentstend to increase and the additional prepaid principal can only be invested atlower interest rates. So this is contraction risk.So if you think about it. When interest rates fall if you own ahome and therefore have a mortgage, it is in your interest to prepay that mortgageearly and then re-finance the mortgage at a much lower level of interest.If you do this then the people who have invested in these mortgage-backedsecurities. They're going to get payments sooner thanthey expected, and these payments can only be invested at the lower interestrates. So this is called contraction risk.The opposite also provides a risk, which is called extension risk.In this case, when interest rates increase, the prepayments tend todecrease, and that makes sense. After all, why would I want to prepay amortgage early when I'm going to have to re-finance it at higher interest rates.So therefore, interest rates increase implies prepayments tend to decrease, andtherefore I'm getting less prepaid principals than I expected.And so I'm not going to invest that principal, that prepaid principal at thehigher interest rates that might now be prevailing.This is called extension risk. So, to summarize, in addition to theregular interest rate risk that fixed income securities have Mortgage-backedsecurities and Mortgage pass-throughs are also exposed to prepayment risk, inparticular contraction risk and extension risk.

### 039. Mortgage Pass-Throughs in Excel

In this module we're going to go through the mechanics of mortgage pass throughsecurities. And we will do that within the context ofour Excel spreadsheet, which I hope you have with you.You can download that Excel spreadsheet with these modules and mortgage backedsecurities. We're going to look at the secondworksheet in this Excel workbook. It's going to be about mortgage passthroughs. We'll discuss the mechanics of mortgagepass throughs. And see how the, how the cash flows of amortgage pass through are created, and passed on to investors.The second worksheet on the XL workbook that goes along with these modules, andmortgages, and mortgage backed securities is called pass through.This worksheet shows the mechanics of a simple pass through mortgage backedsecurity. Now, I just want to state in advance.Don't worry too much if it takes you some time to figure out.What the various self formulas are doing. it's not a hugely important part of thiscourse. What I want you to come away with is abasic understanding of the mechanics of how these kinds of securities work.So what we have here is the following. We've assumed that the pass through.Now remember, a pass through mortgage backed security is constructed.From a pool of underlying mortgage loans. So we might assume, for example, that themortgage balance, or here, the remaining mortgage balance, is 400.That might represent $400 million for example, representing a large pool ofunderlying mortgages. We're going to assume that the mortgagerate, so if you like, this is the coupon rate on the underlying mortgages.It's 8.125%. The pass through rate is 7.5%.Now, what is the difference between these 2 rates?Well, the pass through rate is the rate that gets passed on to investors.And it will always be less than the mortgage rate.And that difference accounts for the fees associated with servicing.The mortgage-backed security, in this case the pass-through.Somebody has to organize and manage and service the mortgage-backed securities.They need to be paid a fee for doing so. That fee is represented by the differencebetween the mortgage rate, 8.125%, And the pass thru rate 7.5%.The initial monthly payment, or if you like, the average monthly payment, thatthe underlying mortgage owners are paying, is 24.989.The seasoning, so this is how old the mortgage pool currently is, it's 3months,and the term of the loan of the underlying mortgages is assumed to be 20months. Now of course this is very unrealistic inrealty you would be in a much larger pool certainly for mortgages or mortgagebacked securities that have just been initiated.But I've assumed 20 months here, just so that we can see all of the payments onone screen. In reality, this might start off as being240 or 360, corresponding to 20 or 30 year loans, respectively.We start off in Month 1, and let's work across.So, we have our conditional prepayment rates.So, this is our CPR, which is expressed as an annual rate.It tells you what percentage of the outstanding mortgage at the beginning ofthe period will be prepaid. Of course, we will need convert this intoa single month mortality rate, and that's what we do here.The SMM gives us the percentage of the mortgage balance that is prepaid thatmonth. We have an initial beginning monthlybalance of 400. The monthly payment is 24.989 as wecaluculated earlier. This is the monthly interest paid in bymortgage holders. And this is the monthly interest paid outto the past through investors. Note that this interest.Payment here 2.5 is less then 2.71 and that's because of the difference 8.125%and 7.5%. Finally the scheduled principle repaymentis 22.281. That's equal to E13 minus F13.So that's the monthly payment minus the monthly interest paid in.And then finally there are some prepayments.As I mentioned in the last module. Sometimes mortgage owners prepay, andthey might do so for various reasons. Maybe they're selling their house andmoving to another location, maybe they've gotten divorced, maybe they've had aflood or a fire, maybe they've defaulted on their payments.And all those situations What the mortgage investors see, investors inmortgage-backed securities see is the mortgage being prepaid.So we're going to assume that these prepayments take place according to thisschedule, the cpr. And SMM schedule and we get a prepaymentof 2.53. So therefore the total principle paymentis .253 plus 22.281 and that gives us 22.533.We can therefore subtract that from the initial mortgage balance of 400 to givean ending mortgage balance of 377.47. We then move on to the next time period,time period two. We see that the conditional pre-paymentrate is increased to one percent. We get our single monthly mortality rateand so on. We know our beginning monthly balance is377, this is the same monthly balance we had at the end of the previous period.We get our monthly payment. Now notice our monthly payments are nowno longer the same constant. So in our last module we had a constant Bbeing paid in every period. We would've the same constant B beingpayed in every period here, if there were no prepayments.But there are prepayments. Those prepayments actually reduce theoutstanding principle by more than what you'd expect.And therefore that changes the B in each period.So if you, if you look carefully at the formulas here, you'll see that thisformula is the same formula we assume to calculate B.In our earlier module. But of course we have to keeprecalculating it in every period to adjust for the fact that prepayments aretaking place. So what I want you to get from thisspreadsheet is basically just how the repayments are calculated.How the interest payments are calculated. The interest payments paid out to pastdue investors are calculated. And the fact that prepayments take placeand that these prepayments Alter the outstanding mortgage principal thatremains at the end of every period. Now this is an idealized world, we don'thave any defaults. We don't have any randomness in ourprepayments. We're assuming prepayments occuraccording to this deterministic schedule given to us by the CPR.That's all fine as I said. In the real world of course You have totake these into account, but for our purposes we just want to understand someof the mechanics behind how these mortgage backed securities are created.And the simplest type of mortgage backed security is what is called the mortgagepass through. Where you just pool a whole series ofloans together and then you pay out the principle and interest on those loans outto the investors in the pass through security.

## 023.Principal-Only and Interest Only Mortgage-Backed Securities

### 040. Principal-Only and Interest-Only MBS

In the last module, we discussed prepayment risk and the simplest kind ofmortgage-backed security that is a mortgage passthrough.In this module, we're going to discuss two new types of mortgage-backedsecurities. The first type is a principle only MBSand the second type is an interest only MBS.We're going to see how these securities can be constructed from an underlyingpool of mortgages. We will see that the principal only MBSis constructed from the principal payments of the underlying pool.And that the interest only MBS is constructed from the interest payments inthe underlying pool of mortgages. So in this module we're going to discussthe construction of a principal only and interest only mortgage backed security.We're going to construct these mortgage backed securities from an underlying poolof mortgages. So in this example here we've got a totalof 10,000 mortgages. These mortgages correspond to 10,000separate homeowners, each of whom has a mortgage on their house.So these mortgages are going to be pooled together into a pool of mortgages.And from these mortgages we're going to construct two separate mortgage backedsecurities. One is called a principal only mortgagebacked security. And the other is called an interest onlymortgage backed security. So if you like these 10,000 mortages formthe collateral of the principle only, interest only mortgage back securities.Again we're going to assume our deterministic world with no defaults, noprepayments and so on. And that's fine because what we want todo here is to just get an idea of how these securities work in practice andwhat their risks might be. All right.So we saw in an earlier module that we know m k minus 1.The outstanding principle on a mortgage at time k minus 1.So what we have on he, mind, and this slide is just a single mortgage, wherethe outstanding principle at time k minus 1 is given to us by m k minus 1.Well, the interest on this outstanding principle is going to be denoted by Ikand that's equal to c times Mk minus one. If you recall c is the coupon rate of themortgage. This is the rate that the homeowner mustpay on their mortgage every month. So, it also means that we can interpretthe case payment, as paying Pk. And Pk equals b minus c times Mk minus 1.So again what we have in mind here is a level payment mortgage, where a fixedpayment of b dollars is paid in every period for the entire duration of themortgage. So this b dollars, some of it goestowards paying the interest in that period, and that's c times mk minus 1.And the remainder, b minus the interest, ecmk minus 1, is paying the principle.So if you recall our earlier expression from mk in an earlier module, we saw thatmk, the outstanding mortgage principle of time k Is given to us by this quantity.So using this expression here in 7 we can actually calculate Pk.Pk equals b minus c times this expression here evaluated at k minus 1.Because we have k minus 1 here. So if I substitute for k minus 1 insteadof k here. I get everything down there.So these two quantities are equal, except k has now gone to k mines 1.So therefore Pk equals b minus c times this.Now it's just straightforward algebra to tidy up this expression, and I get thevalue Pk. So this is the amount of b, or if youlike, this is the number of dollars that goes towards paying the principal in timeperiod k. If I wanted to, I could compute thepresent value of these principal payments.Let's call this present value V0, so then V0 is equal to the sum from k equals 1 upas far as n of Pk divided by 1 plus 4 to the power of k, for if you recall, r isthe risk free interest rate. Think of R, if you like, and this is justa loose approximation, but you can think of R as being the borrowing rate for thebank that wrote the mortgage in the first place, or that gave the mortgage to thehomeowner in the first place. So from the bank's perspective, you canthink of the fair value of the principal stream, the Pk's from k equals 1 to n, asbeing equal to the sum of these pk's [UNKNOWN] discounted.If you do that and if you, if you evaluate that expression.Remember we know what the Pks are so we can actually write this as being B minusc times m zero times the sumation n k equals 1 of 1 plus of c to the k minus 1divided by one plus r to the k. Now I can easily take out a fact of oneplus r over outside here, and make this a simple geometric sum which is easy tocalculate. If I do that I'm going to get thisexpression up here. So this therefore is the present value,V0, of the principle payment stream. And is given to us in terms of B, whichis the monthly payment on the mortgage. C, the coupon rate on the mortgage, M0the initial mortgage principle, the fixed inch-, risk interest rate.Or, and n the number of time periods in the mortgage.Now, if we want to, we can actually compute the limit of V0 as c goes to r.you see that both the numerator and the dneominator in this case go to zero so weneed to use the so called[UNKNOWN] to complete this limit while itsstraightforward to do so. And we find that the limit of V0 as cgoes to r equals n times B minus rM0 divided by 1 plus r.Now, if you recall our earlier expression for b, which is the fixed monthly periodon, monthly payment on the mortgage, then we can substitute for 9 inside up here in8 to find V0. So here, this is the fair value, or thepresent value today at time zero, of all the principle payments on the mortgage.Assuming admittedly it's a deterministic world, no prepayments, no defaults.In the case that r equals c, then we see that V0 collapses down to this expressionhere. Now it is clear that earlier mortgagepayments comprise of interest payments rather than principle payments.Only later in the mortgage is this relationship reversed.Well, how do we know this? Well we saw earlier that Ik is equal to ctimes Mk minus 1. So this is the interest payment that ismade in time period k, and that Pk, the principal payment that is made in time kis equal to b minus the interest payment. So that's minus cMk minus 1.Now if you think about it, early on in the mortgage, let's set k equal to 1.Well then in that case Mk minus 1 is M0. It's the initial principal.The initial mortgage amount, and so clearly we see that Ik is large then,because it's c times the initial mortgage amount.And Pk will be small because it's B minus c times the initial mortgage amount.On the other hand, as time elapses and we move towards the end of the mortgage.Well then M k minus 1 will be getting much smaller, and so c times Mk minus 1will be much smaller. And therefore the interest Ik towards theend of the mortgage will be quite small. On the other hand, remember we're payinga fixed amount B in every period. And so the principal that is paid towardsthe end of the mortgage would be B minus c times Mk minus 1, c times Mk minus 1would be small, so the principle payment will be large.So, therefore, what is happening, is that the fixed payment B, that is paid inevery period. So remember, we've got our periods, maybethis is 360, maybe this is T equals 0. And in every payment we're paying Bdollars. Well therefore, what we are seeing here,is that in the earlier time periods most of this B period, B is going to interestand in later time periods most of the B is going towards principal.So this is an important fact to keep in mind with mortgage payments.Certainly level payment mortgages. Most of the payments are going to payinterest early in the mortgage and most of the payments later in the mortgage aregoing to pay down the principle. And in fact, it's quite interesting butif you can imagine a mortgage where the number of time periods n goes toinfinity. You could actually check that the limitof V0 in that case is equal to zero. And in fact, that's not hard to see, andthe reason it's not is because in the numerator, we've got r n times M0, socertainly the numerator is going to infinity up here as n goes to infinity.However in the denominator, we've a one plus r to the power of n.This is also going to infinity, but because it's raised to the power of n,the denominator is going to infinity much faster than the numerator and so V0actually goes to 0. And so that's what happens.We see that if we stretch out the, the, the duration of the mortgage, so if welet n go to infinity, all of the payments, all of these fees goes towardsthe interest and none of them goes towards paying the principal.How about an interest only mortgage backed security?Well we could also compute the present value W0 say of the interest stream.Again assuming there are no mortgage prepayments.To do this we could compute the following sum.We could set W0 equal to the sum of the interest payments.Sure to be discounted by the risk-free rate, which is one plus r to the power ofk. Now we could calculate this, but in factit's much easier to recognize that the sum of the principal-only payments andthe interest-only payments must equal the total value of the mortgage, F0.Which we calculated in an earlier module. If you recall, F0 is the fair value ofall the payments in the mortgage. So F0, if you recall, was equal to thesum of the B's, divided 1 plus r to the power of k.And we actually calculated this expression earlier, and we found that F0was equal to this. Well F0 must be equal to V0, the fairvalue or present value of the principle stream, plus W0.The present value today of the interest payment stream so F0 plus V0 equals W0.We've calculated F0 before, we've calculated V0 in the previous slide, soW0 is equal to F0 minus V0, and we find it's, using 12 and 10.12 is here, 10 is here, we can actually use the two of these simplify, thealgebra and get the expression like this for W0.It is also easy to check that when r goes to c, W0 is equal to this expressionhere. And this is as expected from 11 becausewe know that when r equals c, F0 equals M0.And so we see that W0 equals F0 minus V0, this is V0 when r is equals c and that'sexactly what we've calculated up here. If we go back to our single mortgage cashflows worksheet. This is still the single underlyingmortgage. You can actually see how we compute themonthly interest payments and the principle repayments in each period.We just used what we saw there. Ik is equal to c times Mk minus 1.And Pk equals b minus c times Mk minus 1. Therefore, if we wanted to compute thefair value of all of these payments. We could simply sum them all up, andsuitably discount each of these payments by one plus or to the power of k, where kis the period in which the payment takes place.Likewise, we could compute these, the fair value of all of these principlepayment by computing the sum of these weighted 1 over 1 plus r to the power ofk. And so, what we've done here, it's just asimple single mortgage, but what, and it's a very, it's a deterministic worldwith no prepayments and no defaults. But we've still learned an awful lotabout the structure of level payment mortgages.And how we can split the monthly payment up into an interest component and aprincipal component. We'll see in the next module how thesecomponents have very different risk profiles.They react very differently to changes in prepayments and so on.So we'll see that in the next module.

### 041. Risks of Principal-Only and Interest-Only MBS

In the last module, we saw interest-only mortgage back securities andprincipal-only mortgage back securities. And we saw how we can construct thesefrom an underlying pool of mortgages or from an underlying pass through.In this short module, we're just going to discuss the risks of interest-only andprincipal-only securities. We will see how they have very differentexposures to prepayments, for example. So if you recall, this is our diagram foran example of how a principal-only and interest-only mortgage backed securitymight be rated. We start off with a pool of 10,000individual mortgages. Each of those mortgages has been issuedby some broker, some bank to a home owner.these mortgages are then pooled together to form the collateral for theprincipal-only, interest-only mortgage backed security.so out of this pool of loans, we can create a principal-only tranche if youlike and an interest-only tranche if you like.And in the last module, we saw how you could actually create these, thesesecurities. I just want to spend a little bit of timetalking about the risk of principal-only and interest-only mortgage backedsecurities. I'm just going to measure risk here bythe concept of duration. Duration is a simple concept that's usedthroughout the fixed income markets for describing risk.If you haven't seen it before, that's fine.We're just going to use the definition of it here.This definition states that the duration of a cash flow is a weighted average ofthe times at which each component of the cash flow is received.And this is a standard measure of the risk of a cash flow.And it should be clear by the way that the principal stream has a longerduration than the interest stream. And I mentioned this in the last module,but just to remind ourselves. The interest payment Ik, if you recall,is equal to c times Mk minus 1. So this is interest from a level paymentmortgage that is payed at time k. Then the principle that is payed at timek is equal to b minus c times m k minus 1.So clearly, in the earlier parts of the mortgage, Mk minus 1 is going to belarger. And so the interest payments will belarger. In the later parts of the mortgage, Mkminus 1. The outstanding principal will besmaller. And so, in that case, the interestpayments will be smaller and the principal payments will be larger.It should therefore be clear that the principal stream has a longer durationthan the interest stream. And this be, this is because the largerprincipal payments take place near the end of the mortgage.Whereas with the interest stream, the larger interest payments take place atthe beginning of the mortgage. I mentioned that the duration of the cashflow is the weighted average of the times.Well, what are these weights? While these weights are given to us downhere. So for example, let [UNKNOWN] theduration of the principle stream, then it is give by this quantity here.So I can write this as being equal to the sum from k equals 1 to n of Wk times k.Where Wk is equal to 1 over 12 times V0. And if you recall, V0 is the value of theprincipal stream of times 0. So Wk equals 1 over 12 times v0 times pkdivided by 1 plus r to the power of k. We divide by 12 just to convert durationinto annual units, rather than monthly units, because these ks are expressedmonthly. So, for example, if k equals 6, thatrefers to month 6. So these are the weights.So notice that what we're doing is. We're saying that the duration is theweighted hours of the times at which each of the components in the cash flow isreceived. The particular cash flow at time k hasvalue equal to this piece here that I'm circling.So, the weight Wk is proportional to the value of the cash flow received thattime. And in fact, it's equal to the value ofthat cash flow divided by 1 over 12 times v 0.Recall then, that v0 is equal to the sum nk equals 1 of the Pk's divided by 1 plusr to the power of k. So, this is the value today.The present value of the principal payment stream.So, in fact, these weights, they actually sum to 1.If I ignore the factor of 1 over 12 here, which is just converting the months into,into years. So this is the duration of the principalstream. It tells us how long on average we haveto wait until we receive the cash flows from that stream.The idea is that the longer the duration, the more risky the cash flow is becausethere's more uncertainty over interest rates and, and the timing of those cashflows. So generally, a longer duration is viewedas being equivalent to a riskier stream of cash flows.Similarly, we can also compute the duration DI of the interest-only streamas follows. DI equals 1 over 12W0 times the summationfrom k equals 1 to n of k times Ik divided by 1 plus r to the power of k.Now, we can actually think of this as being a weighted average of the times atwhich the payments occur in the interest-only stream.So we can write this as being a summation from k equals 1 to n of little wk timesk, where wk is equal to 1 over 12 times w0, Ik divided by 1 plus R to the powerof K. So I can think of the Di as being aweighted average of the times at which the payments in the interest only streamoccur. This extra factor, 1 over 12 here, thisjust used to convert the duration into units of years rather than months.So I have this expression here. I also know what Ik is equal to.It's equal to B minus pk. So I can substitute B minus Bk in for Ikand get the second equation. And then, break it up to get thisexpression here. We saw what Dp was on the previous slide.And if I want to, I could actually substitute in for B as well.I know the value for B. I could substitute in here as well andsimplify the expression down further. And so, I can get the duration of theinterest-only mortgage backed security as well.In practice, of course, prepayments do occur to this point we have assumed theydo not occur, but this is not realistic. Pass throughs do experience prepaymentsand the principle-only and interest-only cash flows must reflect these prepaymentscorrectly. This is actually straightforward to do,although, I would mention that one should always be aware of the legaldocumentation in these securities [COUGH] but this is straightforward.The interest payment in period k is simply as before, c times Mk minus 1,where Mk minus 1 is the mortgage balance at the end of period k minus 1.In practice, of course, prepayments do occur.To this point, we've assumed they do not occur, but this is not realistic.Passthroughs do experience prepayments, and the principal-only and interest-onlycash flows must reflect these prepayments correctly, but this is straightforward.The interest payment in period k is simply, as before, c times Mk minus 1 orMk minus 1 is the mortgage balance at the end of period k minus 1.Mk, the mortgage balance at the end of period k must now be calculatediteratively on a path by path basis. So Mk is equal to Mk minus 1 minus thescheduled principle payment at time k minus any prepayments that take place attime k. So because the prepayments that takeplace at time k are random, it therefore means that Mk will also be rounded andthat's what I mean by on a path by path basis.So the outstanding principle at time k will depend on the how the uncertainty inthe economy has resolved between time periods 0 and k.Finally, the risk profiles of principal-only and interest-onlysecurities are very different from one another.And this is one of the reasons I want to discuss principal-only and interest-onlymortgage box securities. Even though, they are both constructedfrom the same underline pull of mortgages, they actually have verydifferent risk profiles indeed. And in fact, they can be very riskysecurities. The principal-only investor would clearlylike prepayments to increase. Now, why is that the case?Well, if you think about it, the principal-only investor is entitled toreceive the principle stream from the underlined mortgages.That investor would prefer those principle payments to occur sooner ratherthan later. This just reflects the fact that moneyhas a time value. And so, therefore, the principal-onlyinvestor would prepayments to increase. On the other hand, the interest-onlyinvestor wants prepayments to decrease. The interest-only investor earns only theinterest payments, so interest payments are a function of the outstandingprinciple. The higher the outstanding principle atany point in time, the higher the corresponding interest payment at thatpoint in time. So all other things being equal, theinterest-only investor would like prepayments to decrease.And in fact, in an extreme case to see this, imagine that the entire principalpool repays immediately. So imagine an interest-only investor whoowns the interest, who owns the interest-only stream, and suppose theunderlying mortgages are prepay immediately.Well then, the interest-only investor will get nothing, because all of theprincipal will have been repaid, and so the outstanding interest on thatprincipal will be 0. There will be no principal remaining, sono one interest will be paid, and so the interest-only investor will get nothing.So in the extreme case, you could see how an interest-only investor would receivenothing from this fixed income security. So I hope this makes clear to you thatthe principle only and interest only securities have very different behaviors.In fact, the interest only security is that rare fixed income security whoseprice tends to follow the general level of interest rates.When rates fall, the value of the interest-only security tends to decrease.And when interest rates increase, the expected cash flow increases due to fewprepayments, but the discount factor decreases.The net effect can be a rise or fall in the value of the interest-only security.

## 024.CMOs and Pricing Mortgage-Backed Securities

### 042. Collateralized Mortgage Obligations (CMOs)

In this module we're going to discuss collateralized mortgage obligations orCMOs. CMOs are a class of mortgage backedsecurities that are created from underlying pools of mortgages orunderlying pass-through securities or indeed underlying mortgage backedsecurities. We're going to see how tranches arecreated. We're going to see an example ofsequential CMO where we've got four tranches, tranche A, tranche B, tranche Cand tranche D. And we'll see how these tranches arecreated and how they've got different risk profiles that might appeal todifferent investors. In this module we're going to discussbriefly what are called collateralized mortgage obligations or CMOs.CMOs are mortgage-backed securities that have been created by redirecting thecash-flows from other mortgage securities.They are created mainly to mitigate prepayment risk, and create securitiesthat are better suited to potential investors.In practice, CMOs are often created from pass-through's, so we've seen alreadywhat pass-through mortgage backed securities are, but they can also becreated from other mortgage backed securities, including for example,principal loaning backed securities. Now there are many types of CMOs.They include what are called sequential CMOs, CMOs with accrual bonds, CMOs withfloating rate and inverse floating rate tranches and planned amortization classCMOs or PAC CMOs. We're only going to briefly discusssequential CMOs and I would point out here that the reason we're going throughthis module is just to give ourselves an idea of how these securities areconstructed. To give ourselves another example ofsecuritization. The results of our worksheet, it's thethird worksheet in our XL workbook, which shows how a sequential CMO is created andshows how the cashflows for the different tranches in a sequential CMO are created.But I will emphasize here that this material, it's just there to show us howthese securities are constructed and to give us an example of these securities.So, don't worry too much about the details, the details aren't particularlyimportant. The basic structure of a sequential CMOis that there are several what are called tranches.Now this word appears very often into the securitization world.We're going to see it again when we discuss credit derivatives and what Icall CDOs. So the basic structure of a sequqnetialCMO is that there are several tranches which are ordered in such a way that theyare retired sequentially. What do I mean by that?Well, for example, the payment structure of a sequential CMO with tranches a, b,c, and d might be as follows. Number one, periodic coupon interest isdisbursed to each tranche on the basis of the amount of principal outstanding inthe tranche in the beginning of the period.Number two, all principal payments are disbursed to tranche A until it is paidoff entirely. After tranche A has been paid off, allprincipal payments are dispersed to tranche B, until it is payed offentirely. After tranche B has been paid off, allprincipal payments are dispersed to tranche C until it is paid off entirely.And then after tranche C has been paid off, all principal payments are dispersedto tranche D, until it is paid off entirely.So let's translate what we're seeing here, what we're seeing here is thatthere's going to be four tranches, A, B, C, and D.And when we look at the spreadsheet in a few minutes we'll see what we mean bythis. On each tranche the interest will be paidto the investors in each tranche in every period.But principal will not be paid to the holders of each tranche.All of the principle payments will go towards paying tranche A investors.And only when tranche A's principle has been paid off entirely will the principlepayments from the underlying mortgage pool be used to pay tranche B.And then, only when all of the principle for tranche B has been paid off will theprinciple payments go towards tranche C. Then only when tranche Cs principal hasbeen paid, will the principal be used to pay tranche D.That's what we mean by retiring sequentially.The advantages of doing this is that we're creating these four new securities,tranche A, B, C and D in such a way that there's more certainty around when thesetranches will get their payments. Here's our earlier picture showing theprocess of securitization. Again, you could imagine that we've got10,000 mortgages forming a pool of mortgages.These mortgages formed the collateral for our sequential CMO, so there's going tobe tranche A, tranche B, tranche C and tranche D.These are all securities, so this is a security an investor can buy tranche a ifyou like. This is a security, this is a securityand this is Is a security. So investors can come along and buy A, B,C, or D. These are four different types ofsecurities. Their all constructed from the underlying10,000 loans or 10,000 securities. But in order to get a better idea ofactually how this sequencial CMO works, its actually much easier to go to ourspread sheet and that's what we'll do. So here is our spreadsheet with oursequential pay CMO. The first thing to keep in mind is thatthis spreadsheet is constructed using the pass through spreadsheet we looked atearlier. So the pass through spreadsheet we lookedat in an earlier module, this pass through mortgage, this, this pool ofmortgages, of $400 million worth of mortgages, for example.Can be used to actually create a new set of securities and these new sets ofsecurities give us the sequential pay CMO.So up here what we have is the following, we have a total of $400 million, that'sfrom the underlying pass through on the other worksheet.We've split this $400 million into different notions, $194.5 million fortranche A, $36 million for tranche B, $96.5 million for transche C and $73million for tranche D. We're going to assume that the underlyingcoupon rate for all four charges is 7.5% and of course, this is the same 7.5% thatwe saw on the pass through. The underlying pass through had a passthrough rate of 7.5%. So, that gives us these four newsecurities. So we've got four new securities, each ofthem have different principle amounts but the sum of the four principal amountsmust be equal to 400 million dollars, the sum of the principal of the underlyingpass through security. We then have our months, again, just toshow us all the payments on one screen, I've assumed that we're only going tohave 17 payments, or 17 months. in reality, you can have many more monthsthan this, up to maybe 240 or 360, as I said earlier.we start off with our balances for each if the tranche, so tranche A balance is194.5 to begin with, tranche B is 36, which is what we have up here, tranche Cis 96.5, which is what we have here, and tranche D is 73.0.Now, what we do is, we follow the instructions on the, on the and twoslides ago, which tells us how interest and principle are paid on each of thesetrenches. So notice that the principle isdecreasing on trench eight, for the first nine months until there is no interest orno principle remaining. It is only at that point that theprinciple in trench B starts to be repaid.Notice that the principle on trans B remains 36 on every period until theprinciple on trans A has been repaid and only at that point does the principle ontrans B start being repaid. Likewise the principle on trans C remains96.5 until such time as the principle on trans B has been repaid entirely, onlythen is tranche C paid down. Likewise, on Tranche D it starts off witha principal of 73 and it remains 73 until the principal on all the previousTranches has been paid down and only after that point is the principal onTranche D paid. Notice these principal payments by theway Are the principle payments that are calculated from the underlyingpassthrough on the previous worksheet. If you look at the formula, you'll seethat it refers to the passthrough worksheet.Passthrough here is the worksheet here. So the principle payments are computedfrom the underlying passthrough and they are here.So, 22.533 That is the principal payment that appears over here.So what we're doing here is constructing a mortgage-backed-security, or CMO, withdifferent tranches, so an investor could invest in tranche a or another investorcould invest in tranche b, and so on. And they're going to get the schedule ofcash flows. one thing to notice here as well is we'veactually calculated the average life of each tranche .So you can see how the average life is calculated by looking at this formula.Not surprisingly, the average life in years of tranche A, is less than trancheB, is less than trance C, and is less than trance D.So for trans A, it's 0.4 years, for trans B it's 0.8 years, trans C it's 1.04years, trans D it's 1.33 years. And of course that's understood by thefact that the principle in trans B gets payed, and so on.So what we've succeeded in doing here, is taking the underlying pass through andinstead of just leaving it as a pass 3 mortgage backed security, we constructeda more complicated mortgage backed security, where the underlying chargeshave very dis, different risk profiles. Some investors might like a, a securitywith a shorter average life, other investors might prefer a security with alonger average life. And so they might prefer trans d to transa. And why are we doing all of this?Well it goes back to that comment we made in an earlier module aboutsecuritization. The economic, or big picture goal behindsecuritization is the idea of spreading the risk.An investor may not want to invest in the pass through security.They may not like an average life of .76 years, however, that same investor maylike a security with an average life of 0.4 and so they may be willing to buythis tranche, even though they would not buy the underlying pass-through.Likewise, there may be another investor who does not like the pass-throughsecurity, but they do like tranche D, with the longer average life.So by constructing new securities with very different risk profiles out of thesame underlined pool of loans, you can actually potentially appeal to moreinvestors. And therefore share the risk amonginvestors who want to hold different types of risks.This prepayment multiplier by the way is the same prepayment multiplier of theunderlying pass through. Remember, it's the underlying passthrough security which is actually creating the cash flows that feed intothe four trenches of the CMO. Finally, in practice you would actuallyhave many more periods here, it wouldn't just be 17 periods, it would be maybe 240and if I change it 240 here, it will also change appropriately over here.So now you can get a better sense. So in this case with a 240 periodSequential CMO, the average life of tranche A is four years, the average lifeof tranche C is 11.93 years, and so on. And the, these tranches will have there,therefore have very different risk profiles.

### 043. Pricing Mortgage-Backed Securities

In this module, the final module on mortgage backed securities, we're goingto discuss prepayment modeling and the pricing and deed of mortgage backedsecurities. We'll see an example of a prepaymentmodel and we'll see some of the factors that go into a prepayment model, but wewill also mention that there are very few prepayment models that are available inthe public domain. When it comes to pricing mortgage-backedsecurities, it is a very difficult exercise.We need to use Monte Carlo simulation, typically, to price these securities.They're very complicated, and they're very computationally intensive to price.So, we will just be discussing the big picture here.A little bit about prepayment modeling and a little bit about the pricing ofmortgage-backed securities. In many respects, the prepayment model isthe most important feature of any residential mortgage backed securitypricing engine. Term structure models, which are alsorequired to price mortgage backed securities are well understood in thefinancial engineering community. But this is not true in prepaymentmodels. For example we can think of our binomialmodel that we saw that we used on price fixed income derivatives.That's an example of a term structure model and there are many term structuremodels that are out there in the quantitative finals community.They're well understood and people understand how to work with them.A mortgage backed security is exposed both to interest rate risk, which is whyyou need a term structure model but also it is exposed to prepayment risk.And so you would also need a model of prepayments, a model of how home ownersin the underlying mortgage boosts of how they are going to prepay.So a prepayment model is also very important when it comes to processingmortgage backed securities. The problem is that there's relativelylittle publicly available information concerning prepayment rates.So it is very difficult to construct good prepayment models, accurate prepaymentmodels, and to calibrate these prepayment models as well, in other words, to figureout what the correct parameter values are inside these prepayment models.One very well known publicly available model is due to Richard and Roll from1989. And they model the conditional prepaymentrate, the CPR, whose definition we recall.The CPR is the rate at which a given mortgage pool prepays.It is expressed as a percentage of the current outstanding principle level inthe underlying mortgage pool. It is also expressed, by the way, as anannual rate. And we have seen that before as well.So let's take a brief look at this model due to Rich and Roll.I want to emphasize that, the vast majority of the prepayment models thatare out there are private, they are not published, nobody knows what they are.They're just used by banks and other investment companies to invest inmortgage backed securities. And they don't share their models withother people. So it is very difficult to find goodprepayment models that are out there in the public domain.So this is the prepayment model of Rich and Roll.It looks very complicated, but I don't want anybody watching this video to thinkthat the need to understand everything inside here.The idea is just to give us an, a sense of how one might go about constructing aprepayment model. And in particular a model for the CPR.So this model of Richard and Roll assumes the following; So they assumes that theCPR time k is equal to the RI which is the Refinancing Incentive times the Hwhich is the Seasoning Multiplier. Times the MM which is the MonthlyMultiplier times BM which is the Burnout Multiplier, now what are all thesemultipliers. Well the refinancing incentive issomething we've discussed before, lets not worry about the form of this herereally that's not relevant, the only point I want to emphasis here is this.WAC if you, you recall is the weighted average Coupon in the underlying mortgagepool. And RK10 here, we're assuming, is the tenyear spot interest rate. Now, why is this differnece relative?Well, remember we said that homeowners have an option to prepay their mortgage.So, for example, suppose the weighted average coupon was, let's take an examplesuppose WACwas equal to 10%, and suppose RK, in other words the ten year interestrate at time k, was equal to 3%. Well then this difference here is 7%.And it represents how much money in, homeowners could make by prepaying theirmortgage. And refinancing at a lower interest rate.Now they wouldn't be able to refinance at 3%.This rate would be too low. But maybe they'd be able to refinance atr plus 2%. Which would be 5%.So therefore, they could prepay their mortgage where, on which they'recurrently paying 10%, and refinance at 5%, that would be a large gain.So this number here, WAC minus arc A10, represents the incentive to refinance,and that's why we call it R I. And so the larger this number is, themore prepayments you're going to get. So in fact this number here, although itmay be difficult to see it when you've got this inverse tan function.But this RIk here will increase as WAC minus RK10 increases.And therefore it will increase the CPR. Age is what's called the seasoningmultiplier, so again T is measured in months and it's a minimum of 1NT over 30.This is just meant to capture the fact that early in the lifetime of a mortgagea homeowner is very unlikely to prepay. After all if they've just taken out amortgage maybe it's because they just bought a new home.It's very unlikely they're going to be moving home in the next year or two, andtherefore we said age equal to the minimum of 1 over T30.So when T is just one month or six months this number here is very small and so itmultiplies in here to give it a very small CPR, in the earlier life of amortgage pool. And M is the monthly multiplier, so it'sapproximately equal to one. There's a different for each month,January through December, they're all close to one, but some of them are lessthan one, and some of them are greater than one, and this is just used toreflect the fact that. People tend to prepay at different timesof the year. For example, there tends to be moreactivity in the housing market in spring and summer, for example, than in winter.And so, in winter, you have a number, in the winter months, you have a number lessthan one. And maybe in the spring, summer months,you might have a number greater than one. So this is the monthly multiplier, andthen bmk is what's called the burnout multiplier.So for example, in this case, we could say bmk equals .3 plus .7 minus m k minusone over m zero. So for example, this is equal to one whenK equal one and that's equal to .3. When k is well approximately n close tothe end of the mortgage. And what this is reflecting is thefollowing. So early on in the life of the mortgage.This burnout multiplier is equal to one. But it decreases linearly through thelife of the mortgage and falls to .3 at the very end.And this is just used to reflect the fact that people who can prepay tend to prepayearly. For various reasons, there are somepeople who have houses who can't prepay or who don't want to prepay and thosepeople, if they haven't prepaid early in the life of the mortgage, then it turnsout that they become increasingly less likely to ever prepay.And so that's the burnout multiplier. Now as I said at the beginning of thisslide, don't worry about the details. I just want to give you an example of howsome people might go about modeling this conditional prepayment rate.By the way, another comment on the spreadsheet in the work sheets in theexcel work book that we've looked at so far, we always assumed that the CPR wasdeterministic. We used the so called PSA benchmark, Imentioned that in the real world. Of course the conditional prepayment ratewill be random. It will depend on what's going on in theeconomy. And certainly that randomness iscaptured, for example, over here. The ten year spot rate, at time k, israndom. So certainly the refinancing incentivewill also be random. So, again just emphasizing the fact thatin the real world the cash rolls are associated mortgage back securities areindeed random. How about choosing a term-structuremodel. Well, we also need to specifyterm-structure model IE, a model like the binomial model, the black termand[UNKNOWN] model or[UNKNOWN] model for example that we use to price fixing andderivatives. In order to fully specify the mortgagepricing model the term structure model is used to; one.Discount all of the Mortgage Back Security cash-flows in the usualrisk-natural pricing framework but also to compute the refinancing incentiveaccording to 15. Whatever term structure model is used itis important that we are able to compute the relevant interest rates analytically.For example, r10 in the prepayment model of Richard and Roll.Such a model would need to be calibrated to the time structure of interest rates,in the market place, as well as the liquid interest rate derivativesecurities like caps, floors, swaptions, and so on.The actual pricing of mortgage backed securities then requires Monte Carlosimulation. It is very very computationallyintensive. Analytic prices are not available.So the point I want you to take away from the slide, and this module more generallyis that the pricing by mortgage by security is, is very complicated.It takes and awful lot of work and an awful lot of modeling and it is verycomputationally intensive. You don't have to worry about the detailsI've mentioned here. As I've said before I just want you tounderstand the big picture of what is going on.Finally let me say a little bit about the financial crisis.The so called sub prime mortgage market played an important role in the financialcrisis of 2008 and 2009. Sub prime mortgages are mortgages thatare issued to homeowners with very weak credit.The true credit quality of the homeowners was often hidden.And the mortgages that were given to these sub prime.Homeowners were often ARMs. Remember an ARM is an adjustable ratemortgage where the mortgage rate is reset periodically.While the adjustable rate mortgages that were given to sub prime homeowners oftenhad what were called teaser rates. In other words the initial mortgage ratewas very, very low. And that was used to attract newhomeowners to encourage them to take out mortgages that maybe they should not havebeen taking out in the first place. Because the very initial low rates madethem easy to service, easy to make the payments in the earlier life of themortgage. But after two or three years, theseteaser rates were replaced with much higher coupon rates, and so become muchharder for the subprime homeowners to pay these higher coupon rates.The financial engineering aspect of the MBS-ABS market certainly played a role inthe crisis. Particularly when you combine this withthe alphabet soup of CDO's and ABS-CDO's. And so on.We actually will discuss CDO's later in this course.So the financial engineering aspect certainly played a role.The securitization that took place became very, very complicated and it became verydifficult to understand some of these very complicated securities.And also because these securities became so complicated, the models that were usedto price these securities also became very difficult to understand.And people started to lose trust in these models as well.So certainly financial engineering played a role in the financial crisis.But it has to be said there are many other causes as well including the moralhazard problem with mortgage brokers. What is the moral hazard problem.Well the moral hazard problem is the problem of getting people to behave theright way. If they're given incentives to behave inthe wrong way, they may well end up behaving poorly.So, for example, some of the mortgage brokers that sold these mortgages tosub-prime home, homeowners, they weren't careful about checking the paperwork andthe credit worthiness of these homeowners.And the reason they weren't is they weren't going to be holding thesemortgages themselves. They were going to be selling thesemortgages on to other groups. Other agencies other banks who would holdthe mortgages via mortgages bank securities.So they didn't have to worry about. The sub prime homeowners for exampledefaulting on their mortgages that would not be their problem and so that is themoral housing problem that I am referring to.Rating agencies also face moral housing problems.the problem at rating agencies is that they were rating mortgage backedsecurities and asset backed securities more generally.For the banks that were creating them. So they were being paid by banks to dothe ratings. Well obviously there is a moral hazardproblem there as well. There was inadequate regulation,inadequate risk management, and poor corporate governance in general.So there were many, many parties to blame for the financial crisis.Certainly some of the financial engineering behind the very exotic andcomplicated mortgage banks securities and asset bank securities share some of theblame. But certainly I would say these othersources here were very much responsible as well.

## 025.I

### 044. Review of Basic Probability

>> We're now going to review some of the basic concepts from probability.We'll discuss expectations and variances, we'll discuss Bayes' theorem, and we'llalso review some of the commonly used distributions from probability theory.These include the binomial and Poisson distributions as well as the normal andlog normal distributions. First of all, I just want to remind all ofus what's a cumulative distribution function is.A CDF, a cumulative distribution function is f of x, we're going to use f of x todenote the CDF and we define f of x to be equal to a probability that a randomvariable x is less than or equal to little x.Okay. We also, for discrete random variables,have what's called a probability mass function.Okay. And a probability mass function, whichwe'll denote with little p, it satisfies the following properties.P is greater than or equal to 0, and for all events, A, we have that theprobability that x is in A, okay, is equal to the sum of p of x over all thoseoutcomes x that are in the event A. Okay.The expected value of a discrete random variable, x, is then given to us by thisover here. So, it's the sum of the possible values ofthe random variable x. These are the xi's, weighted by theirprobabilities, p of xi. So, that's the expected value of x.If I was to give you an example. Suppose, for example I tosses a dice.So, it takes on 6 possible values. Okay, 1, 2, 3, 4, 5, and 6.Okay. And it takes on each of these values withprobability, so that's wp, with probability 1 6th, with probability 1 6thand all the way down 1 6th. So, in this case, for example, theprobability that x is greater than or equal to 4 is equal to, well, it's 1 6thfor 4, 1 6th for 5, and 1 6th for 6, so that's equal to 1 6th plus 1 6th plus 16th equals 1 half. Likewise, we can compute the expectedvalue of x. In this case, it is equal to 1 6th times 1plus 1 6th times 2, and so on, plus 1 6th times 6.And that comes out to be 3 and a half. Okay.So, we also have the variance of a random variable.It's defined as the expected value of x minus the expected value of x, all to besquared. And if you expand this quantity out, youcan see that you'll also get this alternative representation, so that thevariance of x is also equal to the expected value of x squared minus theexpected value of x, all to be squared. Okay.So, there, a discrete round of variables, probability mass function, and so on.So, let's look at a couple of distributions.The first distribution I want to talk about is the binomial distribution.We say that a random variable x has a binomial distribution, and we write it asx tilde binomial, or bin n, p, if the probability that x is equal to r, is equalto n choose r times p to the r by 1 minus p to the n minus r.And for those of you who have forgotten, n choose r is equal to n factorial dividedby r factorial times n minus r factorial. So, the binomial distribution arises, forexample, in the following situation. Suppose we toss a coin n times, and wecount the number of heads. Well then, the total number of heads has abinomial distribution and we're assuming here that these are independent cointosses so that the result of one coin toss has no impact or influence on the, theoutcome of other coin tosses. The mean and variance of the binomialdistribution are given to you by these quantities here.So, the expected value of x equals np, the variance of x equals np times 1 minus p.Now, there's actually an interesting application of the binomial distributionto finance. And it actually arises in the context ofanalyzing fund manager performance. We'll actually return to this examplelater in the course. But let me just give you a little flavorof it now. So, suppose, for example, a fund manageroutperforms the market in any given year, with probability p.And that she underperforms the market at probability 1 minus p.So, we're assuming here that the fund manager either outperforms orunderperforms the market, only two possible outcomes.And that they occur with probabilities p and 1 minus p respectively.Suppose this fund manager has a track record of ten years, and that she hasoutperformed the market in eight of these ten years.Moreover, let's assume that the performance, the fund manager performancein any one year is independent of the performance in other years.So, a question that many of us would like to ask is the following.How likely is a track record as good as this outperforming eight years out of ten,if the fund manager had no skill? And, of course, if the fund manager had noskill, we could assume maybe that p is equal 1 half.Okay. So, actually, we can answer this questionusing the binomial model, or the binomial distribution.So, let x be the number of outperforming years.Since the fund manager has no skill, then there are ten years, and the total numberof outperforming years x, is then binomial, with n equals 10, 10 years, andp equals a half, okay? So, we can then compute the probabilitythat the phone manager does at least as well as outperforming in eight years outof ten, by calculating the probability that X is greater than or equal to 8.So, what we're doing here is calculating the probability that the fund managerwould have 8, 9, or 10 years out of 10 in which she outperformed the market.And that is given to us by the sum of these binomial probabilities here.So, these were the original binomial probabilities on each slide, and we summedthem from r equals 8, to n. And n, in this case, of course, is 10,okay? So, that's one way to try and evaluatewhether the fund manager has just been lucky or not.One can compute this probability and if it's very small, then you might concludethat the fund manager was not lucky and that she had some skill.But actually, this opens up a whole can of worms.There are a lot of other related questions that are very interesting.Suppose there are M fund managers, how well should the best one do over theten-year period if none of them had any skill?So, in this case, you don't have just one fund manager as we had in this example sofar, we now have M of them, okay? And it stands to reason that even if noneof them had any skill, then as M gets large, you would expect at least one ofthem or even a few of them to do very well.Well, how can you analyze that? Again, you can use the binomial model andwhat are called order statistics of the binomial model to do this.And we'll actually return to this question later in the course.Okay. So, let's talk about another distributionthat often arises in finance and financial engineering, that is the Poissondistribution. We say, that x has a Poisson lambdadistribution so lambda is the parameter of the distribution.If the probability that x equals r is equal to the lambda to the power of rtimes e to the minus lambda, divided by r factorial.And for those who have forgotten factorials, I also used it in the binomialmodel a while ago. R factorial is equal to r times r minus 1times r minus 2, all the way down to 2 times 1.Okay. So, this is the Poisson distribution.The expected value and the variance of a Poisson random variable are identical andequal to lambda. So, for example, we'll actually just showthis result here. It's very simple and the mean iscalculated as follows. We know that the expected value of x isequal to the sum of the possible values of x, so these are the r's, times theprobability that x is equal to r and r runs from 0 to infinity.We can calculate that as follows. So, we have the summation of r and theprobability that X equals r. We know from up here, okay, and we cansubstitute that down in here and now, we just evaluate the sum.The first thing to notice is that when r equals 0, this term in the sum is equal to0. So, we can actually ignore the 0, thefirst element, the 0 element and replace the summation running from r equals 1.So then, we get this quantity here. We can cancel this r out with the first rup here and write, this is r minus 1 factorial.We can also pull one of these lambdas out here leaving us with a lambda to the rminus 1. And now, if we look at this quantity here,this summation here, we see that this is the same as changing this to run from requals 1 to r equals 0 and replacing r minus 1 with r and r minus 1 factorialwith r factorial here. This total we see is equal to the sum ofthe probabilities. These are the probability that x equals r,so this is the sum of the probabilities that x equals 0, x equals 1, x equals 2,so this is equal to 1. The total sum of probabilities must beequal to 1, so this is equal to lambda. Okay, let's talk a little bit now aboutBayes' theorem. Let A and B be two events for which theprobability of B is nonzero, then the probability if A given B, and this isnotation we'll use throughout the course, this vertical line means it's aconditional probability. S,o it's the probability of A given that Bhas occurred, well, this is equal to the probability of A intersection B divided bythe probability of B. Alternatively, we can actually write this,this numerator probably of A intersection B, as being the probability of B given Aby the probability of A. So, this is another way to write a Bayes'theorem. And finally, if we like, we can actuallyexpand the denominator here, the probability of B, and write it as thesummation of the probability of B given Aj, by the probability of Aj.Let me sum over all Aj's. For the Aj's, form a partition of thesample-space. What do I mean by partition?Well, I mean the following. So, Ai intersection Aj is equal to thenull set, for i not equal to j, and at least 1 Ai, at least, at least one Ai mustoccur. And, in fact, because Ai intersection Ajis equal to the null set, for i not equal to j, I can actually replace thiscondition with the following, exactly one Ai must occur.Okay. So, that's Bayes' theorem.Let's look at an example. So, here's an example where we're going totoss 2 fair 6-sided dice. So, Y1 is going to be the outcome of thefirst toss, and Y2 would be the outcome of the second toss.X is equal to the sum of the two, and that's what we plotted in the table here.So, for example, the 9 here comes from the 5 on the first toss and 4 on the secondtoss. So, 4 plus 5 equals 9.So, that's X equals Y1 plus Y2. So, the question we're interested inanswering is the following. What is the probability of Y1 beinggreater than or equal to 4, given that x is greater than or equal to 8?Well, we can answer this using this guy here on the previous slide.So, this is equal to the probability that Y1 is greater than or equal to 4 and X isgreater than or equal to 8, divided by the probability that X is greater than orequal to 8. Okay.So, how do we calculate these two quantities?Let's look at the numerator first of all. So, we need two events here.Y1 must be greater than or equal to 4 and X being greater than or equal to 8.Okay. So, the first event is clearly capturedinside this box here, okay, because this corresponds to Y1 being greater than orequal to 4. So, all of these outcomes correspond tothat event. The event that X is greater than or equalto 8 corresponds to this event or these outcomes.So therefore, the intersection of these two outcomes, where Y1 is greater than orequal to 4 and X is greater than or equal to 8, is this area here, which is verylight, so let me do it a little bit darker.So, it's this area here. Now, each of these cells is equallyprobable and occurs at probability 1 over 36.There are a total of 3, 4, 7, plus 5, 12. So that's 12 cells here.So, the numerator occurs with probability 12 over 36.And the, the denominator, the probability that X is greater than or equal to 8,well, that's what we highlighted in the red here.And the probability of that occurring, well, there's 12 plus these 3 additionaloutcomes equals 15 outcomes. So, that's 15 over 36, and that is equalto 4 over 5. So, that's our application of, of Bayes'theorem. Okay.So, let me talk a little about continuous random variables.We say a continuous random variable x has a probability density function, or a PDF,f. If f of x is greater or equal to 0, andfor all events, A, the probability that x is in A, or the probability that A hasoccurred is the integral of the density, f of y, dy over A.The CDF, cumulative distribution function, and the PDF are related as follows, f of xis equal to the integral from minus infinity to little x of f of y dy.And, of course, that's because we know that f of x, by definition, is equal tothe probability that X is less than or equal to x, so this, of course, is equalto the probability that minus infinity is less than or equal to X, is less than orequal to little x. So, this is our event A here and thisdefinition here. So, A is now integrated from, A is now theevent minus infinity less than or equal to the random variable x, less than or equalto little x, so that's what we have over here.So, it's often convenient to recognize the following, that the probability that x isin this little integral here, x minus epsilon of 2 and x plus epsilon over 2.Well, that's equal to this integral, x minus epsilon over 2 to x plus epsilonover 2 times f of y dy, okay? And if you like, we can draw, somethinglike this. So, this could be the density, f of x.This is x here, maybe we've got some point here which is little x, and this is xminus epsilon over 2. This is x plus epsilon over 2.So, in fact, what we're saying is that the probability is this shaded area, and it'sroughly equal to this value, which is f of x times epsilon, which is the width ofthis interval here, okay? And, of course, the approximation clearlyworks much better as epsilon gets very small.Okay. So, there are continuous random variables.Let me talk briefly about the normal distribution.We say that X has a normal distribution or write X tilde N mu sigma squared if it hasthis density function here. So, f of x equals 1 over root 2 pi sigmasquared times the exponential of minus x minus mu, all to be squared divided by 2sigma squared. The mean and variance are given to us bymu and sigma squared respectively. So, the normal distributions are veryimportant distribution in practice, its mean is at mu, its mode, the highest pointin the density is also at mu and approximately 95% of the probabilityactually lies within plus or minus 2 standard deviations of the mean.So, this is approximately equal to 95% for a normal distribution.Okay. So, this is a very famous distribution.It arises an awful lot in finance. It certainly has its weaknesses and we'lldiscuss some of them as well later in the course.A related distribution is the log-normal distribution.And we will write that x has got a log-normal distribution with parameters muand sigma squared if the log of x, is normally distributed with mean mu andvariance sigma squared. The mean and variance of the log-normaldistribution as given to us by these two quantities here, and again, the log-normaldistribution plays a very important role in financial applications.

### 045. Review of Conditional Expectations and Variances

We're now going to review the concepts of conditional expectation and conditionalvariances. We'll see that conditional expectationsidentity as well as the conditional variance identity, and we'll see anexample where we put them to work. This material is useful because we willuse it later in the course when we discuss credit derivitives.When x and y be two random variables, then the conditional expectation identitystates that the expected value of x can be calculated as follows.We first compute the expected value of x conditional on y and then we actuallycompute the expected value of that quantity.Likewise, the conditional variance identity states that we can compute thevariance of x as the summation of two quantities.First of all, we can compute the expected value of x given y, and then compute thevariance of this quantity. And then, also compute the variance of theexpected value, sorry, then compute the variance of x given y and compute theexpected value of this quantity. Okay.One thing I want to emphasize here is that the expected value of x given y, and thevariance of x given y, are both functions of y, and are there for random variablesthemselves. So for example, I actually could writethis as g of y, say, so this is also a g of y, and maybe the variance of x given y,I could write as h of y. So g of y, and h of y, are randomvariables. So in fact, I can write the expected valueof x, as being the expected value of g of y, okay.And, I can write the variance, of x, as then being equal to the variance, of therandom variable g of y. Plus the expected value of the randomvariable h of y. Okay so there the conditional expectationand conditional variance identities and they can be very useful in manyapplications. So we'll see one application here.So, we want to compute a random sum of random variables.In particular we're going to that w equal to x1 plus x2 and so on up to xn where thexi's are IID with mean ux and variance sigma x squared.But where n is also a random variable and this random variable is assumed to beindependent of the variable xi's. So the question that arises is thefollowing. What is the expected value w?Well I can compute the expected value of w using the conditional expectationidentity. In particular the expected value of w.Well, over here I can write that as being equal to the expected value of theexpected value of w given n. And this quantity here inside here is w.Okay. So the expected value of w, given n, ifyou think about it, the expected value of w, given n, is equal to the expected valueof this summation, i equals 1 to n of the xi's.And because n is a constant, given n, I should have an n here, okay.This is equal to the sum, n, i equals 1, of the expected value of the xi's, andthis is equal to, well this is equal to mu x.And there's n terms, so that's n mu x. And that's where this comes from here.Okay. So now the mu x is a constant.We can take it outside the outer expectation over here, and we're left withthe expected value of N. So that's how we compute the expectedvalue of w. How about the variance of w.Well, we can compute the variance of w by using the conditional variance identity.So this is the variance identity here. We've already calculated the expectedvalue of w given n. It's equal to n times mu x, so that's whatthis quantity is down here. The variance of w given n, well that's thevariance of this quantity given n. These are n IID rounding variables and thevariance of n IID rounding variables is simply n times the variance of one ofthem, which is sigma x squared. And so we get n times sigma x squaredhere. So now, the variance of mu x times n, wellmu x is a constant, so it comes out the variance, outside the variance is asquare. And we're left with mu x squared times thevariance of n. And over here, sigma x squared is aconstant, and it comes outside the expectation, and we're left the expectedvalue of n. So that's how we compute the variance ofw. So here's an example with chickens andeggs. A hen lays n eggs where n is plus on withparameter lambda. Each egg hatches and yields a chicken withprobability p independently of the other eggs and then.Let k be the number of chickens. So the first question I want to ask is,what is the expected value of k given n? And of course one of the reasons I want toask this question is because I want to introduce indicator functions, which areoften very useful in probability, and in fact we'll use them later in the course.We'll be using indicator functions later in the course to describe the event ofcompanies defaulting on their bonds. So we'll use it to compute the expectednumber of defaults in the basket of bonds for example.So it's a good place right now, we could add here right now to introduce theseindicator functions. So what we're going to do is we're goingto write the total number of chickens, k, as being the sum from I equals 1 tocapital N times one subscript hi where hi is the event that the ith egg hatches.Okay. So in particular, one subscript to hi.This is the indicator function, and it takes on 2 possible values.It takes on the value 1 if the ith egg hatches.And it takes on the value 0 otherwise. So in fact that's an indicator function ingeneral it takes on two values one and zero.One if the event in question occurs zero otherwise.In this particular example the event in question is hi which is the event that theith egg hatches. Okay so we've written k as the sum from iequals 1 to n of these indicator functions.It's also clear that the expected value of one of these indicator functions is easilycomputed. In particular, it takes on the value 1with probability p. It takes on the value 0 with probability 1minus p, and so this is equal to p. So the expected value of the indicatorfunction 1 hi is equal to p. So now the expected value of k given n isthe expected value of this quantity which is k given n and n is a constant at thispoint because of conditions on its value. So, we can just take the expectationinside the summation and get this, but we know the expected value of 1hi is equal top. There's n of these terms, so we get np.So therefore the expected value of k given n equals n times p.Which of course is what you'd expect if you've got n eggs and each of them occurswith probability p. You would expect the total number ofchickens to be n times p. Okay.So now, we can use the conditional expectation form to compute the expectedvalue of k. The expected value of k is equal to theexpected value of the expected value of k, given n.But that, we have calculated there. It's np.So now, the expected value of k is the expected value of np.P is a constant. So it can come outside over here.And the expected value of n? Well n is Poisson we're told and if werecall, the expected value of a Poisson random variable is equal to lamda and sothat's why we get the lamda down here. And so we see that the expected number ofchickens is equal to lambda times p.

## 026.II

### 046. Review of Multivariate Distributions

>> We're now going to review multivariate distributions.We'll talk about multivariate CDFs, multivariate PDFs, conditionaldistributions, and so on. Much of this material is a little tedious,a little dull, but we thought it was worthwhile collecting it all and having itin one place for your review if it crops up later in the course.Okay, so let's get started. Let x be a vector of random variables, x 1up to x n. We say the joint CDF of x is given to usby the following. So, the joint CDF, Fx of little x is equalto the probability that X1 is less than or equal to little x1.X2 is less than or equal to little x2. Up to xn being less than or equal tolittle x n. And from this joint CDF, we can actuallycalculate the marginal CDF, so for example, the marginal CDF of Xi is givento us by just plugging infinity into all of the components in the joint CDF exceptfor the ith component which is little xi. Okay, so we can go from the joint CDF tothe marginal CDF. It is also straightforward to generalizethe previous definition to joint marginal distributions.So for example, if I want the joint CDF of just xi and xj, I can also recover thatfrom the joint CDF of 1 up to xn by placing infinity in all of the arguments,except for the ith argument where I have xi and the jth, where I have xj.We also say that x is a joint PDF or probability density function, f subscriptx, if we can write the joint CDF as an integral like this.So, this is just the way we, we, we capture our joint CDF by integrating outthe density function by appropriate limits.Okay. We can also talk about conditional CDFs.So what we're going to do is we're going to partition our vector x1 up to xn intotwo components. The first component is x1, which containsx1 up to xk. And the second component is this boldfacex2 which contains xk plus 1 up to xn. And then we can talk about the conditionalCDF of x2 given x1, and in fact, it's defined as following, as follows.So the conditional CDF of x2 given x1 is equal to the probability that the randomvector x2 is less than or equal to little x2 conditional on x1 being equal to littlex1. If x is a PDF, f of x, then theconditional PDF of xx2 is given to us by this quantity here.So it's the joint PDF divided by the marginal PDF of x1, which we can alsowrite like this. Okay.And the conditional CDF, f of x2 given x1, can be determined by integrating theconditional PDF. So this is our conditional PDF, and we canintegrate this out with respect to uk1 up to un and that will give us ourconditional CDF. Okay, independence.We say the collection x is independent if the joint CDF can be factored into theproduct of marginal CDFs. So in particular the joint CDF here in theleft hand side is equal to the product of the marginal PDFs over here on the righthand side. Similarly, actually, this implies that ifx is a PDF fx, then we can also factorize the joint PDF into the product of themarginal PDFs over here. We can also see from one, and one is hereon the previous slide. So we can use this, okay, to see that ifx1 and x2 are independent, then the conditional PDF of x2 given x1, well by 1,that's equal to this ratio here. So the joint PDF of x divided by themargin PDF of x 1 and by independence here, we can replace the joint PDF by theproduct. Then these two cancel and we're left withthe marginal PDF of x2. So what we're saying here is that if x1and x2 are independent then the conditional PDF of x2 given x1 is simplythe marginal PDF, f of x2. In other words, having information aboutx1 tells you nothing about x2 when x1 and x2 are independent.Okay. Some implications of independence.Well,and I expect we're all familiar with this, but let's, let's go through itanyway. Let X and Y be independent randomvariables. Then for any events A and B, theprobability that X is in A and Y is in B, well, that factorize into the product ofthe probability of X being an A times the probability of Y being in B.More generally, for any functions, f and g, independence of X and Y implies theexpected value of f of X times g of Y is equal to the expected value of f of Xtimes the expected value of g of Y. And in fact, 2 follows from 3, okay?So the implication goes that way and it's easy to see this, because we can writethis probability of X being in A and Y being in B as the expected value of theindicator function of X and A times the indicator function of Y and B.Just to remind ourselves what is this indicator function, while it takes on twopossible values, it takes on the value 1 if X is in A and it takes on the value 0otherwise. So therefore, the product of these twoindicator functions is 1 or 0 and will only be 1 if X is in A and Y is in B.Okay? That occurs with probability X and A, andY and B. So this statement here is correct.Okay, so we've got this first line. And now we can use the independents X andY in condition three to break down this expectation down into the product of thesetwo seperate expectations. Okay.But of course, this expectation is the probability that X is in A and thisexpectation is the probability that Y is in B.So indeed we do see that we can go from three to two.Okay. More generally, if X1 up to Xn areindependent random variables, then we can write the expected value of f1 of X1, f2of X2, and so on up to fn of Xn. That factorizes into a product of nseparate expectations. The expected value of f1 of X1 times theexpected value of f2 of X2 and so on. Random variables can also be conditionallyindependent. For example, we say that X and Y areconditionally independent given Z, if the expected value of f of X times g of Ygiven Z is equal to the expected value of f of X given Z times the expected value ofg of Y given Z and I should mention this is for all functions f and g.Okay, and in fact, this idea of conditioned independence, we're going tosee later in the course, because it's used in the, well, the now infamous Gaussiancopula model for pricing CDOs. So just to give you a brief idea of how itmight be used in a bond context or a CDO context, let Di be the event that the ithbond in a portfolio defaults, okay? So we'll assume that there is a portfolioof n bonds. Okay.It's not reasonable to assume that the Di's are independent.You might ask, why is that? Well, if you think about it, there will beall sorts of macroeconomic factors or industry specific factors, which willcause defaults to actually be dependent. So for example, maybe some industrycrashes that might cause not just one firm to default but multiple firms in thatindustry to default. And so, it doesn't make sense to assumethat these events, these Di's are independent.But, we might be able to say that they're conditionally independent given some otherrandom variable zed. Zed, for example, might reflect someindustry factor. Some, some factor that governs how well aparticular industry is doing. In that case, if we assume that thedefault events are conditionally independent given zed, then we can writethe probability of D1 up to Dn given Z as being the product of these factors here,probability of D1 given Z up to probability of Dn given Z.And it's actually often easy to compute these quantities.So we'll actually be using this kind of idea later in the course, as I said, whenwe discuss the Gaussian copula model for pricing CDOs.We'll also see it in a couple of other applications as well.Okay, so very briefly, I also want to mention the mean vector and covariancematrix of a vector round the variables X. I hope we're all familiar with thisalready, but let's go through it anyway. So the mean vector of X is simply thevector of expected values, expected value of X1 up to expected value of Xn and thecovariance matrix of x is. Well, this matrix of covariances.Okay, so, formula is expected value of X minus expected value of X times X minusexpected value of X transposed. And just to be clear, this is an n by 1vector, and this is a 1 by n vector, so the product is n by n.And we get an n by n covariance matrix, with the i, jth element of sigma being thecovariance of Xi and Xj. The covariance matrix is symmetric that ofcourse is because the covariance of Xi, Xj is equal to the covariance of Xj and Xi.And this diagonal element satisfies sigma i greater or equal to 0, and of course,the diagonal elements are just the variances.So this is equal to the variance of Xi and variances are always nonnegative.It is also positive semi-definite, so this is a, an important well-known property ofa covariance matrix, in particular, it means that X transpose sigma X is greaterthan or equal to 0 for all vectors X and Rn.The correlation matrix row X is similar to the covariance matrix except it has as itsi, jth element, the correlation Xi with Xj itself is symmetric, positivesemi-definite, and has 1's along the diagonal.And just to remind ourselves, the correlation of Xi and Xj, is equal to thecovariance of Xi and Xj, divided by, well, the square root of the variance of Xitimes the variance of Xj. Okay.For any matrix A, which is a k by n matrix and a k by 1 vector A, we can take alinear combination of AX plus little a and we can compute the mean of this vector.So the mean is a times expected value of X plus little a and the covariance matrix ofthis new vector of random variables is a times the covariance of X times Atranspose. And of course, five actually implies thisresult, which you're probably familiar with, that is the variance of aX plus bYequals a squared variance of X plus b squared variance of Y plus 2ab thecovariance of X, Y. Note that if X and Y are independent, thenthe covariance of X, Y equals 0, but the converse is not true in general.And some people tend to forget this, but it is not in general true that if thecovariance of two random variables equals zero, then those two random variables areIndependent. That is not true.

### 047. The Multivariate Normal Distribution

>> We are now going to discuss the multivariate normal distribution.The multivariate normal distribution is a very important distribution in finance.It crops up in many different applications including, for example, mean varianceanalysis and asset allocation, as well as geometric Brownian motion and theBlack-Scholes[UNKNOWN]. So we say an n-dimensional vector, X, ismultivariate normal with mean vector Mu and covariance matrix Sigma; if the PDF ofX is given to us by this quantity here. Okay, so the PDF is equal to 1 over 2 pito the power of n over 2, times the terminant of the covarience matrix raisedto the power of a half, times the exponential of this quantity up here.And be right that X is multivariate normal Mu, sigma.The little subscript n here, denotes the dimensionality of the vector x.The standard multivariate normal, has mean vector mu equal to 0, and variancecovariance matrix equal to the n by n identity matrix.And in this case, the xi's are independent.We can actually see that, because in this case we can write, the joint PD f of x, asbeing equal to the product. I equals one to in.One over route to pie e to the minus a half x i squared.And that follows just from this line here because mu equals zero so this termdisappears, and Sigma is just the identity.So, in fact, you just end up with a sum of xi squared divided by 2.So as we saw in an earlier module on multivariant distributions.If the joint PDF factorizes into a product of marginal PDF's, then the randomvariables are independent. Okay.The moment generating function of x is given to us by this quantity here.So phi subscript x of s is actually a function of s.Okay this vector s. And it's the expected value of e, to the stranspose x. Okay, and this is equal to e to the s,transpose mu, plus a half s transpose sigma s.Now, you're probably familiar with this in the 1 dimensional case, we'll just recoverhere. Suppose x is really just a scale of randomvariable, then the moment generating function of x is equal to the expectedvalue of e to the sx, and it's equal to e to the s mu plus the half sigma squared ssquared. And this is the case where x is normalwith mean mu and variance sigma squared. So this is the moment generating functionof the scalar. Normal random variable.This is, it's generalization to a multivariate normal random vector, x.Okay. So, we call our partition we saw in anearlier module. We can break x into two blocks of vectorsx1 and x2 as such. We can extend this notation, notationnaturally. So we can write Mu equals 1 2, and equalsto This sigma 11, sigma 12, sigma 21, sigma 22 and they are the mean vector andcovariance matrix of x1, x2. So we have the following results on themarginal conditional distributions of x. The marginal distribution of amultivariate normal random variable is itself normal.In particular the marginal. Distribution of Xi is multivariate normalwith mean vector Ui and variance covariance matrix sigma Ii.So for example X1 is multivariate normal, in fact it's k components, mu 1, sigman 1,1. And similarly X2 is multivariate normal.Mu 2, sigma 2, 2, and this is n minus k components.And we have here an example of the bi-variance normal density function, wherethe correlation beween x1 and x2 is 80%. If we rotate the service you can see thecorrelation of 80 percent the large values of X 1 are associated with values of x 2like all values of x 1 are related to all values of x 2.So we can also talk about the conditional distribution assuming sigma is positivedefinite. The conditional distribution of themultivariate normal distribution is also multivariate normal.In particular x 2, given that x 1 equals little x 1 is multivariate normal withmean vector mu 2.1. In the variance, covariance matrix, sigma2.1. Where mu 2 1, is given to us by thisexpression here, and sigma 2.1 is given to us by this expression here.And we can get some intuition for this result, by just imaging the followingsituation; so we've got X one down here. We have X two over here, and imagine weplot some points from X one and X two if you like, we generate X one and X two fromsome distribution, from the bivariate normal distribution, in particular.So the mean of X one is, let's say mew one and the mean of X two is mew two.Okay. Now what if I tell you that we observethat X 1 was equal to this little value X 1.Well if that's the case, then you can come up here and you'll see that X 2 is morelikely than not to be in this region as. I'll circle them right here.So in fact you would expect the conventional mean x one equals little xone to be maybe somewhere around here . And this would be near 2.1 okay?Likewise you can see just from this. Again, that the variance of x2 would haveshrunk. Because knowing something about x1 wouldgive us information about x2, and that would decrease our uncertainty about thelocation of x2. And in fact this expression here tells ushow to actually do that. This mathematically.So, so they're conditional distributions. A conditional distribution of amultivariate normal is again, multivariate normal.We also mention that the linear combination, ax plus a, of multivariatenormal random variable x, is normally distributed with mean, a times theexpected value of x plus little a, and covariance mix, matrix a times covarianceof x times A transpose.

### 048. Introduction to Martingales

>> In this module we're going to introduce Martingales.Martingales play a very important role in finance.They won't play a hugely important role in this course, but they will crop up now andagain and it's worthwhile understanding what they are and seeing one or twoexamples of Martingales. We're going to have the followingdefinition of a Martingale, a random process, Xn is a martingale, with respectto the information filtration Fn and probability distribution P, if these twoconditions are satisfied. The first condition is just a technicalintegrability condition which states that the expected value of the absolute valueof Xn must be finite for all n. The really important condition, iscondition two here, which states that the expected value of Xn plus m, given Fn, isequal to Xn for all nm greater than or equal to 0.A quick comment on what I mean by information filtration.So the information filtration, Fn, is just a complicated way of recognizing theinformation we have at time n. So Fn will denote all of the informationin our model that we know at time n. So usually, you will actually, it'd be thecase that Fn is equal to the information given to you by X1 up to Xn.So basically, it's just recognizing that at time n, we've already seen the valuesX1 up to Xn. Returning to condition two here, we seethat what this is really saying, is that the expected value of X, at any time inthe future, is equal to its current value today.And so, Martingales have often been used to, to model what are called fair games,they've got a rich history in gambling, for example.Because this condition here, models the idea of a fair game, so your futurepay-off, or your expected future pay-off, is equal to your current wealth today, Xm.We define a sub martingale, by replacing condition two with a greater than or equalto sign, And we define a super martingale by replacing condition two with a lessthan or equal to sign. A martingale then is both a sub martingaleand a super martingale. Here's our first example of a martingale.We can construct one from a random walk. Let Sn be equal to the sum of the Xi'sfrom i equals 1 to N, where the Xi's are IID with mean mu, then we can set Mn equalto Sn minus n times mu, and in that case, Mn is a martingale.We can see this because of the following, the expected value of Mn plus n,conditional time n information, is equal to, what we have over here on theright-hand side. So recall, Mn plus n will be equal to Snplus m, minus n, plus m times mu. So this here is Sn, and here's our m plusm times is mu. Well were taking this expectationconditional on time n information, so in that case, what we can do is, we can takeout the first nxi's, because they're known to us as a time end, so we can take themoutside the expectation. And what we're left is the expectation oftime n, of the sum of the xi's from i equals n plus 1 up to n plus m.Well, the xi's are IID, so knowing the value of the first nxi's tells us nothingabout these. We also know that they've got mean mu, sotherefore the expected value of this sum here, is equal to m times mu.We also have the n plus m mu over here. Now when we simplify all of this, thism-mu will cancel with this m-mu, we're left with the sum of the xi's and i equals1 minus n times mu, and of course, we see that this is equal to Mn.So in fact, we have shown that the expected value of m, subscript m plus n,conditional on time n information is equal to Mn, and so it's a Martingale.In this example, we're going to consider what we will call a Martingale bettingstrategy. Let x1 x2 and so on be IID randomvariables, where xi can take on two possible values, it can take on 1 or minus1, in each case it takes on that value with probability 1/2.So you can imagine xi representing the result of a coin-flipping game, you win $1if coin comes up heads, and you lose $1 if coin comes up tails, that assumes that youbet, $1 on the game. What we're going to do now is to considera doubling strategy, where we keep doubling the bet until we eventually win,once we win, we stop and our initial bet is $1.So the first thing to note, is that the size of the bet on the nth play is 2 tothe n minus 1, and that's because of the following, so on the first play, we bet $1which is equal to 2 to the 0. On the second play we bet $2, becausewe're doubling our bet, and this is equal to 2 to the power of 1.On the third play of the game we would double our bet again, so we would bet 4,and that's equal to 2 squared, and so on. So we can see that every time you playedthe game, we've doubled our bet and so the play, the size of the bet on the nth playis 2 to the n minus 1. That of course assumes we're still playingat time n, because we will only be playing at time n if we haven't yet won the gameup until this point. Let Wn denote the total winnings after mcoin tosses, And assume we start off with W0 equals 0.What we're going to show, then, is that Wn is a Martingale.To see this, first note that Wn can only take on two possible values, it can onlytake on the value 1, or it will take on the value minus 2 to the n plus 1, andthat is true for all n. Why is this the case?Well, consider the following two situations.The first situation is as follows, suppose we win for the first time on the nth bet.Well in that case, Wn is equal to minus this sum here.Where does this sum come from? Well, we've lost $1 on the first bet, $2on the second bet, and so on, up to 2 to the n minus $2, on the n minus first bet.Then on the nth bet we win and we win 2 to the power of n minus 1.Remember 2 to the power of n minus 1 is the size of the bet on the nth game, sotherefor these are our winnings at time n, if we win for the first time on the nthbet. If you actually compute this sum, justusing the, the formula for summing a geometric series, remember it's a to the 1minus r to the power of n, all over 1 minus r, that's the general formula.In this case, this translates to 1 times 1 minus 2 to the power of n minus 1 dividedby 1 minus 2, and that is equal to 2 to the power of n minus 1 minus 1, which iswhat we have here. So W n, if we win for the first time onthe nth bet, is equal to minus 2 to the n minus 1 minus 1, plus 2 to the n minus 1,this term cancels with this term and we're left With 1.Thereafter of course, we're always left with 1 because we stop playing the game assoon as we win. So the other situation that can arise, isthat we have not yet won after n bets, in that case, the winnings, Wn is equal tominus 1 plus 2 and so on up to 2 to the n minus 1.It's 2 to the n minus 1 because we also lost the nth bet, so in fact this is aminus, this becomes a minus down here, and we get this quantity here, we sum it upand we get a sum of minus 2 to the n plus 1.So therefore these are the two possible values of Wn, 1 and minus 2 to the powerof n plus 1. To show Wn as a martingale, we only needto show the following, that the expected value of Wn plus 1, given Wn, is equal toWn. And this follows by an iteratedexpectations argument. And the reason is as follows, suppose wewant to calculate the expected value of Wn plus 2 given Wn.Well in that case, we can write this as the following, the expected value of theexpected value of Wn plus 2, given Wn plus 1, all given Wn.Now this term inside here, is equal to Wn plus 1 by this result here.So by star, with n equals m plus 1, so by evaluating star but not taking n equals mplus 1 we get that this inner expectation here equals Wn plus 1.So therefore, this is equal to the expected value of Wn plus 1, given wn andof course, this is equal to Wn again by star.So in fact, for any value of little n, we can show that this result holds, justusing this iterated expectations argument we did here.So all we need to do to show that Wn is martingale, is to establish star, andthat's what we'll do now. There are two cases to consider.The first case is where Wn equals 1. Recall, we have shown that Wn can onlytake on two values, the first value is 1. So if Wn equals 1, then actually we stopplaying the game, because it means we've already won at some point, we've stoppedplaying the game and therefore, Wn is always equal to 1 in every period after wehave first won. So in this case, the probability that Wnplus 1 equals 1, given Wn equals 1, is indeed equal to 1.Which means, the expected value of Wn plus 1, given Wn equals 1 well it must be equalto 1 because that's the only value it can take.It takes on this value 1 with probability 1, so the, this expected value equals 1,which is equal to Wn. The other situation that can occur, isthat Wn equals minus 2 to the power of n plus 1.If that's the case, then we will bet 2 to the power of n, on the n plus first toss.So in that case, Wn plus 1 will be either 1, if we win the n plus first toss, or itwill be minus 2 to the power of n plus 1 plus 1, and this follows from ourarguments on the previous slides. Wn plus 1 will take on this value withprobability a half and it'll take on this value with probability half, and thatfollows because it's a fair coin, we win with probability a half and we lose withprobability half. So therefore, we have these twoexpressions here, from which it immediately follows that the expectedvalue of Wn plus 1, given Wn equals minus 2 to the power of n plus 1, it is equal to1, with prob-, with probability a half and is equal to minus 2 to the n plus 1, plus1 of probability a half. If we sum these two together, we get minus2 to the n plus 1, and that of course is equal to Wn.So in both possible cases, case 1 and case 2, we have shown that the expected valueof Wn plus 1, given Wn, is equal to Wn. And so we have shown that Wn is aMatingale. Now let me mention this example is quitecomplicated, but it was worthwhile introducing because it is easy togeneralize this example to the case where you allow random bets on each play of thegame, as long as those bets only depend on what you've seen up to that point, youwill actually still get a Martingale. For a final example, we look at somethingcalled Polya's Urn, we won't go through all the details, in fact, you can completethe details yourself. Considering urn, which contains red ballsand green balls, so we've got some urns like this, there are red balls in thereand there are green balls inside this urn. And at each time step a ball is chosenrandomly from the urn, if the ball is red, then it's returned to the urn with anadditional red ball. If the ball is green, then it is returnedto the urn with an additional green ball. So what we're going to do is we're goingto see that there are n plus 2 balls in the urn, at time n.And this follows, because we begin with two balls, and after every play of thegame we add an additional ball, either an additional red ball, or an additionalgreen ball. So we have n plus 2 balls in the urn,after time n. Let Xn denote the number of red balls inthe urn after n draws. Then, if Xn is equal to k, Xn plus 1 canonly take on two possible values, it will take on the value k plus 1, or the valuek. It will take on the value k plus 1, if theball withdraw on the nth plus 1 play is a red ball and that will occur withprobability k over n plus 2, k because there are k balls-, k red balls in the urnand n plus 2 because n plus 2 is the total number of balls in the urn.Likewise Xn plus 1 would be equal to k given Xn equals k, if we draw a greenball, because if we draw a green ball we will not be adding an additional red ball.So Xn plus 1 equals k, given Xn equals k that occurs with probability n plus 2minus k divided by n plus 2. And now, what we claim and what you caneasily check, is that Mn, which is equal to Xn divided by n plus 2, is aMartingale.

## 027.III

### 049. Introduction to Brownian Motion

>> We're now going to introduce Brownian Motion.Brownian Motion is a very commonly used stercastic process in finance.It is the process that underlies the Black-Scholes methodology and we're goingto discuss it now. So, let's define our Brownian Motionfirst. We say that a random process or stercasticprocess xt where t greater than or equal to 0 is a Brownian motion with parametersmu and sigma if, for the following fixed times: t1 less than t2 up to tn.The following increments: xt2 minus xt1, xt3 minus xt2, up to xtn minus xtn minus1, if they are mutually independent. For s greater than 0, xt plus s minus xt,must have a normal distribution with mean mu-s, and variance sigma squared s.So notice mu and sigma are the parameters of the Brownian motion, and the increment,so this is an increment of length s, it's xt plus s minus xt, that increment musthave mean, mu-s variance sigma squared s and be normally distributed.And the third condition that must be satisfied is that xt is a continuousfunction of t. In other word, if I was to plot and we'llsee this in a moment, Brownian Motion, okay through time, in fact it's actually alot more jagged than I've shown you here, but it actually never jump.So I can draw a path of Brownian Motion with my pen never leaving the page.And that's what I mean when I say xt is a continuous function of t.We say that xt is a b-mu sigma Brownian motion.Mu is the drift, okay and sigma is the volatility.Property number one, is often called the Independent Increments Property.So they're among the first people to introduce Brownian Motion from amathematical viewpoint as we've defined here.Were Bachelier in 1900 and Einstein in 1905, it's interesting that Bachelier,very little is known about him, he was a French mathematician and in fact, it turnsout he, he has had a great role to play in, in, in finance.He was trying to model stock prices on the Paris stock exchange way back in 1900 andhe tried to introduce the idea of a Brownian motion to do that.So it's very interesting to see, that a concept as important as Brownian motion,which is used throughout the physical sciences and engineering was actuallyintroduced by Bachelier in a financial context.Wiener, in the 1920s, was the first to show that it actually exists as a welldefined mathematical entity. So Brownian motion, it's a hugelyimportant stochastic process, and it plays a very big role in, in finance as well.Some other pieces of information when mu equals 0 and sigma equals 1, we havewhat's called a standard Brownian motion. We will use wt to denote a standardBrownian motion, and, we also assume that it begins at 0.So w0 is equal to 0. Note that if Xt is a b-mu sigma Brownianmotion and X0 equals little x then we can write Xt equals little x plus mu-t plussigma Wt, where Wt is our standard Brownian motion.We therefore see that Xt, is normally distributed with mean x plus mu-t andvariance sigma squared plus t. Because of course, if Xt equals this, thenthe expected value of Xt is equal to the constants X plus mu-t plus sigma times theexpected value of Wt. Wt is a standard Brownian motion, so hasmean mu equals 0 times t, so this is equal to, X plus mu-t and the variance of Xt.Well the constants don't matter, they don't factor into the variance, so thevariance of Xt is equal to sigma squared times the variance of Wt.And the variance of a standard Brownian motion has sigma equals 1, So it's equalto sigma squared times t, and that's where we get this calculation from here.So here's a sample path for Brownian motion.I've been simulating this Brownian motion by simulating these increments, which arenormally distributed between t equals 0, and t equals 2 years.So this axis represents, a time period of 2 years and I've been simulating aBrownian motion. I've-, assuming it's-, I've been assumingit starts at a hundred, so I'm thinking maybe of a security price, although youwouldn't model a security price as a Brownian motion typically, but for thepurposes of this demonstration you can think of doing so.So, that's one sample path, here's another one.We can see there's lots of different behavior, very jagged, In fact if I was tozoom in here, you would see that jaggedness still up here.Key thing to note is that these paths they're continuous, even though they'revery jagged none of them jump, okay so again, I could draw one of these paths,and make sure that my pen never leaves the page.It doesn't suddenly jump from here down to here, okay?So Brownian motion is continuous, the paths of it are continuous.On this slide, I want to introduce an important fact about Brownian motion, butbefore I do so, let us review by what we mean by an information filtration.For any random process, we will us Ft to denote the information available at timet. And then Ft for all values of t greaterthan or equal to 0 is called the information filtration.And we actually discussed this in a previous module when we spoke andintroduced, when we spoke about and introduced Martingales.This quantity here, this expectation, conditional on Ft, then denotes anexpectation conditional on the time t information that's available to us.And usually, it would be very clear what that information is.So really, this, this information filtration ss just a mathematical way ofdescribing what is intuitively obvious to us anyway.The important fact I want to introduce is the following.The independent increments property of Brownian motion implies that any functionof Wt plus s, minus Wt is independent of Ft.In other words, knowing all of the information available at time level t,that tells us nothing about the increment Wt plus s minus Wt.So that in the predictor means that Wt plus s minus Wt is normal with mean 0 andvariant, variance s, and that's in-, and that's even conditional on time Ftinformation. So let's do a calculation with BrownianMotion. We probably won't use this calculationduring the course, but there's no problem in doing such a calculation, and it helpsimprove our intuition of what's going on with the Brownian Motion.So let's compute the expected value at time 0, conditional times 0, informationof Wt plus s times Ws. Well we can use a version of theconditional expectation identity to obtain the following.So Wt plus s, I can rewrite this as Wt plus s minus Ws plus Ws.Okay, and then i'm multiplying by Ws outside, so that's this second Ws outhere. I can multiply through this Ws throughthe-, this term here and break it down into two terms.I get Ws times this term, so that's what comes into the first term here, and then Iget Ws times Ws is Ws squared, and that goes to that term, so this goes here.So now I've got two terms. Well the first thing is, let's deal withthis guy first. I claim that the expected value of Wssquared is equal to s, how do I know that? Well I know that because of the following.I know, that s is equal to the variance of Ws, but the variance of Ws is of courseequal to the expected value of Ws squared minus the expected value of Ws all to bsquared. But the expected value of, Ws is equal to0, because it's a standard Brownian Motion, so therefore the variance at w sis just the expected value of Ws squared, and that's equal to s as we've seen overhere.So that handles this second term on the right hand side of 9.How about the first term? Well a version of the conditionalexpectation identity implies the following.So I want to compute the expected value of Wt plus s minus Ws times Ws, so what I'mgoing to do is first condition on time s information.So I can actually rewrite this expectation by conditioning first of all in time sinformation, I get dou-, Wt plus s minus Ws times Ws, conditional on time sinformation this Ws term can actually come outside this inner expectation, which iswhere it is over here. And I'm left with, inside the innerexpectation with Wt plus s minus Ws. But that important fact over here.So let's call this star. That important fact tells me, that thisguy is normal with mean 0 and variance, in this case t.So therefore, the expect-, and it's independent of Fs.So therefore, this quantity here, this inner expectation, has expected value 0,and that's where the 0 comes from, and so I get 0 here.And so, therefore what we've shown, is that the expected value of Wt plus s,times Ws, is equal to s.

### 050. Geometric Brownian Motion

>> In this module we're going to discuss Geometric Brownian Motion.Geometric Brownian motion is a very important Stochastic process, a randomprocess that's used everywhere in finance. We have the following definition, we saythat a random process, Xt, is a Geometric Brownian Motion if for all t, Xt is equalto e to the mu minus sigma squared over 2 times t plus sigma Wt, where Wt is thestandard Brownian motion. So we've discussed Brownian Motion, in aseparate module, so you can look at that module, if you'd like, to remind yourselfwhat a Brownian Motion is. But one thing to keep in mind with theBrownian Motion, is that Wt, has got a normal distribution, with mean 0, andvariance t, This is one of the properties of a Brownian Motion.Recall mu the drift, sigma the volatility, and write Xt till GBM mu sigma.An interesting observation to make is the following, let's take a look at thisexpression, but let's replace t with t plus s, if we do that, we'll see that Xtplus s equals X0, and in fact I should have had an X0 here.So Xt plus s equals X0, e to the mu, minus sigma squared over 2 times t plus s, plussigma plus Wt plus s. And now what we can do, is we can rewritethis expression up here in the exponential.We can subtract a minus Wt, and add a Wt here, and we can break this summation upinto t times this plus s times this. If we do that, we get this term here inthe right hand side, but what's interesting is that this quantity here, isactually equal to Xt. So we can write Xt plus s equals Xt timesthe exponential of mu minus sigma squared over 2 times s plus sigma times Wt plus s,and this representation is very useful, it's in fact very useful for simulatingsecurity prices, when those security prices follow a Geometric Brownian Motion.This quantity here, Wt plus s minus Wt, well that's just a normal random variablewith mean 0, and variance s. Moreover, it is actually independent of Xtand this follows from the independent increment property of Brownian motion thatwe discussed in that other module on Brownian motion.So that means for example, suppose that we wanted to generate values of a GeometricBrownian Motion at time 0 and at time t, bit also may be at these intermediatetimes may be delta, 2 delta, 3 delta, and so on.Well, what we can do, so we want to generate x delta, x2 delta, x3 delta, andso on. Well, what we can do is we can actuallysimulate the Geometric Brownian Motion at these time periods by just simulating, andzero delta random variables, that's very easy to do in standard software, you caneven do it easily in Excel. So you could generate a sample path ofyour Geometric Brownian Motion or a sample path of your stock.You start at time zero with x zero which you know, and then you get x delta, usingthis formula here, with t equal to 0 and Wt plus s minus Wt, well that's just equalto a normal mean 0 variance delta random variable, so that would give you x delta.You could then get x2 delta by taking t equal to delta and s equal to delta, soyou will get x delta plus delta is x2 delta, that's equal to x delta times thisquantity again here. And again, to generate this term you couldjust generate a standard normal random variable, with mean zero and variancedelta. So it's actually very useful simulating aGeometric Brownian Motion and we may return to this again, later in the course.Here's a question, suppose Xt is a Geometric Brownian Motion with parametersmu and sigma, what is the expected value of Xt plus s given little t?Well from equation 10 of the previous slide, we know that Xt plus s is equal toXt times the exponential of this term here.Well, at time t, all of this is known to us, so we can take this outside theexpectation, and we're left with this times the expected value of each of thesigma Wt plus s minus Wt. Well this term here, as I've already said,is normal with mean 0 and variance s, so all you're trying to do when you computethis expectation, is actually compute the moment generating function of a normalrounding variable. How many have seen that before?Suppose Zed is normal with mean a and variance b squared.Then it implies that the expected value of e to the s times Zed is equal to e to thea s plus a half, b squared times s squared, so this the moment generatingfunction of a normal rounding variable. And we can just use the standard result uphere, to recognize that this must be equal to e to the sigma squared over 2 times s.This term, cancels with this term, and we get this expectation equals e to the mu stimes Xt, so that the expected growth rate of Xt, is in fact, mu.Here are some sample paths of Geometric Brownian Motion.The important thing to notice with these paths, is that they are continuous, theyare very jagged. If I was to zoom in, I would still seethat they are very jagged and they are continuous as I said, so they do not jump.I can draw any one of these paths, by keeping my pen on the page.The following properties of Geometric Brownian Motion, follow immediately fromthe definition of Brownian Motion. Recall that we saw the following, so weknow that Xt plus s, is equal to Xt, e to the mu minus sigma squared, over 2 timess, plus sigma times Wt plus s minus Wt. Okay so what are these three properties?Well the first property states, that these ratios xt2 over xt1, xt3 over xt2 and soon, they're mutually independent. And that follows, because if I divideacross here by Xt, I can see I've got the only random variable here is thisincrement, and the independent property, independent increments property ofBrownian Motion will actually imply this first property here.The second property is, the property I mentioned on the previous slide that isthat the paths of Xt our continuous as a function of t, they do not jump.The third property states, that the log of Xt plus s over Xt has got a normaldistribution as follows, and that also follows from equation 10, which I'verewritten here. So I can easily see that the log of Xtplus s divided by Xt is equal to, well it's just this term up here in theexponent, it's equal to mu, minus sigma squared over 2 times s, plus sigma timesWt plus s, minus Wt. This guy is normal with mean 0 andvariance s, and so this quantity is normal with mean mu minus sigma squared over 2s,and variance sigma squared s, which is exactly what we have here.A couple of observations about Geometric Brownian Motion.It is clear #1, that if Xt is greater than 0, than Xt plus s is always positive forany value of s greater than 0. And again, let's write out equation 10here just to see this more clearly. It's, so this is our equation 10 from anearlier slide. We can see that if Xt is greater than 0,then of course the exponential of this would be greater than 0, and so then Xtplus s would be greater than 0. So if we are using a Geometric BrownianMotion to model stock prices, then we can see that the limited liability of a stockprice, i.e., the fact that the stock price cannot go negative, is not violated.Another observation, is that the distribution of Xt plus s divided by Xt,only depends on s and not on Xt. In fact, this was clear, from the previousslide where we had this result here. The log of Xt plus s is a normaldistribution, and this normal distribution does not depend on Xt, it only depends ons and the parameters mu and sigma. And this is nice, because we wouldn'texpect returns to depend on Xt, so we can view this as being the return on a stockthe return between times t and t plus s and we don't expect in general that thisreturn should depend n the current value of the stock.So again, this is another nice property that Geometric Brownian Motion has, thatis generally reflected in stock prices as well.So these two properties suggest that Geometric Brownian Motion might be areasonable model for stock prices. And indeed, Geometric Brownian Motion isthe underlying model for the famous Black-Scholes option formula that we willalso see in this course.

### 051. Review of Vectors

>> In this module we'll review vectors. I will go over definitions of vectors,what are row vectors, column vectors. We're going to define linear independence,bases, transposes, inner products, lengths of vectors or norms.All of these concepts are going to be needed for doing some of the elementarylinear algebra that's needed in this course.What's a vector? It's just a collection of real numbers.You can collect them, and put them in a row or you can put them in a column.So here is an example of a row vector. Where I've put everything as a row here'san example of a column vector and if you notice carefully both of these vectorshave n components. So we will call a vector to have ncomponents if it consists of n real numbers.A row vector or column vector and we will denote any of these vectors by the symbolr to the n. R to the n means that every component is areal number and they, there are n of them in the place.To just fix ideas it might be easier to think in terms of R2 which means these arevectors with just two components and it's easiest to think of these vectors asbelonging to a plane. And we're used to calling this plane bythe x axis and the y axis. So think of x axis being one of thecomponents of the vector. Y axis being another component of thevector. So, let me just give you some examples ofvectors that we going to use later on in this module.So, here's one vector. It's x component or the first component isgoing to be one and the second component is say going to be equal to two.So that the vector will be this vector. At the end of the dot the dot correspondsto a y axis of two and x axis of one. So was labeled this as V.This will simply be the vector one two. The first component equal to one in thesecond component equal to two. Here's another example.The x axis, or the first component equal to 4 and y axis equal to 1.So that's that point, and I'm going to be connecting it with this vector.And in the rest of this module, I'm going to referring to this vector as w.It has 4 in the first component, and 1 in the second component.By default in this course unless otherwise specified we will assume that all vectorsare column vectors, that is all the components have been arranged as a column.So we now know what a vector is, they are collections of real numbers without, bydefault it's going to be a column vector. Now we want to understand what can werepresent using these vectors, what happens with them and so on So the firstthing that we want to do is multiply these vectors with real numbers and add them up.So v1 and v2 are vectors. And I want to multiply them by a realnumber, alpha 1. And a real number, alpha 2.And then get a final vector w. So, to give you an example, here is myvector, v1. One, here is my vector V two.And just to fix ideas, each of these V one and V two actually lives in R to thethree. Why R to the three?Every component is a real number, and there are three components.So the three refers to the fact that there are three components.I'm going to multiply them by two real numbers, so two is going to play the roleof alpha one. 4 is going to play the role of alpha 2.And what do I do? I take these real numbers, multiply themcomponent by component and add them up. So, in order to get the first component, Itake the 2, multiply it to the 1, take the 4, multiply it to the 0.I get 2 times 1 plus 4 times 0 equals 2. That gives me the first component.If I want to go to the second component then I take the 2 and multiply it to thesecond component 1. Take the 4 multiply it to the secondcomponent which is also 1, 2 times 1 is 2, 4 times 1 is 4 add it up together you get6. Want to go to the third component the samething, 2 times 0. 4 times z, 1, 2 times 0 is 0.4 times 1 i 4. You get a total component 4.So when you write a vector w as a combination of vectors v1 and v2, we'regoing to say that this Vector w is linearly dependent on v1 and v2.Why the linear? Because I'm multiplying by a real number,and adding them up. Other words are, w's a linear combinationof v1 and v2. Get another word.W belongs to the linear span of v1 and v2. All of these 3 things mean the same.Linear dependency, linear combination, linear span.Now, we'll, in the next set of ideas, we'll need a concept of linearindependence. When can we say that we cannot write avector as a linear combination of other vectors.To fix ideas, let's again go back to r2, and I'm going to use my favorite twovectors, v and w. So here's my vector v and here's my vectorw. For now we don't really need what thecomponents are so I'm not going to bother with that.Now we want to understand what does a linear span mean, what can I, what kind ofvectors can I generate by scaling the w? What can I do by multiplying w by arealnumber? And you can convince yourself very easilyThat all the vector that you can get, are going to be on that straight line.When you scale it up you get, by a positive number you get up the line if youmultiply by a negative number you go down the line.Similarly all the vector that can be gotten as linear combinations of v rely onthis straight line. Now we want to ask ourself can I representv as A multiple of w. Clearly that's not true because I can't, Ican't, when I scale the w I get points on this line, v doesn't belong to that lineso I can't do anything about that. Similarly, w is not written as a linearcombination of v and therefore we'll say that v and w are linearly independent.Let's throw in another vector now, x. It's again a vector in r 2 and I want toask myself, is this linearly independent of v and w?Is it possible that x can not be written as a linear combination of v and w?Again it's very easy to convince yourself that if you just draw a line parallel tov, you can write, your vector x as a combination of vector that starts from theorigin, it's aligned to the vector w and comes up to this point.So therefore, this vector is some alpha 1 times w.This vector here is, is parallel to the vector v.So I can write it at sum scale multiple alpha 2 times v.And because, now, x is the sum of this vector and that vector, you end up gettingthat x is actually equal to alpha 1 times w, plus alpha 2 times v which means that xis linearly dependent, LD just for short, linearly dependent on v and w.In fact we'll see in the next slide that in R2 if I give you any 2 linearlyindependent vectors you can write any other vector as a linear combination ofthese 2. And that set of vectors, say these two, vand w, would actually be called a basis. So that's the next concept that I want tolearn about vectors. A basis is a linearly independent set ofvectors that spans the entire space. Any basis for Rn, meaning a vector whichhas n components, has exactly n elements. So basis for Rn has exactly n elements.In the last page I showed you an example of R2, and this should have just twoelements. V and W are linearly independent, therewere two of them, and therefore I know, that this must be a basis.Now it will turn out that its much easier to think in terms of a standard basis.What's a standard basis is shown here. Its a collection of vectors such that theyhave only one in one of the components and all of the other components are equal tozero. So the vector E1 will have 1 in the firstcomponent, the vector E2 is going to have a 1 in the second component, and thevector En is going to have a 1 in the last, or the nth, component.Now if you give me any vector W which belongs to Rn meaning that it has ncomponents, I can very easily write it as a linear combination of E1 through En.Why, because in each of these vectors is exactly one element that's not zero.So if I want to get the first element of w, right?I have to, say, take it to be w1 times e1, because everything else has zerocontribution. If I want the second component, right, Ihave to take w2 times e2, nnd so on up to wn times en.And therefore, this basis. I can split any vector w as a linearcombination very easily. And we will see that, in practice, theseterms ought to be very convenient. Again, to put it in perspective.Here's r2. Here is my x asix.Here is my y axis. And when I showed you in the first slide,x axis refers to the first component. And y axis refers to the second component.So the vector e1 is just this one. It has one component one in the xdirection and zero in the y direction. E2 is this one, it has a component one inthe y direction and zero in every other direction and it's very easy if I take avector x, all I have to do is drop it down here and This, this length down here onthe x-axis is x1, on the y-axis is x2. And it's a very easy way to combine.But any other set of linearly independent vectors, two of them will make sure thatthis is going to be a basis. So, again, this was v, and this was w fromthe last page. And v and w is also a basis.This is also a basis. And E1, E2, which is are these 2 specialones, are also a basis. The second basis is special.And we'll just call it the standard basis, because it turns out it's very convienentto work in terms of this basis. Alright.So, so far what do we know? We know what are vectors.We know linear dependence, we know linear independence.We know that if I am a vector in Rn, meaning it has n components, I can find abasis of n linearly independent vectors, such that every vector can be written as acombination of these. So what's the next concept?The next concept that we want to learn, is that of a length of a vector.Vector. So let's start with the basics.And then we'll generalize is to what I want here.So, if I give you r2. And let's take a vector which has the xcomponent equal to, let's say, 4. And the y component equal to, let's say.So this vector, has a representation four, three.Then our high school trigonometry tells us that the length of this vector is nothingbut 4 squared plus 3 squared. So I'm taking the x-axis and squaring it.I'm taking the y-axis and squaring it. Square root.So that gives me 16. Plus 9 square root which gives me 25square root equaled to 5. So that's nice.I have a, I have a definition of length. What does this definition of lengthsatisfy? It satisfies several properties.It satisfies that the length of any vector is always great than equal to 0.If the length of a vector is equal to zero, then that vector itself must bezero. So you cannot have a vector which is notequal to zero who's length is equal to zero.And the intuition follows from this triangular expression as well.If I scale a vector by an amount alpha it doesn't matter whether I scale itpositively or negatively. The length just gets scaled by theabsolute value. So, here's the idea here's the value ofvector v if I double it. >> I get this vector if I multiply it byminus 2 I get that vector, the length of this vector and the length of that vectoris the same. The direction has changed, but the lengthremains the same. That's what this absolute value does.The third one here. Tells you the relationship between lengthsof additional vectors and the original lengths, and this is known as a triangleinequality. The way you remember this geometrically isthat if you've got one vector here, you've got another vector there, the sum of thevectors is this one, the length, this length is always going to be, let's callit l. Three is always going to be lessthan equalto L1 plus L2. This is the basic geometic fact L3 has tobe less than equal to L1 plus L2. And this particular fact is encapsulatedin this little >> Statement over here, and that's why it's also called the tirangleinequality. Now mathematicians have looked at thisconcept of length, this particular concept of length that I've been talking aboutwhich is take each of the components, square it, add it up, take the square rootand now they're calling it the I2 norm. The 2 stands for the fact that I'msquaring it and take the square root and you'll notice that the properties that Iwant. The fact that the length is greater orequal to zero. The fact that triangle inequality holds.The fact that if I scale things remain the same is true for other definitions oflength. Now, since I am taping this in New York,I'm going to try to tell you about a particular notion of language, which iscalled the L1 norm, otherwise known as the Manhattan distance.I'm sitting at a particular point here, I want to travel to another point, I canonly go In blocks north and south or east and west, and I want to figure out howmuch do I need to walk in order to get from this point to that point.So I have to walk from this point to this point and then walk from that point tothat point. So this distance is 4, that distance is 3,so the L1 distance, or the L1 length, or the Manhattan distance is 4 plus 37.The L two distance is five because I can sort of cut across.The L one distance is seven. L one also satisfies all the properties ofa norm or a length and therefor it's sometimes convenient to encapsulate all ofthem as just norms and lengths. For the purposes of this course we willmostly be focusing on L two. But I just wanted you to know, that thereare other definitions of length, that are interesting, and sometimes becomeimportant in applications. Alright, now we know vectors, we knowlinear combination, we know lengths. Now we want to go to the next concept,which is that of an angle. And in order to get to an angle, I have tointroduce this idea of an inner product or a dot product.So the dot product of any two vectors v and w, so v and w are vectors in Rn.They have n components. So the dot product between v and w issimply going to be taking the ith component of v, taking the ith componentof w, multiplying them together, and adding them up.For those of you who are experts in Excel, this is nothing but sum product, take theproduct of the components and add them up. The sum product function in excel isnothing but an inner product or dot product.If you review back, into the last slide we had defined the L 2 norm there to be everycomponent's squared square root and that can now be written that length L 2 norm ofthe vector is simply take the vector v, take its dot product.So v, dot product with v, and take the square root.So now we want to understand an angle between these two vectors, so to do that,here's a picture. Here's my w, here's my v, here's an angletheta between them. So in order to understand how the innerproduct relates to the angle, the length of this vector is The length we, thelength of this vector is w. So that inner product of v and w, simplyis, take a, take the component of v along w and multiply to the length of w.So if you drop down an orthogonal point over here, this component.Is exactly equal to the norm, or the length, of v cosine of theta, and that I'mgoing to multiply with the length of w, and that should give me v dot w, whichends up giving me the cosine of theta Is exactly equal to vw divided by the norm ofv, and the norm of w, or the length of v, and the length of w.And, to emphasize the fact that these are all 2 norms.I'm just going to put a 2 there. All of that is encapsulated in this slide.Cosine of theta is v.w divided by v and w. And this is true, not just in our 2, butin our n. You an define angles in rn.I'm going to show you in the next module that v dot w is actually a combination oftwo operations, the transpose operation and the matrix multiplication operation.But that has to wait until we get to the module of matrixes.So that pretty much brings us to the end of the introduction to vectors.This is all we need to do in terms of vectors, and this is all we're going to beusing in the course. In the next prerequisite module, the next,the module that comes up next, we're going to review concepts about matrixing

## 028.IV

### 052. Review of Matrices

>> In this module, we're going to review matrices.We'll define matrices, we're going to define operations such as transposes,inverses. We're going to talk about linearfunctions, and how they are related to matrices.We're going to define concepts such as rank, which will play a role later on inthe course in defining complete markets, and hedging instruments.To start at the very basic, what is a matrix?A matrix is simply a rectangular array of real numbers, and we represent the matrixby the number of rows, and the number of columns.So I'll walk you through some examples. So this matrix a, has 2 rows, row 1, row2. It has 3 columns, 1, 2, and 3, andtherefore, we're going to call it a 2 by 3 matrix.2 rows, 3 columns, 2 by 3 matrix. Its elements, I'm going to index by therow index and the column index. So if you have, if I'm talking about anin, an element called a 1 2. So the first index is going to be the rowindex. The second index is going to be the columnindex. So, it's going to be row 1 column 2.So that's the number that I am talking about.So, a 1 2 is equal to 3. Similarly, if I talked about anotherelement a 2 3, so remember the first index refer to the row, so we're talking aboutthe second row. The second index is going refer to thecolumn. The third column, so that's this elementdown here, so a 2 3, is equal to 5. So every matrix is a rectangular array, wesay a matrix is an m by n matrix, if it has m rows and n columns, so that's downhere. So this is the general a that I'm talkingabout. This particular matrix has m rows.So if you look at a partic, elements over here, it goes from a 1, 1.And remember, the row index always comes first.So it's a, 1, 1, a, 2, 1, and so on, these dot, dot, dot means, and so on.A m 1, it has n columns so the column index comes second.It's a 1, 1, a 1 2, a 1 3, and so on, and a 1 n, and the last one is a m n.Here's another example; b, it has 1 row and 3 columns, that's a row vector.In the col, in the module and vectors, we noticed that there were two kinds ofvectors, so column vectors and row vectors.Row vectors have row equal to 1, and a many number of columns.Column vectors have column equal to 1, and several rows.So here's an example of a column vector; w equals, 3, 4, 1.3 rows, 1 column, so either, I can think of it either as a vector in r 3, or as amatrix in r 3 times 1. The second 1 says it's got 1 column and 3rows. So the first thing that I want to do, isintroduce an operation called transpose. Transpose really takes rows to columns andcolumns to rows. So, the easiest way to start thinkingabout it is to think in terms of column vectors and row vectors.I've got a column vector here, v. It's got 1 column and 3 rows, 1, 2, 3rows. If I take it's transpose, if I put theoperation transpose on this vector v, I'll go from column to row.So v transpose is simply this row vector. Now, we want to do the same thing, tomatrices. I want to pretend that the matrix isnothing but a collection of columns. I'll take every column and flip it andmake it into a row, and that's what transpose does.I have a column 2, 1 over here, I'm going to flip it, and make it a row, 2 1.Same thing that I did with the vector. I have 2 6 4, 2 6 4, 2 1, 2 1.I take the second column, and I flip it, I get the second row.I take the third column and I flip it, I get the third row.So columns go to rows and vice versa, rows go to columns.It's, it's symmetric in that sense. More generally, here's a matrix a which isr m times d. To remind, to remind you once more, m isthe row index, d is the column index. So it has m rows and d columns.If I put the transpose operator, that's what this is doing, I'm going to take thiscolumn and transform it into a row, and that's what I'm going to do to everyone ofthem. So now, after the transposition is done,you end up getting that the number of columns becomes the number of rows, andnumber of rows becomes the number of columns.And so a matrix which is in r n times d, ends up being a matrix in r d times m.In the module on vectors, we had learned, that the inner product between 2 vectors,involves a transpose and a multiplication, so we figured out the transpose part.It's going to take a column vector into a row vector.Now we're going to try to see what happens, how do I multiply matrices?So the next concept is that of a matrix. So I've a matrix which is rm times d.So it's the, the row index is m, the column index, I'm going to put them in redjust to make, emphasize the fact. The column index here is d, the row indexfor the matrix b that I'm going to multiply to it, must be the same as thecolumn index of a. The inner multiplication dimension shouldbe the same, otherwise it cannot multiply these matrices.And the column index of b could be anything, say p in this particular case.So when you multiply these matrices, you get a new matrix.So the inner index that was there this d index, it disappears, and the new matrix cthat you end up getting, is going to be in m times p.So the m in the row index, becomes the row index here, and p which is the columnindex, becomes a column index there. So you end up getting a matrix which is inr m times p. The inner dimensions have to be the samein order the multiplication to happen. And when the multiplication happen, thatdisappears. There's a general formula for how to getthe elements of c, but before going there, let me give you some examples, so thatthis idea becomes clearer. So I've got 2 matrices down here.I've got this matrix, which is in r, 2 times 3, 2 rows, 3 columns.This is a vector, but I'm going to treat it as a matrix, which is an r 3 times 1, 3rows and 1 column. Now, if I apply the general rule that Ijust talked about, I should end up getting a matrix, which should be r 2 times 1,because I end up getting that the inner dimension which is the same for the multi,for the vec, matrix a and the matrix b. That will disappear and the outerdimensions are what are going to define the product.So this is the matrix c that I'm going to get, that's in r, 2 times 1, as Iexpected. So, how do I get the elements of thismatrix c? What I do, is I take the rows, andmultiply them to the corresponding columns.So in order to get c 1, 1, so I have, this is the row index, this is the columnindex. In order to get this element c 1, 1, I'mgoing to take the first row of a, and multiply it to the first column of b.I've got the first row, I've got the first column, and what does it mean to multiplya row and a column? I multiply them component by component addthem up, sum product. So I take the 2, multiply to that 2.I take the 3, multiply to 6, take the 7, multiply to 4.And that's what I have written up here. 2 times 2, plus 3 times 6, plus 7 times 4.In order to make it clear what I'm trying to do here, the elements in the bracketscorrespond to the column, the elements outside the bracket corresponds to therow, and the first component ends up being 50.So let's look at c 2 1. Second row, first column, same story.So I've got the second row here, and that's going to multiply the same column,and I'll get elements 1 times 2, 1 times 2, 6 times 6, and 5 times 4.And, if you multiply, multiply all of that together you get 58, and that's how matrixmultiplication works. So let's now go back and look at the moregeneral case about matrix a, which is r m times d.I've got a matrix b which is r b times p, their inner dimension disappears.I get a matrix c, which is r m times p. If i'm looking at a particular element c ij, this is the row index, that's the column index.How do I get this element? I take the ith row of a and multiply it tothe jth column of b. So the ith row of a, is a i 1, a i 2, therow index remains the same all the way through.Over here, I have b one j, b two j, up through b d j.So these last indices actually should be d not n.If you multiply them together using the rule that we just generated, I'm going tomultiply this element with that element and component wise, and then add it up.We'll end up getting, this is the same as the sum over l going from 1 through d, a,i, l, b, l, d, which is exactly what we have done down here.So once we know how to multiply matrixes, I can start simplifying a lot of things.L 2 norm, remember, in the modular and vectors we talked about L 2 norm?We had said that L 2 norm is the sum of the components squared, square root.We'd also shown that this is nothing but a dot product square root.Now I'm going to show you a different interpretation for it.So I've got a vector 1 and minus 2. It's, L 2 norm is 1 squared plus minus 2squared square root. I'm going to write that as 1 minus 2,that's a row vector times 1 minus 2, which is a column vector, and why do I do that?Because if I write out the expression for what this multiplication means, its thefirst component times the first component, second component times the secondcomponent, square root. So that's 1 squared, plus minus 2 squared,the same thing as down here. Now this row vector, I can also write itas, this vector, 1 minus 2, which is a column vector transpose, a transpose takesit to a row. Now we have the same vector, a vector 1minus 2 transpose times itself square root, and that's what is written downhere. The inner product between 2 vectors isnothing but take the first vector, take it's transpose, and multiply it to thesecond vector. This is a reminder, we had said in the, inthe module for vectors, that if I don't specify it, every vector is a columnvector. So, w is a column vector, v by itself is acolumn vector, I take it's transpose, I get a row vector, row vectors times acolumn vector always gives me a real number.And that's why the inner product turns out to be the real number.Alright. We know what our matrices now, therectangular arrays of numbers. We know how to take its transpose, we knowhow to take its multiplication. Now we want to take the next step, and tryto figure out what can matrices do, how are matrices and vectors connected to eachother? And their connection turns out to be,coming from linear functions. So that's our next component of thismodule, linear functions. I'm going to call a function linear, if ithas the following property. I take a vector x, and I take a vector y,I multiply this vector by a number alpha, and I multiply the vector y with thenumber beta, beta and alpha are real numbers.Back in the modular on vectors, we had talked about that alpha x plus beta y isanother vector. All we do is making, multiply everycomponent of x by alpha, every component of y by beta, and add them both componentby component. So, now alpha x plus beta y is a newvector. I'm going to take the function at this newvector. If it so turns out that for any choice ofx, any choice of y, any choice of alpha and beta, the function evaluated at thiscombination vector, is nothing but the same combination of evaluations of x andy. So, what's, what's important in terms oflinearity, is that in one case I'm taking the liner combination inside the bracket,in the other case I'm taking the linear combination outside the bracket, and the 2answers are the same, alpha x plus beta y. The function evaluated at this vector doesnothing but the function evaluated at the vector x multiplied by alpha, plus thefunction evaluated at the vector y multiplies by beta.If this is true for all x, y, alpha, beta the function is linear.There is a simple theorem, we won't get into it, that a function is linear, if andonly if, I can write that function as the multiplication of the vector by a matrix.So f of x is a linear function, if and only if, I can find some matrix a, suchthat f of x is nothing but a times x. It's just a multiplication by a matrix a,and that's why this is the next mod, next component to understanding what matricescan do. So, if I want to have a linear functionfrom r 3 to r, I have to take vectors in r 3, and I have to get a number in r.So what should be a? So this multiplication, if a is going tobe an r tie, m times d, and x is going to be an r d, a times x is going to be avector in r to the m. Now, I want to map r 3, to r andtherefore, the row index of a should be 1, and the column index should be exactlyequal to d in effect, this should be a row vector.So here's a particular row vector 2 3 4, just as an example, if you look at thecombination, if you look at the multiplication of 2 3 4 to the vector x1X2, x3, you end up getting 2x 1, plus 3x 2, plus 4x 3.It takes vectors and maps it to real numbers.Take it one step further, here's another matrix a.Now this matrix has 2 rows and 3 columns, it's going to multiply a vector with 3rows. And you'll end up getting another vectorwhich has 2 components. Why 2?Because the row index is 2. So again, component by componentmultiplication. 2 times x1, plus 3 times x2, plus 4 timesx3, that gives you the first component. 1 times x1, 0 times x2, 2 times x3, thatgives you the second component, and that's what linear functions are.Linear functions take vectors, multiply them by a matrix, and give another vector.So, in most of this course, we won't really be interested in just functions,we'll be interested in constraints, we'll be interested in sets of vectors that aredefined by functions. These might be portfolios, these might bevalues of options, these might be other kinds of things that are, random variablesand so on. So we're going to talk about 2 differentkinds of constraints, a linear equality. It would mean all those vectors x, suchthat they satisfy some linear equality. This is a linear function, it's equal tosome given vector b. We'll all talk about linear inequalities,which means that all vectors x, such that ax is less than, equal to b.When I mean less than here, I mean component by component.So I'm going to say a vector 2, 3, is less than equal to a vector 4, 5, becausecomponent by component, 2 is less than 4, 3 is less than 5.But the same vector 2, 3, is not less than equal to the vector 4 1.Why? Because the first component is less than4, but the second component is not. So therefore, this vector is not less than4 1, but this vector 2 3, is less than 4 5.So if I say a vector a x, meaning the vector obtained by multiplying, a to x, isless than or equal to b. I mean that by component by component thatvector should be less than b. Why did I only show you 1 inequality?Because, if you had an inequality, which is going the other way, ax greater thanequal to b, that's nothing but minus a x, less than or equal to minus b.So, without loss of generality, I can just look at 1 side of the inequality, it turnsout that it becomes easier to keep track of various things, if I just look at 1side of the inequalities. Alright.I've got linear functions, I've got the notion of linear constraints.Now the next concept that I want to know about matrices, is what can linearfunctions do? How complicated can a set can linearfunction generate? And, that's going to be important when westart talking about spans of matrices, and how we can think in terms of what thesespans do. So the next concept that we're going tolearn is that of a rank of a matrix. There are 2 notions, I call them rank of amatrix, and a row rank of a matrix. Let's look through the examples, and we'llcome back and look at more general ideas. And another related concept to rank, isthe range of a matrix, and we'll, we'll try to make all of this clearer by lookingat an example. So, down here is an example, I've got amatrix a, which is a 2 by 3 matrix, 2 rows, 3 columns.We know that this matrix induces a linear function, and what that linear functiondoes is it takes a vector x which is in r3, so x is in r3, meaning it has threecomponents. If you multiply this vector by the matrixa, you end up getting a vector ax, which is in r2.So, it maps 3 dimensional vectors into 2 dimensional vectors.This concept is important when we talk about ranges.But before we get there, let's start talking about a column rank.Column rank, I want to look at the rank, columns of this matrix, and ask myself,how many linear independent columns are there.How many columns can I take and write, and still leave them linearly independent?So I know for a fact, that because the columns are 2 dimensional, meaning thateach column is an r 2, I can at most get 2 vectors.Back in the module, for vectors, we had talked about linear independent, and wesaid that in r 2, 2 vectors can be linearly independent, and the third vectorwill become linearly independent. So at most, I can get 2 columns that arelinearly independent, but it turns out, that for this particular matrix, only 1column is linear independent. Why?Because if I take the first column, 1 2, I can get the second column simply bymultiplying the first column by 2. I can get the third column by simplymultiplying the first column by 3. So the second and the third column are notlinearly independent of the first column. So the column rank, which is the number oflinearly independent columns, is 1, because I can only get 1 column.Now let's do the same thing for the rows, and we end up getting a concept of a rowrank. So, here's my row 1, now it turns out,that if I take that row and multiply it by 2, I get the second row.So the row rank is also equal to 1. That's not a coincidence, there is atheorem which says that their row rank and the column rank are equal always for anymatrix. So it turns out for this matrix the rowrank is equal to 1, the column rank is equal to 1 and the rank itself is justequal to 1. So, next let's look at this notion ofrange. So, what we want to do, is we want tounderstand what does this matrix a do to the vectors in r3.So, now I want to think of this matrix not really as a matrix, but as a functionsince taking vectors in r3 and mapping them into vectors in r2.What kind of vectors I can get? What is the largest set of vectors that Ican generate by this transformation? So, it, I'm going to multiply them bydifferent components, so the vector ax is going to be equal to x1 plus 2 times x2plus 3 times x3. The second component is going to be equalto 2 times x1, plus 4 times x 2, plus 6 times x3.That is what this vector a x 3 is going to be.So, x1 plus 2, times, x2 plus 3, times, x3 times 1, gives me the first component, x1plus 2, times x2 plus 3, times, x3 times 2, gives me the second component.So every vector that I can generate by multiplying by the vector x, is of theform some real number, let's just call it lambda, times the vector 1 2, and that'sexactly what is written down here. The range of a, the set of all vectorsthat I can generate by multiplying to the right hand side of a, by sum vector x, isall the vectors of the form lambda times 1 2.What does that mean? Now, going back to the notion r2 is thisplane, one chooses the second component is equal to 2, the first component is equalto 1, that's this vector 1 2. In, in the r2 plane, all the, all thevectors that are possible, are represented by this r2 plane.But this matrix a, can only generate vectors on the straight line, nothing elsecan be generated by multiplying it by the vector x, and this is exactly what itmeans to have a rank 1. Rank 1, means that although the vector issitting in r2, meaning that it has 2 components, really it's a one dimensionalthing, that's what this 1 dimensional line tells me.On the other hand if this matrix a had rank 2, then that would tell me, that Ishould be able to generate everything in r2.Because it would, it would mean that there are two independent vectors that I couldgenerate, and I know that in r2, using 2 independent vectors, I can generateanything, and so on. In the in this course, we will never getdown to the details of how do I compute the rank, and so on.We'll work mostly with the, sort of the idea of what a rank is.And the idea that I want you to keep in mind is, the rank tells you the rich.Higher rank means that you can get a lot more things out of this linear function,lower rank means that you get less out of this linear function.In the next module, we're going to start talking about hedging, and bringing anoptimization problem. And, there we'll notice that the rank, ofthe matrix will tell me how many different payoffs can I, can hedge.Before we finish this module on matrices, there's 1 last concept, and that's ofinverse. If I've got a matrix a, which is a squarematrix n by n, both the row column, row index, and the column index is the same.And the rank of the matrix is n, meaning that all the columns are linearlyindependent, all the rows are linearly independent, then, this matrix isinvertible. What does that mean?It means that there exists a matrix a inverse, such that a inverse times a, isthe same as, a times a inverse, and which is the same as identity.So this i, remember, was identity.

## 029.V

### 053. Review of Linear Optimization

>> . In this module, we will be walking througha review of linear optimization using a hedging example.We are going to see how there are two kinds of optimization problems, somethingcalled a primal optimization problem, something called a dual optimizationproblem, how they are related. And we also introduced the idea of LaGrangian relaxation. Here's the hedging problem that we areinterested in. I've got d assets.So take d, just to fix ideas, take d to be 3 or 4.But some number of assets that are there in the market.The price of these assets at time 0 is r to the d.It's some price vector, which has d components, where every component tells methe price of that particular asset. At time t equal to 1, the market outcomesare uncertain. I don't know what, which state the marketis going to be, it's going to be in one of m possible states.So here's the situation at time T equal to zero, and I'm in state zero, And I couldgo to one of n different possible states. Go from one, two, all the way to, down tom. What do I mean by a state?For my purposes, state is simply telling me what are the different prices that canhappen. So I'm going to characterize every stateby the prices of the asset in that particular state And I can do it in 2different ways. I could either tell you, what is the priceof all the assets in any given state, Or I can tell you the price of a given in allpossible states and we'll flip between these two ideas as we go through.We'll use the power of matrices to see what it means, sometimes, it's easier torepresent it one way, Sometimes it's easier to represent it the other way.And understanding it both ways gives us an insight of which one is more beneficialfor the particular application that I'm looking for.So, to motivate that, I'm going to define something called Sj.So S sub j, will be a column vector, and it will tell me the price of asset j inall possible states, So it's s1j, s2j all the way down to smj.J is fixed, it's asset j and the number of states would ran-, go from 1 to m.Now how do I represent all the assets in the market?I'm just going to take these column and stack them.S1 would refer to the column corresponding to S, asset one S2, asset two and so oneup to S D. If I write them out in gory detail, youend up getting this matrix. The matrix has M rows, because it's got Mstates, its got D columns because its got D assets.And what going on here, every row here, tells you the price of all the assets in aparticular state. So what I've circled here, are the pricesin state 1, S1d, 12S, 11S, 12, all the way up to S1D.Genetically, somewhere it's going to be Sm1, Sm2 , all to Smd.So every row tells me what happens to all the assets in a given state, every columntells me what happens to a particular asset in all the different states.Alright, so that's how I'm going to describe my market.At times 0 I know the price, at time 1, which is the place where the market opensagain, I don't know the price, it's uncertain, it's going to be one of npossible states, but I know that if the state is given to me, what the prices are.Now you might think that this is a very simple representation of the market, andindeed it is. But it turns out, that even in the mostmodern methods, of risk management, like value at risk, and conditional value atrisk, people represent what happens to the market By a model which looks very muchlike this. Except instead of talking about states,we'll talk about simulations. I'm going to simulate returns and I'mgoing to say, depending on all of these different scenarios, what happens?But essentially the, the main ideas are going to be captured by this simple toymodel. Alright, I know what happens to the asset.Now, what I want to do with these assets is to hedge an obligation.I'm going to walk through what does hedging mean.So, I have an obligation. What is an obligation?It's a vector x in rm. Why m?Because the obligation depends on the state.In a good state I might had to pay more, in a bad state I might had to pay less.So depending upon which state occurs, I'm going to pay an obligation xi, if thisstate i occurs. And what I want to do, is I want to buy aportfolio now, I want to buy a certain number of shares of the assets right now,in order to have enough money to pay my obligation.So, I'm going to choose a portfolio theta. Theta-1 through theta-d are going to bethe number of shares that I'm going to purchase of each of these assets.I'm going to allow for the possibility of short selling, so thetas could benegative, or I'll buy them long, which is, when thetas are positive.And I want to do, I want to choose this portfolio, so I can hedge the obligationthat, That I'm interested in hedging. So I'll step you through what it means andwhat, what hedging will ensue and then we'll go to what is the linearoptimization problem that we end up getting.Okay! So at time 0, I'm going to put, buy aposition theta at rd. Why d?Because it's got d different assets. So theta J's the number of shares ofassets J that I purchased, where J goes from 1 through d.What's the cost of this purchase? The cost of the position theta, is simplythe price of every asset times the number of shares that I produce.A lot of those assets! So it's pj times theta j, sum from j equalto 1 through d. It's the inner product of the vector p,with the vector theta. And we know that inner products arenothing but p transpose times theta. What happens at time t equal to 1?So, if a state i occurs, then I'm going to liquidate my position.And when I liquidate positions, I'm going to sell the assets.And what's going to happen? In state i, the price of asset j is s, i,j, I hold theta j positi-, shares of this asset, so by selling asset j I get Sijtimes theta j But I'm going to liquidate the entire portfolio.So j I'm going to sum from 1 equal to d and that's the amount of money, that's thepay-off that I'm going to get in the stake.Its just Sij time theta j sum from j equal to 1 through d, That gives me yi.And if you just think about it for a moment, if I stock up all the pay-offs asa vector. If I call a vector y to be y1, y2, all theway up to y m, the pay-offs in the m states This is nothing but the matrix S,Times the vector theta. Just to remind you, this is my matrix S,it has prices for every state as rows. So the payoff in the first state would bethis row times the vector. And the second state would be this rowtimes the vector. And that's exactly what is being donehere. Sij, as j goes from 1 through D, is a row.You take the i'th row, multiply it by the vector, you get the payoff in the i'thstate. And therefore, the vector y is simply thematrix, times theta. Now I want to look at this, in a differentway. I want to think of this, as notmultiplying row, row by row but column by column.So, instead of looking at this matrix S, as row by row as we have done so far, I'mgoing to put them in columns. I've got the column for the first asset,column for the second asset, column for the d asset and, that's going to multiplytheta-1 theta-2 up to theta-d. And you can see that this multiplicationis nothing but, this row, times this column, so you'll get theta j times Sj.J is summed from 1 through, that should not be an n, but a d.It goes from j equals 1, through d. Interpreting it this way, you end upgetting a different interpretation of what is going on.Now, the pay-offs ys are nothing but linear combinations of the columns.So vector y, will, I can represent, I can generate a particular pay-off, if it's inthe range of the matrix S. Remember in the concept, we had introducedthis concept in the model of matrices, that a vector y, belongs to the range, ofs, if these are all vectors s-theta, where theta is in, r to the d.And therefore, y belongs to the range of S.And remember, we had also introduced the notion of rank.We had said, that rank tells me how rich that space is.Can I, how many different vectors can I generate in the range?So if the rank of the matrix S is n, is equal to m, meaning all possible pay-offscan be generated, then I can hedge everything.If on the other hand, the rank of the matrix s, is less than m, that means thereare certain pay-offs. There are certain pay-off vectors that cannot be generated because they can not be produced as if I'm make, taking the matrixS and multiplying it to theta. So that's the concept that's going to playa role in the course.We're going to talk about complete markets and incompletemarkets, and that has to do with the rank of this matrix.Before we get there, here's a simpler notion.We'll say that a pay-off y hedges x, if y is greater than or equal to x.Component by component, the pay-off that I've generated using my portfolio isgreater than the pay-off that I need to hedge or give-, the payoff that I need togive at time 1. Alright, now comes our first optimizationproblem. What's the optimization problem?I want to minimize the price of the portfolio such that it hedges myobligation. I want to minimize p transpose theta, suchthat s-theta is greater or equal to x. And, what are some features about thisoptimization problem? The objective!What I'm trying to maximize or minimize is a linear function, linear function oftheta. The constraints!Constraints, and what thetas that I can choose, are again linear constraints, astheta must be greater than or equal to x. Linear or inequality.So any optimization problem, which has a linear objective function, eitherminimization or maximization it doesn't matter, and all the constraints are eitherlinear inequalities, as is the case here, or linear equalities.We will call that problem, a linear optimization problem, or a linear program.It turns out that linear programs are very rich, there's a rich theory about them,and you can do a lot of interesting things with them.You can model lots of problems, you can solve them very efficiently, you can get alot of interpretation out of them. So the one thing that we're going to focuson in linear optimization, and the interpretation of linear optimization isthe notion of duality. And what do I mean by the notion ofduality? For every linear program, I can writeanother linear program which is intimately connected to it, and this connection iscalled duality. So I've got a linear program here minimizex, c transpose x, Ax greater than or equal to b.Here's another linear program. Maximize B transpose U, A transpose Uequal to C and U is greater than or equal to 0.Min goes to max. Now, for the purposes of this course, youwill not be responsible for how I generated the dual linear program from theprimal linear program, or the second linear program from the first linearprogram, we will give you that in the course.The only thing that you're going to be responsible for is, to understand therelationship, and we'll emphasize this again during the course.They're here from-, some of the interesting resolve that comes from thisduality concept. The first thing is something called weakduality. What it says is that this minimizationproblem. So the way I, the picture that I have, Iwanted to keep in mind is that here's my value P.For all feasible values, for all xs, such that Ax is greater than or equal to wha-,b, I get some numbers on this side. Why do I get greater?Because I'm trying to minimize. So I get the lowest possible number is p.I've got another number d. Which is the value of this second linearprogram down here. For all Us that are feasible, meaning thatsatisfies A transpose U equal to C, and U is greater than or equal to 0, I'll getvalues that are less than this D. Why?Because this is a maximization problem. The largest possible thing that I can getis B transpose U, is going to be equal to D.The first theorem says, that in fact, this picture that I'm drawing is correct.That P is going to be greater than D. There's no reason for it to be that way,they could have crossed. But the nice thing is, if you constructthe dual linear program correctly, and in the next slide I'm going to show you asimple example. Again let me emphasize you're notresponsible for knowing it. Just walking through the exercise, andunderstanding how I'm going to use the duality.So the primal and the dual are intimately connected; the optimum value of the primalP is greater than equal to the optimum value of the dual D.And because this is true, you end up getting a chain of inequalities that arevery good. We know that c transpose x is greater thanequal to p. Why?Because I''m trying to minimize c transpose x, so for any feasible x,anything that satisfies the inequality Ax greater than equal to b, I'll get a valuegreater that b. The second piece is also true, D isgreater than equal to b, transpose u because I'm trying to maximize b transposeu. And the inner part comes because of the vduality. So now this gives you a very interestingway, if I can find an x, and I can find a u, such that c transpose x is close to btranspose u, then I know that the x must be very close to optimal, And u must alsobe very close to optimal for the dual. Why?Because P is greater than, equal to D, if these two at, points are very close, itmust, it must be that P is also very close to c transpose x, which means that it'soptimum. Similarly, b transpose u must be close toD, which means that is optimum. You end up, you can go one step further,and say that when either P, or D, is finite, either the primal value is finite,or the dual value is finite, then in fact, they must be equal.And finally, the reason why we call them dual, is because if you go from the primalto the dual, and from, you take the dual of the dual, you get back the primal, andthat's why they're called dual linear programs.Going a little bit further. Here's another pair of primal dual linearprograms that we'll be, that we'll be using in the course.Minimize over x, c transpose x, Ax equals b, they, it's equal to maximize u, btranspose u, A transpose u equal to c. And this equality, I'm putting it there toemphasize the fact that there is strong duality between them.But to keep in mind that this equality holds only if you can show that eitherthis one, p or this one, b is finite. So if p, or d is less than, is less than,is not equal to let's say, plus infinity or minus infinity, in that case these twovalues are the same, and in that sense they are equal.So, the last piece in this module, we're going to walk through and tell you how toconstruct a duel, it's a very general concept called La Grangian relaxation.And we'll use that in the next module on non linear programming, as well.So here's the problem. The primal problem is, minimize ctranspose x, Ax, greater than or equal to b.Now I'm going to take a vector u, which is greater than or equal to zero.And so u is component wise greater then or equal to 0, and remember Ax is going to begreater than equal to b. So Ax minus b is component wise greaterthan equal to 0, you take some vector which is component wise greater than equalto the oh, multiplied to another vector that is component wise greater than equalto 0, you end up getting a number, which is greater than or equal to 0.So I'm subtracting it, so I'm getting a number, which is less than c transpose x.So this linear program, which has a changed objective function involving thisvector u, is going to have a value, which is going to be less than equal to P.B transpose U does not involve the decision x, it does not involve theminimization, the minimization is going on over x, it does not involve x, so I pullthat out. I end up getting a new problem, which isminimize c minus a transpose u times x. And what happened to this constraint?I threw it away! Why did I throw it away?It's complicated. I don't know how to deal with constraints,so I threw it away. But I'm guaranteed that if I throw awaythese constraints my set over which I can optimize, the xs over that I can chosebecome larger, and therefore this minimum only becomes smaller.So I end up getting that this quantity, is going to be smaller than the previousline. Now, because I don't have any constraints,I have a very simple problem. I've got some vector, let's call thisvector d. I've got d transpose x.So I want to minimize d transpose x. So here's my d vector.I want to minimize this, d transpose x, and I can choose my x to be anything.So what am I going to do? I'm going to choose my x to be in thenegative direction and going off to infinity.Here's my b, here's my x! If I multiply d and x together I get avery large negative number. So if I have vector d which is not equalto 0, I can make this optimization problem equal to minus infinity and that's whatthis says. If d is not equal to 0 and, just toemphasize d's equal to c minus A transpose u, if this is not equal to 0 you get tominus infinity. If in fact, d is equal to 0, which meansthat c is equal to A transpose u, then I can't do anything over here.This vector is equal to 0, I multiply to any other vector, I'll get a 0.So you end up getting that this minimization problem has a value equal to0. And p is greater then equal to b transposeu. Now u is arbitrary, the only thing that Ineeded to do was, which is missed over here, is that I needed to have that u mustbe greater than equal to zero. So now, you have p must be greater thanequal to maximize b transpose u, which is the value here, provided A transpose u isequal to c and u is greater than equal to 0.That immediately gives you a weak duality, a little bit more work gives you a strongduality. So here's the connection.Max-, minimize C transpose x, Ax greater than or equal to B is equal to maximize Btranspose U, A transpose U equal to C, and U greater than equal to 0.That's what we derived over here. What we did, we dualize constraints, andthis word will show up some times during the course.Dualize means I take the constraints and multiply them by a variable which has aparticular sign. We had a constraint Ax minus b, Imultiplied by a vector of u which is greater than equal to 0, that'sdualization and then I'd relax the constraint.I have this constraint Ax greater than equal to b, I didn't like it, it was toocomplicated, I threw it away. I'd relaxed them!And by doing dualization and relaxation, you end up getting something called a LaGrangian relaxation, which gives you duals, And gives you some very niceproperties that we'll explore more in the course..

